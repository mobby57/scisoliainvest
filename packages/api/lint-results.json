[{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\app.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'next' is defined but never used.","line":41,"column":25,"nodeType":"Identifier","messageId":"unusedVar","endLine":41,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Third-party packages\nimport cors from \"cors\";\nimport express from \"express\";\n\n// Local modules\nimport { authenticateJWT } from \"./middleware/authMiddleware.js\";\nimport adminRoutes from \"./routes/admin.js\";\nimport authRoutes from \"./routes/auth.js\";\nimport projectsRoutes from \"./routes/projects.js\";\nimport User from \"./models/User.js\";\n\nconst app = express();\n\napp.use(cors());\napp.use(express.json());\n\n// Register routes\napp.use(\"/api/admin\", adminRoutes);\napp.use(\"/api/auth\", authRoutes);\napp.use(\"/api/projects\", projectsRoutes);\n\n// User profile route for testing\napp.get(\"/api/user/profile\", authenticateJWT, async (req, res) => {\n  try {\n    const user = await User.findById(req.user.userId).select(\"-password\");\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n    res.json({\n      id: user._id,\n      email: user.email,\n      role: user.role,\n      profile: user.profile,\n    });\n  } catch (_error) {\n    res.status(500).json({ message: \"Server error\" });\n  }\n});\n\n// Error handling middleware\napp.use((err, req, res, next) => {\n  console.error(err.stack);\n  res.status(500).json({ message: \"Something went wrong!\" });\n});\n\n// 404 handler for undefined routes\napp.use((req, res) => {\n  res.status(404).json({ message: \"Route not found\" });\n});\n\nexport default app;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\database\\connection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\database\\mongoConnection.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\docs\\matcher-state-lifecycle.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\eslint.config.mjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\connection_manager.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\connection_manager.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\interaction.factory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\mission.factory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\project.factory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\project.factory.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":2,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":2,"endColumn":34},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":41},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":4,"endColumn":44},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":14,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[439,442],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[439,442],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":23,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":23,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[648,651],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[648,651],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":28,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[732,735],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[732,735],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":29,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":29,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[758,761],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[758,761],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[934,937],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[934,937],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[955,958],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[955,958],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":41,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":41,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1028,1031],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1028,1031],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { faker } from \"@faker-js/faker\";\nimport { Types } from \"mongoose\";\nimport Project from \"../models/Project\";\nimport { ITenant } from \"../models/Tenant\";\nimport { IUser } from \"../models/User\";\n\n// DÃ©finition prÃ©cise des overrides pour la factory\nexport interface ProjectOverrides {\n  location?: {\n    address?: string;\n    city?: string;\n    postalCode?: string;\n    coordinates?: { lat?: number; lng?: number };\n    [key: string]: any;\n  };\n  financials?: {\n    totalInvestment?: number;\n    targetAmount?: number;\n    currentAmount?: number;\n    expectedReturn?: number;\n    duration?: number;\n    entryTicket?: number;\n    [key: string]: any;\n  };\n  timeline?: {\n    startDate?: Date;\n    endDate?: Date;\n    milestones?: any[];\n    [key: string]: any;\n  };\n  tenant?: Types.ObjectId | string;\n  createdBy?: Types.ObjectId | string;\n  name?: string;\n  description?: string;\n  status?: string;\n  type?: string;\n  documents?: any[];\n  investors?: any[];\n  progress?: number;\n  remainingAmount?: number;\n  [key: string]: any;\n}\n\nexport const createProjectData = (overrides: ProjectOverrides = {}) => {\n  const defaultFinancials = {\n    totalInvestment: faker.number.int({ min: 100000, max: 1000000 }),\n    targetAmount: faker.number.int({ min: 50000, max: 500000 }),\n    currentAmount: 0,\n    expectedReturn: faker.number.float({ min: 5, max: 20 }),\n    duration: faker.number.int({ min: 6, max: 24 }),\n    entryTicket: faker.number.int({ min: 1000, max: 10000 }),\n  };\n\n  const defaultTimeline = {\n    startDate: faker.date.future(),\n    endDate: faker.date.future({ years: 1 }),\n    milestones: [],\n  };\n\n  const defaultLocation = {\n    address: faker.location.streetAddress(),\n    city: faker.location.city(),\n    postalCode: faker.location.zipCode(),\n    coordinates: {\n      lat: Number(faker.location.latitude()),\n      lng: Number(faker.location.longitude()),\n    },\n  };\n\n  return {\n    name: faker.commerce.productName(),\n    description: faker.lorem.paragraph(),\n    status: \"draft\",\n    type: \"residential\",\n    location: { ...defaultLocation, ...(overrides.location || {}) },\n    financials: { ...defaultFinancials, ...(overrides.financials || {}) },\n    timeline: { ...defaultTimeline, ...(overrides.timeline || {}) },\n    documents: [],\n    tenant: new Types.ObjectId(),\n    createdBy: new Types.ObjectId(),\n    investors: [],\n    progress: 0,\n    remainingAmount: 0,\n    ...overrides,\n  };\n};\n\n// Toutes les fonctions sont maintenant typÃ©es correctement\nexport const createMinimalProject = (\n  tenant: ITenant | Types.ObjectId | string,\n  createdBy: IUser | Types.ObjectId | string,\n  overrides: ProjectOverrides = {}\n) => {\n  const tenantId = tenant instanceof Types.ObjectId ? tenant : \n                   typeof tenant === 'string' ? new Types.ObjectId(tenant) : \n                   new Types.ObjectId(tenant._id);\n  \n  const createdById = createdBy instanceof Types.ObjectId ? createdBy : \n                      typeof createdBy === 'string' ? new Types.ObjectId(createdBy) : \n                      new Types.ObjectId(createdBy._id);\n\n  return createProjectData({\n    tenant: tenantId,\n    createdBy: createdById,\n    ...overrides,\n  });\n};\n\nexport const createMultipleProjects = (\n  count: number = 3,\n  tenant: ITenant | Types.ObjectId | string,\n  createdBy: IUser | Types.ObjectId | string\n) => {\n  const projects = [];\n  for (let i = 0; i < count; i++) {\n    projects.push(\n      createMinimalProject(tenant, createdBy, { name: `Project ${i + 1}` }),\n    );\n  }\n  return projects;\n};\n\nexport const createFundedProject = (\n  tenant: ITenant | Types.ObjectId | string,\n  createdBy: IUser | Types.ObjectId | string,\n  overrides: ProjectOverrides = {}\n) => {\n  const tenantId = tenant instanceof Types.ObjectId ? tenant : \n                   typeof tenant === 'string' ? new Types.ObjectId(tenant) : \n                   new Types.ObjectId(tenant._id);\n  \n  const createdById = createdBy instanceof Types.ObjectId ? createdBy : \n                      typeof createdBy === 'string' ? new Types.ObjectId(createdBy) : \n                      new Types.ObjectId(createdBy._id);\n\n  return createProjectData({\n    tenant: tenantId,\n    createdBy: createdById,\n    status: \"funded\",\n    financials: {\n      totalInvestment: 1000000,\n      targetAmount: 500000,\n      currentAmount: 500000,\n      expectedReturn: 15,\n      duration: 12,\n      entryTicket: 5000,\n      ...(overrides.financials || {}),\n    },\n    ...overrides,\n  });\n};\n\nexport const createActiveProject = (\n  tenant: ITenant | Types.ObjectId | string,\n  createdBy: IUser | Types.ObjectId | string,\n  overrides: ProjectOverrides = {}\n) => {\n  const tenantId = tenant instanceof Types.ObjectId ? tenant : \n                   typeof tenant === 'string' ? new Types.ObjectId(tenant) : \n                   new Types.ObjectId(tenant._id);\n  \n  const createdById = createdBy instanceof Types.ObjectId ? createdBy : \n                      typeof createdBy === 'string' ? new Types.ObjectId(createdBy) : \n                      new Types.ObjectId(createdBy._id);\n\n  return createProjectData({\n    tenant: tenantId,\n    createdBy: createdById,\n    status: \"active\",\n    ...overrides,\n  });\n};\n\nexport const createProject = async (projectData: ProjectOverrides = {}) => {\n  return await Project.create(projectData);\n};\n\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\sciResource.factory.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":2,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":2,"endColumn":75}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import SCIResourceModel from \"../models/SCIResource\";\nimport type { ISCIResource } from \"../types/models/SCIResource.interface\";\nimport { faker } from \"@faker-js/faker\";\n\n/**\n * Create a new SCI resource with realistic test data\n * @param overrides - Override default values\n * @returns Created SCI resource document\n */\nexport const createSCIResourceFactory = async (\n  overrides: Partial<ISCIResource> = {},\n): Promise<ISCIResource> => {\n  const defaultData: ISCIResource = {\n    title: faker.company.catchPhrase(),\n    description: faker.lorem.paragraphs(3),\n    type: faker.helpers.arrayElement([\n      \"guide\",\n      \"template\",\n      \"calculator\",\n      \"checklist\",\n      \"legal\",\n    ] as const),\n    category: faker.helpers.arrayElement([\n      \"tax\",\n      \"legal\",\n      \"financial\",\n      \"management\",\n      \"compliance\",\n    ] as const),\n    content: {\n      sections: [\n        {\n          title: faker.lorem.sentence(),\n          content: faker.lorem.paragraphs(2),\n        },\n        {\n          title: faker.lorem.sentence(),\n          content: faker.lorem.paragraphs(2),\n        },\n      ],\n      metadata: {\n        difficulty: faker.helpers.arrayElement([\n          \"beginner\",\n          \"intermediate\",\n          \"advanced\",\n        ] as const),\n        estimatedTime: faker.number.int({ min: 15, max: 120 }),\n        tags: faker.helpers.arrayElements(\n          [\"SCI\", \"tax\", \"investment\", \"legal\", \"compliance\", \"financial\"],\n          3,\n        ),\n      },\n    },\n    documents: [\n      {\n        name: `${faker.lorem.word()}.pdf`,\n        url: faker.internet.url(),\n        type: \"pdf\",\n        size: faker.number.int({ min: 1000, max: 5000000 }),\n      },\n    ],\n    author: {\n      name: faker.person.fullName(),\n      email: faker.internet.email(),\n      role: faker.helpers.arrayElement([\n        \"expert\",\n        \"lawyer\",\n        \"accountant\",\n      ] as const),\n    },\n    published: true,\n    featured: false,\n    createdAt: new Date(),\n    updatedAt: new Date(),\n    ...overrides,\n  };\n\n  const document = await SCIResourceModel.create(defaultData);\n  return document.toObject() as unknown as ISCIResource;\n};\n\n/**\n * Create multiple SCI resources at once\n * @param count - Number of resources to create\n * @param overrides - Override default values\n * @returns Array of created SCI resources\n */\nexport const createSCIResourcesFactory = async (\n  count: number = 5,\n  overrides: Partial<ISCIResource> = {},\n): Promise<ISCIResource[]> => {\n  const resources: ISCIResource[] = [];\n  for (let i = 0; i < count; i++) {\n    resources.push(await createSCIResourceFactory(overrides));\n  }\n  return resources;\n};\n\nexport {\n  createSCIResourceFactory as createSCIResource,\n  createSCIResourcesFactory as createSCIResources,\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\task.factory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\tenant.factory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\tenant.factory.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":48},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":5,"endColumn":34},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":19,"column":12,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":15,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[533,536],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[533,536],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `ITenant`.","line":74,"column":18,"nodeType":"AwaitExpression","messageId":"unsafeArgument","endLine":74,"endColumn":54}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import Tenant from \"../models/Tenant\";\nimport User from \"../models/User\";\nimport type { ITenant } from \"../types/models\";\nimport { faker } from \"@faker-js/faker\";\nimport { Types } from \"mongoose\";\n\ninterface ITenantFactoryOverrides {\n  owner?: string | Types.ObjectId;\n  [key: string]: unknown;\n}\n\n/**\n * Create a new tenant with realistic test data\n * @param overrides - Override default values\n * @returns Created tenant document\n */\nexport const createTenantFactory = async (\n  overrides: ITenantFactoryOverrides = {},\n): Promise<any> => {\n  let ownerId: Types.ObjectId;\n\n  if (overrides.owner) {\n    ownerId =\n      typeof overrides.owner === \"string\"\n        ? new Types.ObjectId(overrides.owner)\n        : overrides.owner;\n  } else {\n    const user = await User.create({\n      email: faker.internet.email(),\n      password: \"Test123456!\",\n      role: \"admin\",\n      profile: {\n        firstName: faker.person.firstName(),\n        lastName: faker.person.lastName(),\n        phone: faker.phone.number({ style: \"international\" }),\n      },\n    });\n    ownerId = user._id as Types.ObjectId;\n  }\n\n  const tenantData = {\n    name: faker.company.name(),\n    slug: faker.helpers.slugify(faker.company.name()).toLowerCase(),\n    owner: ownerId,\n    users: [] as Types.ObjectId[],\n    projects: [] as Types.ObjectId[],\n    settings: {\n      branding: {\n        logoUrl: faker.image.urlPlaceholder(),\n        primaryColor: faker.internet.color(),\n        secondaryColor: faker.internet.color(),\n      },\n      features: [\"investments\", \"kyc\", \"analytics\", \"notifications\"],\n    },\n    address: {\n      street: faker.location.streetAddress(),\n      city: faker.location.city(),\n      state: faker.location.state(),\n      zipCode: faker.location.zipCode(),\n      country: faker.location.country(),\n    },\n    ...overrides,\n  };\n\n  return await Tenant.create(tenantData);\n};\n\nexport const createTenantsFactory = async (\n  count: number = 3,\n  overrides: ITenantFactoryOverrides = {},\n): Promise<ITenant[]> => {\n  const tenants: ITenant[] = [];\n  for (let i = 0; i < count; i++) {\n    tenants.push(await createTenantFactory(overrides));\n  }\n  return tenants;\n};\n\nexport {\n  createTenantFactory as createTenant,\n  createTenantsFactory as createTenants,\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\user.factory.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":34}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { IUser } from \"../types/models\";\nimport { faker } from \"@faker-js/faker\";\nimport { Types } from \"mongoose\";\n\nexport const createUserFactory = (overrides: Partial<IUser> = {}): IUser => {\n  const userData = {\n    _id: new Types.ObjectId(),\n    email: faker.internet.email(),\n    password: \"Test123!\",\n    role: \"investor\" as const,\n    isEmailVerified: true,\n    profile: {\n      firstName: faker.person.firstName(),\n      lastName: faker.person.lastName(),\n      phone: faker.phone.number(),\n      avatar: faker.image.avatar(),\n      kycStatus: \"verified\" as const,\n      ...overrides.profile,\n    },\n    preferences: {\n      notifications: {\n        email: true,\n        sms: true,\n        push: true,\n      },\n      language: \"en\",\n      currency: \"EUR\",\n      ...overrides.preferences,\n    },\n    ...overrides,\n  };\n\n  return userData as IUser;\n};\n\nexport const createTestUser = (overrides: Partial<IUser> = {}): IUser => {\n  return createUserFactory({ role: \"investor\", ...overrides });\n};\n\nexport const createTestAdmin = (overrides: Partial<IUser> = {}): IUser => {\n  return createUserFactory({ role: \"admin\", ...overrides });\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\user_factory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\factories\\utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\fix-all-lint-issues.cjs","messages":[{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":16,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":16,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":41,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":41,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":44,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":44,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":52,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":52,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'__dirname' is not defined.","line":54,"column":22,"nodeType":"Identifier","messageId":"undef","endLine":54,"endColumn":31},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":57,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":57,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":60,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":60,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":67,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":67,"endColumn":10},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":70,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":70,"endColumn":10},{"ruleId":"no-undef","severity":2,"message":"'__dirname' is not defined.","line":73,"column":32,"nodeType":"Identifier","messageId":"undef","endLine":73,"endColumn":41},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":80,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":80,"endColumn":10},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":83,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":83,"endColumn":10},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":86,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":86,"endColumn":10},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":87,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":87,"endColumn":10},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":91,"column":14,"nodeType":"Identifier","messageId":"undef","endLine":91,"endColumn":21}],"suppressedMessages":[],"errorCount":15,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\r\n\r\nconst fs = require('fs');\r\nconst path = require('path');\r\nconst { execSync } = require('child_process');\r\n\r\n// Colors for console output\r\nconst colors = {\r\n  red: '\\x1b[31m',\r\n  green: '\\x1b[32m',\r\n  yellow: '\\x1b[33m',\r\n  blue: '\\x1b[34m',\r\n  reset: '\\x1b[0m'\r\n};\r\n\r\nconsole.log(`${colors.blue}ðŸš€ Starting comprehensive ESLint fix process...${colors.reset}`);\r\n\r\n// Phase 1: Fix \"error is not defined\" issues in route files\r\nconst routeFiles = [\r\n  'routes/auth.js',\r\n  'routes/admin.js',\r\n  'routes/projects.js',\r\n  'routes/kyc.js',\r\n  'routes/leaseRoutes.js',\r\n  'routes/paymentRoutes.js',\r\n  'routes/rentRoutes.js',\r\n  'routes/sciExpertiseRoutes.js',\r\n  'routes/test.js'\r\n];\r\n\r\nfunction fixErrorNotDefined(filePath) {\r\n  try {\r\n    let content = fs.readFileSync(filePath, 'utf8');\r\n    \r\n    // Fix catch blocks missing error parameter\r\n    content = content.replace(/catch\\s*\\{\\s*logger\\.error\\([\"']([^\"']+)[\"'],\\s*error\\)/g, 'catch (_error) {\\n    logger.error(\"$1\", error)');\r\n    content = content.replace(/catch\\s*\\{\\s*console\\.error\\([\"']([^\"']+)[\"'],\\s*error\\)/g, 'catch (_error) {\\n    console.error(\"$1\", error)');\r\n    content = content.replace(/catch\\s*\\{\\s*res\\.status\\((\\d+)\\)\\.json\\(\\{\\s*message:\\s*error\\.message/g, 'catch (_error) {\\n    res.status($1).json({ message: error.message');\r\n    \r\n    fs.writeFileSync(filePath, content);\r\n    console.log(`${colors.green}âœ… Fixed error parameter in: ${filePath}${colors.reset}`);\r\n    return true;\r\n  } catch (err) {\r\n    console.log(`${colors.red}âŒ Error fixing ${filePath}: ${err.message}${colors.reset}`);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Phase 2: Auto-fix import sorting and other issues\r\nfunction runESLintFix() {\r\n  try {\r\n    console.log(`${colors.blue}ðŸ”§ Running ESLint auto-fix...${colors.reset}`);\r\n    execSync('npx eslint . --ext .js,.ts --fix', { \r\n      cwd: path.join(__dirname),\r\n      stdio: 'inherit'\r\n    });\r\n    console.log(`${colors.green}âœ… ESLint auto-fix completed${colors.reset}`);\r\n    return true;\r\n  } catch (err) {\r\n    console.log(`${colors.yellow}âš ï¸  ESLint auto-fix had some issues, manual review needed${colors.reset}`);\r\n    return false;\r\n  }\r\n}\r\n\r\n// Main execution\r\nasync function main() {\r\n  console.log(`${colors.blue}ðŸ“‹ Starting lint fixes...${colors.reset}`);\r\n  \r\n  // Phase 1: Fix error parameter issues\r\n  console.log(`${colors.blue}ðŸ”§ Phase 1: Fixing error parameter issues...${colors.reset}`);\r\n  let fixedCount = 0;\r\n  routeFiles.forEach(file => {\r\n    const filePath = path.join(__dirname, file);\r\n    if (fs.existsSync(filePath)) {\r\n      if (fixErrorNotDefined(filePath)) {\r\n        fixedCount++;\r\n      }\r\n    }\r\n  });\r\n  console.log(`${colors.green}âœ… Fixed ${fixedCount} route files${colors.reset}`);\r\n  \r\n  // Phase 2: Auto-fix imports and other issues\r\n  console.log(`${colors.blue}ðŸ”§ Phase 2: Running ESLint auto-fix...${colors.reset}`);\r\n  runESLintFix();\r\n  \r\n  console.log(`${colors.green}ðŸŽ‰ Lint fix process completed!${colors.reset}`);\r\n  console.log(`${colors.blue}ðŸ“Š Run 'npx eslint . --ext .js,.ts' to verify all issues are resolved${colors.reset}`);\r\n}\r\n\r\n// Execute the fix process\r\nmain().catch(console.error);\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\middleware\\adminMiddleware.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\middleware\\auditLogger.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\middleware\\authMiddleware.enhanced.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\middleware\\authMiddleware.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\middleware\\errorHandler.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'handleServerError' is defined but never used.","line":1,"column":10,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":27},{"ruleId":"no-unused-vars","severity":1,"message":"'next' is defined but never used.","line":3,"column":38,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":42}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { handleServerError } from './responseHandler.js';\r\n\r\nconst errorHandler = (err, req, res, next) => {\r\n  console.error(err.stack);\r\n\r\n  // Mongoose validation error\r\n  if (err.name === 'ValidationError') {\r\n    const errors = Object.values(err.errors).map(e => ({\r\n      field: e.path,\r\n      message: e.message\r\n    }));\r\n    return res.status(400).json({\r\n      success: false,\r\n      message: 'Validation failed',\r\n      errors,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  }\r\n\r\n  // Mongoose duplicate key error\r\n  if (err.code === 11000) {\r\n    const field = Object.keys(err.keyValue)[0];\r\n    return res.status(400).json({\r\n      success: false,\r\n      message: `${field} already exists`,\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  }\r\n\r\n  // JWT errors\r\n  if (err.name === 'JsonWebTokenError') {\r\n    return res.status(401).json({\r\n      success: false,\r\n      message: 'Invalid token',\r\n      timestamp: new Date().toISOString()\r\n    });\r\n  }\r\n\r\n  // Default error\r\n  return res.status(err.status || 500).json({\r\n    success: false,\r\n    message: err.message || 'Internal server error',\r\n    timestamp: new Date().toISOString()\r\n  });\r\n};\r\n\r\nexport default errorHandler;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\middleware\\index.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\middleware\\requestLogger.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\middleware\\responseHandler.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\middleware\\validation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\AuditLog.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Document.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Donation.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Lease.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Notification.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Payment.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Project.d.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1411,1414],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1411,1414],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":68,"column":36,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":68,"endColumn":39,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1425,1428],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1425,1428],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Document, Model, Types } from \"mongoose\";\n\nexport interface ILocation {\n  address: string;\n  city: string;\n  postalCode: string;\n  coordinates?: {\n    lat: number;\n    lng: number;\n  };\n}\n\nexport interface IFinancials {\n  totalInvestment: number;\n  targetAmount: number;\n  currentAmount: number;\n  expectedReturn: number;\n  duration: number;\n  entryTicket: number;\n}\n\nexport interface IMilestone {\n  name: string;\n  date: Date;\n  completed: boolean;\n}\n\nexport interface ITimeline {\n  startDate: Date;\n  endDate: Date;\n  milestones: IMilestone[];\n}\n\nexport interface IDocument {\n  name: string;\n  url: string;\n  type: string;\n}\n\nexport interface IInvestor {\n  user: Types.ObjectId;\n  amount: number;\n  shares: number;\n  investedAt: Date;\n}\n\nexport interface IProject extends Document {\n  name: string;\n  description: string;\n  type: \"residential\" | \"commercial\" | \"mixed\";\n  location: ILocation;\n  financials: IFinancials;\n  timeline: ITimeline;\n  documents: IDocument[];\n  status: \"draft\" | \"active\" | \"funded\" | \"completed\" | \"cancelled\";\n  tenant: Types.ObjectId;\n  createdBy: Types.ObjectId;\n  investors: IInvestor[];\n  progress: number;\n  remainingAmount: number;\n  createdAt: Date;\n  updatedAt: Date;\n}\n\n// Add static methods interface for the Project model\nexport interface IProjectModel extends Model<IProject> {\n  create(projectData: Partial<IProject>): Promise<IProject>;\n  deleteMany(filter: any): Promise<any>;\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Project.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\RefreshToken.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Rent.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\SCIResource.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\SCIShare.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Task.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Tenant.d.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":36,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[697,700],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[697,700],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":37,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[737,740],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[737,740],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":38,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[770,773],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[770,773],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":39,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[794,797],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[794,797],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":39,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":39,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[802,805],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[802,805],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":5,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Document } from \"mongoose\";\n\nexport interface ITenant extends Document {\n  _id: string;\n  name: string;\n  slug: string;\n  owner: string | import(\"../types/models\").IUser;\n  users: string[];\n  projects: string[];\n  settings: {\n    branding: {\n      logoUrl?: string;\n      primaryColor?: string;\n      secondaryColor?: string;\n    };\n    features: string[];\n  };\n  description?: string;\n  logo?: string;\n  website?: string;\n  email?: string;\n  phone?: string;\n  address?: {\n    street?: string;\n    city?: string;\n    state?: string;\n    zipCode?: string;\n    country?: string;\n  };\n  isActive?: boolean;\n  createdAt?: Date;\n  updatedAt?: Date;\n}\n\ndeclare const Tenant: {\n  create: (data: any) => Promise<ITenant>;\n  find: () => any;\n  findById: (id: string) => any;\n  findOne: (query: any) => any;\n};\n\nexport default Tenant;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\Tenant.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\User.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\User.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\models\\index.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'mongoose' is assigned a value but never used.","line":1,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":1,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const mongoose = require(\"mongoose\");\n\n// Import all models\nconst User = require(\"./User\");\nconst Project = require(\"./Project\");\nconst Donation = require(\"./Donation\");\nconst SCIResource = require(\"./SCIResource\");\nconst Task = require(\"./Task\");\nconst Tenant = require(\"./Tenant\");\nconst RefreshToken = require(\"./RefreshToken\");\n\n// Export all models\nmodule.exports = {\n  User,\n  Project,\n  Donation,\n  SCIResource,\n  Task,\n  Tenant,\n  RefreshToken,\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\admin.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\admin_new.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'bcrypt' is defined but never used.","line":2,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":14}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import express from \"express\";\nimport bcrypt from \"bcryptjs\";\nimport User from \"../models/User.js\";\nimport Project from \"../models/Project.js\";\nimport {\n  authenticateJWT,\n  authorizeAdmin,\n} from \"../middleware/authMiddleware.enhanced.js\";\n\nconst router = express.Router();\n\n// Main admin routes\nrouter.get(\"/users\", authenticateJWT, authorizeAdmin, async (req, res) => {\n  try {\n    const users = await User.find().select(\"email profile.kycStatus\");\n    res.json(users);\n  } catch {\n    res.status(500).json({ error: \"Internal server error\" });\n  }\n});\n\n// Admin stats endpoint\nrouter.get(\"/stats\", authenticateJWT, authorizeAdmin, async (req, res) => {\n  try {\n    const userCount = await User.countDocuments();\n    const projectCount = await Project.countDocuments();\n    const kycPendingCount = await User.countDocuments({\n      \"profile.kycStatus\": \"pending\",\n    });\n\n    res.json({\n      users: { total: userCount },\n      projects: { total: projectCount },\n      kyc: { pending: kycPendingCount },\n      data: [], // Added for test compatibility\n    });\n  } catch {\n    res.status(500).json({ error: \"Internal server error\" });\n  }\n});\n\n// Admin logs endpoint\nrouter.get(\"/logs\", authenticateJWT, authorizeAdmin, async (req, res) => {\n  try {\n    // Mock logs for testing\n    const logs = [\n      {\n        timestamp: new Date(),\n        level: \"info\",\n        message: \"Admin accessed users list\",\n      },\n      { timestamp: new Date(), level: \"info\", message: \"Admin accessed stats\" },\n    ];\n\n    res.json({ logs });\n  } catch {\n    res.status(500).json({ error: \"Internal server error\" });\n  }\n});\n\nexport default router;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\auth.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":252,"column":37,"nodeType":"Identifier","messageId":"undef","endLine":252,"endColumn":42}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Third-party packages\nimport bcrypt from \"bcryptjs\";\nimport express from \"express\";\nimport jwt from \"jsonwebtoken\";\n\n// Local modules\nimport { authenticateJWT } from \"../middleware/authMiddleware.js\";\nimport { logAudit } from \"../middleware/auditLogger.js\";\nimport RefreshToken from \"../models/RefreshToken.js\";\nimport User from \"../models/User.js\";\nimport logger from \"../utils/logger.js\";\n\nconst router = express.Router();\n\n// Generate tokens\nconst generateAccessToken = (userId) => {\n  return jwt.sign({ userId, type: \"access\" }, process.env.JWT_SECRET, {\n    expiresIn: \"15m\",\n  });\n};\n\nconst generateRefreshToken = (userId) => {\n  return jwt.sign({ userId, type: \"refresh\" }, process.env.JWT_REFRESH_SECRET, {\n    expiresIn: \"7d\",\n  });\n};\n\n// Register\nrouter.post(\"/register\", async (req, res) => {\n  try {\n    const { email, password, role, profile } = req.body;\n\n    // Check if user exists\n    const existingUser = await User.findOne({ email });\n    if (existingUser) {\n      return res.status(400).json({ message: \"User already exists\" });\n    }\n\n    // Hash password\n    const hashedPassword = await bcrypt.hash(password, 12);\n\n    // Create user\n    const user = new User({\n      email,\n      password: hashedPassword,\n      role: role || \"investor\",\n      profile: profile || {},\n    });\n\n    await user.save();\n\n    // Generate tokens\n    const accessToken = generateAccessToken(user._id);\n    const refreshToken = generateRefreshToken(user._id);\n\n    // Save refresh token\n    const refreshTokenDoc = new RefreshToken({\n      token: refreshToken,\n      userId: user._id,\n      expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),\n    });\n    await refreshTokenDoc.save();\n\n    // Log audit\n    await logAudit(user._id, \"CREATE\", \"USER\", user._id);\n\n    res.status(201).json({\n      message: \"User created successfully\",\n      token: accessToken,\n      refreshToken,\n      user: {\n        id: user._id,\n        email: user.email,\n        role: user.role,\n        profile: user.profile,\n      },\n    });\n  } catch (_error) {\n    logger.error(\"Registration error:\", error);\n    res.status(500).json({ message: \"Server error\" });\n  }\n});\n\n// Login\nrouter.post(\"/login\", async (req, res) => {\n  try {\n    const { email, password } = req.body;\n\n    // Find user\n    const user = await User.findOne({ email });\n    if (!user) {\n      return res.status(401).json({ message: \"Invalid credentials\" });\n    }\n\n    // Check password\n    const isValidPassword = await bcrypt.compare(password, user.password);\n    if (!isValidPassword) {\n      return res.status(401).json({ message: \"Invalid credentials\" });\n    }\n\n    // Generate tokens\n    const accessToken = generateAccessToken(user._id);\n    const refreshToken = generateRefreshToken(user._id);\n\n    // Save refresh token\n    const refreshTokenDoc = new RefreshToken({\n      token: refreshToken,\n      userId: user._id,\n      expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),\n    });\n    await refreshTokenDoc.save();\n\n    // Log audit\n    await logAudit(user._id, \"LOGIN\", \"USER\", user._id);\n\n    res.json({\n      message: \"Login successful\",\n      token: accessToken,\n      refreshToken,\n      user: {\n        id: user._id,\n        email: user.email,\n        role: user.role,\n        profile: user.profile,\n      },\n    });\n  } catch (_error) {\n    logger.error(\"Login error:\", error);\n    res.status(500).json({ message: \"Server error\" });\n  }\n});\n\n// Refresh token\nrouter.post(\"/refresh\", async (req, res) => {\n  try {\n    const { refreshToken } = req.body;\n\n    if (!refreshToken) {\n      return res.status(401).json({ message: \"Refresh token required\" });\n    }\n\n    // Verify refresh token\n    const decoded = jwt.verify(refreshToken, process.env.JWT_REFRESH_SECRET);\n\n    // Check if token exists in database\n    const storedToken = await RefreshToken.findOne({\n      token: refreshToken,\n      userId: decoded.userId,\n      expiresAt: { $gt: new Date() },\n    });\n\n    if (!storedToken) {\n      return res.status(401).json({ message: \"Invalid refresh token\" });\n    }\n\n    // Generate new tokens\n    const newAccessToken = generateAccessToken(decoded.userId);\n    const newRefreshToken = generateRefreshToken(decoded.userId);\n\n    // Replace old refresh token\n    await RefreshToken.deleteOne({ token: refreshToken });\n\n    const newRefreshTokenDoc = new RefreshToken({\n      token: newRefreshToken,\n      userId: decoded.userId,\n      expiresAt: new Date(Date.now() + 7 * 24 * 60 * 60 * 1000),\n    });\n    await newRefreshTokenDoc.save();\n\n    res.json({\n      token: newAccessToken,\n      refreshToken: newRefreshToken,\n    });\n  } catch (_error) {\n    logger.error(\"Token refresh error:\", error);\n    res.status(401).json({ message: \"Invalid refresh token\" });\n  }\n});\n\n// Logout\nrouter.post(\"/logout\", authenticateJWT, async (req, res) => {\n  try {\n    const { refreshToken } = req.body;\n\n    if (refreshToken) {\n      await RefreshToken.deleteOne({ token: refreshToken });\n    }\n\n    // Log audit\n    await logAudit(req.user.userId, \"LOGOUT\", \"USER\", req.user.userId);\n\n    res.json({ message: \"Logged out successfully\" });\n  } catch (_error) {\n    logger.error(\"Logout error:\", error);\n    res.status(500).json({ message: \"Server error\" });\n  }\n});\n\n// Change password\nrouter.post(\"/change-password\", authenticateJWT, async (req, res) => {\n  try {\n    const { currentPassword, newPassword } = req.body;\n    const userId = req.user.userId;\n\n    const user = await User.findById(userId);\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    // Verify current password\n    const isValidPassword = await bcrypt.compare(\n      currentPassword,\n      user.password,\n    );\n    if (!isValidPassword) {\n      return res.status(400).json({ message: \"Current password is incorrect\" });\n    }\n\n    // Hash new password\n    const hashedPassword = await bcrypt.hash(newPassword, 12);\n    user.password = hashedPassword;\n    await user.save();\n\n    // Revoke all refresh tokens for security\n    await RefreshToken.deleteMany({ userId });\n\n    // Log audit\n    await logAudit(userId, \"PASSWORD_CHANGE\", \"USER\", userId);\n\n    res.json({ message: \"Password changed successfully\" });\n  } catch (_error) {\n    logger.error(\"Password change error:\", error);\n    res.status(500).json({ message: \"Server error\" });\n  }\n});\n\n// Get current user\nrouter.get(\"/me\", authenticateJWT, async (req, res) => {\n  try {\n    const user = await User.findById(req.user.userId).select(\"-password\");\n    if (!user) {\n      return res.status(404).json({ message: \"User not found\" });\n    }\n\n    res.json({\n      id: user._id,\n      email: user.email,\n      role: user.role,\n      profile: user.profile,\n    });\n  } catch {\n    logger.error(\"Get user error:\", error);\n    res.status(500).json({ message: \"Server error\" });\n  }\n});\n\nexport default router;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\auth_updated.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":97,"column":42,"nodeType":"Identifier","messageId":"undef","endLine":97,"endColumn":47},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":98,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":98,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":101,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":101,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":102,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":102,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":150,"column":35,"nodeType":"Identifier","messageId":"undef","endLine":150,"endColumn":40}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const express = require(\"express\");\nconst bcrypt = require(\"bcryptjs\");\nconst jwt = require(\"jsonwebtoken\");\nconst User = require(\"../models/User\");\nconst { body, validationResult } = require(\"express-validator\");\nconst {\n  handleSuccess,\n  handleError,\n  handleValidationError,\n  handleUnauthorized,\n} = require(\"../middleware/responseHandler\");\n\nconst router = express.Router();\n\n// Validation middleware\nconst validateRegistration = [\n  body(\"email\")\n    .isEmail()\n    .normalizeEmail()\n    .withMessage(\"Please provide a valid email address\"),\n  body(\"password\")\n    .isLength({ min: 8 })\n    .withMessage(\"Password must be at least 8 characters long\"),\n  body(\"profile.firstName\").notEmpty().withMessage(\"First name is required\"),\n  body(\"profile.lastName\").notEmpty().withMessage(\"Last name is required\"),\n  body(\"role\")\n    .optional()\n    .isIn([\"investor\", \"sci\", \"admin\"])\n    .withMessage(\"Invalid role\"),\n];\n\nconst validateLogin = [\n  body(\"email\")\n    .isEmail()\n    .normalizeEmail()\n    .withMessage(\"Please provide a valid email address\"),\n  body(\"password\").notEmpty().withMessage(\"Password is required\"),\n];\n\n// Register\nrouter.post(\"/register\", validateRegistration, async (req, res) => {\n  try {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return handleValidationError(res, errors.array());\n    }\n\n    const { email, password, profile, role } = req.body;\n\n    // Check if user already exists\n    const existingUser = await User.findOne({ email });\n    if (existingUser) {\n      return handleError(res, \"User already exists with this email\", [], 400);\n    }\n\n    // Create user\n    const user = new User({\n      email,\n      password,\n      profile: {\n        firstName: profile.firstName,\n        lastName: profile.lastName,\n        phone: profile.phone || \"\",\n        avatar: profile.avatar || \"\",\n      },\n      role: role || \"investor\",\n    });\n\n    await user.save();\n\n    // Generate JWT\n    const token = jwt.sign(\n      { userId: user._id, email: user.email, role: user.role },\n      process.env.JWT_SECRET || \"your-secret-key\",\n      { expiresIn: \"24h\" },\n    );\n\n    handleSuccess(\n      res,\n      \"User registered successfully\",\n      {\n        token,\n        user: {\n          _id: user._id,\n          id: user._id,\n          email: user.email,\n          profile: {\n            firstName: user.profile.firstName,\n            lastName: user.profile.lastName,\n          },\n          role: user.role,\n        },\n      },\n      201,\n    );\n  } catch {\n    console.error(\"Registration error:\", error);\n    if (error.code === 11000) {\n      return handleError(res, \"Email already exists\", [], 400);\n    }\n    if (error.name === \"ValidationError\") {\n      return handleError(res, \"Validation failed\", [error.message], 400);\n    }\n    handleError(res, \"Server error during registration\", [], 500);\n  }\n});\n\n// Login\nrouter.post(\"/login\", validateLogin, async (req, res) => {\n  try {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return handleValidationError(res, errors.array());\n    }\n\n    const { email, password } = req.body;\n\n    // Find user\n    const user = await User.findOne({ email });\n    if (!user) {\n      return handleUnauthorized(res, \"Invalid credentials\");\n    }\n\n    // Check password\n    const isMatch = await bcrypt.compare(password, user.password);\n    if (!isMatch) {\n      return handleUnauthorized(res, \"Invalid credentials\");\n    }\n\n    // Generate JWT\n    const token = jwt.sign(\n      { userId: user._id, email: user.email, role: user.role },\n      process.env.JWT_SECRET || \"your-secret-key\",\n      { expiresIn: \"24h\" },\n    );\n\n    handleSuccess(res, \"Login successful\", {\n      token,\n      user: {\n        id: user._id,\n        email: user.email,\n        profile: {\n          firstName: user.profile.firstName,\n          lastName: user.profile.lastName,\n        },\n        role: user.role,\n      },\n    });\n  } catch {\n    console.error(\"Login error:\", error);\n    handleError(res, \"Server error during login\", [], 500);\n  }\n});\n\n// Get current user\nrouter.get(\"/me\", async (req, res) => {\n  try {\n    const token = req.header(\"Authorization\")?.replace(\"Bearer \", \"\");\n\n    if (!token) {\n      return handleUnauthorized(res, \"No token provided\");\n    }\n\n    const decoded = jwt.verify(\n      token,\n      process.env.JWT_SECRET || \"your-secret-key\",\n    );\n    const user = await User.findById(decoded.userId).select(\"-password\");\n\n    if (!user) {\n      return handleError(res, \"User not found\", [], 404);\n    }\n\n    handleSuccess(res, \"User retrieved successfully\", user);\n  } catch {\n    handleUnauthorized(res, \"Invalid token\");\n  }\n});\n\nmodule.exports = router;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\health.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\kyc.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'jwt' is defined but never used.","line":2,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":2,"endColumn":11},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":48,"column":44,"nodeType":"Identifier","messageId":"undef","endLine":48,"endColumn":49},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":66,"column":40,"nodeType":"Identifier","messageId":"undef","endLine":66,"endColumn":45},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":88,"column":42,"nodeType":"Identifier","messageId":"undef","endLine":88,"endColumn":47},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":119,"column":42,"nodeType":"Identifier","messageId":"undef","endLine":119,"endColumn":47}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import express from \"express\";\nimport jwt from \"jsonwebtoken\";\nimport User from \"../models/User.js\";\nimport {\n  authenticateJWT,\n  authorizeAdmin,\n} from \"../middleware/authMiddleware.js\";\nimport { handleSuccess, handleError } from \"../middleware/responseHandler.js\";\n\nconst router = express.Router();\n\n// Submit KYC verification\nrouter.post(\"/submit\", authenticateJWT, async (req, res) => {\n  try {\n    const { kycData } = req.body;\n\n    if (!kycData || !kycData.documents) {\n      return handleError(res, \"KYC data and documents are required\", [], 400);\n    }\n\n    const user = await User.findById(req.user.userId);\n    if (!user) {\n      return handleError(res, \"User not found\", [], 404);\n    }\n\n    // Ensure profile object exists\n    if (!user.profile) {\n      user.profile = {};\n    }\n\n    user.profile.kycStatus = \"pending\";\n    user.profile.kycDocuments = kycData.documents || [];\n    user.profile.kycSubmittedAt = new Date();\n\n    await user.save();\n\n    handleSuccess(\n      res,\n      \"KYC submitted successfully\",\n      {\n        kycId: user._id,\n        status: \"pending\",\n        submittedAt: user.profile.kycSubmittedAt,\n      },\n      201,\n    );\n  } catch {\n    console.error(\"KYC submission error:\", error);\n    handleError(res, \"Server error during KYC submission\", [], 500);\n  }\n});\n\n// Get KYC status for authenticated user\nrouter.get(\"/status\", authenticateJWT, async (req, res) => {\n  try {\n    const user = await User.findById(req.user.userId);\n    if (!user) {\n      return handleError(res, \"User not found\", [], 404);\n    }\n\n    handleSuccess(res, \"KYC status retrieved successfully\", {\n      status: user.profile?.kycStatus || \"not_submitted\",\n      documents: user.profile?.kycDocuments || [],\n    });\n  } catch {\n    console.error(\"KYC status error:\", error);\n    handleError(res, \"Server error while fetching KYC status\", [], 500);\n  }\n});\n\n// Get KYC status by user ID (for admin or specific lookups)\nrouter.get(\n  \"/status/:userId\",\n  authenticateJWT,\n  authorizeAdmin,\n  async (req, res) => {\n    try {\n      const user = await User.findById(req.params.userId);\n      if (!user) {\n        return handleError(res, \"User not found\", [], 404);\n      }\n\n      handleSuccess(res, \"KYC status retrieved successfully\", {\n        status: user.profile?.kycStatus || \"not_submitted\",\n        documents: user.profile?.kycDocuments || [],\n      });\n    } catch {\n      console.error(\"KYC status error:\", error);\n      handleError(res, \"Server error while fetching KYC status\", [], 500);\n    }\n  },\n);\n\n// Update KYC status (admin only)\nrouter.put(\n  \"/status/:userId\",\n  authenticateJWT,\n  authorizeAdmin,\n  async (req, res) => {\n    try {\n      const { status, comments } = req.body;\n      const user = await User.findById(req.params.userId);\n\n      if (!user) {\n        return handleError(res, \"User not found\", [], 404);\n      }\n\n      // Ensure profile object exists\n      if (!user.profile) {\n        user.profile = {};\n      }\n\n      user.profile.kycStatus = status;\n      user.profile.kycComments = comments;\n      await user.save();\n\n      handleSuccess(res, \"KYC status updated successfully\", { status });\n    } catch {\n      console.error(\"KYC update error:\", error);\n      handleError(res, \"Server error during KYC update\", [], 500);\n    }\n  },\n);\n\nexport default router;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\leaseRoutes.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":67,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":67,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":109,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":109,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":169,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":169,"endColumn":58}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import express from \"express\";\nimport Lease from \"../models/Lease.js\";\nimport {\n  authenticateJWT,\n  authorizeAdmin,\n} from \"../middleware/authMiddleware.enhanced.js\";\nimport { body, validationResult } from \"express-validator\";\n\nconst router = express.Router();\n\n// Validation rules\nconst leaseValidation = [\n  body(\"property\").isMongoId().withMessage(\"Valid property ID is required\"),\n  body(\"tenant\").isMongoId().withMessage(\"Valid tenant ID is required\"),\n  body(\"landlord\").isMongoId().withMessage(\"Valid landlord ID is required\"),\n  body(\"leaseType\")\n    .isIn([\"residential\", \"commercial\", \"mixed\"])\n    .withMessage(\"Valid lease type is required\"),\n  body(\"startDate\").isISO8601().withMessage(\"Valid start date is required\"),\n  body(\"endDate\").isISO8601().withMessage(\"Valid end date is required\"),\n  body(\"monthlyRent\")\n    .isNumeric()\n    .isFloat({ min: 0 })\n    .withMessage(\"Monthly rent must be a positive number\"),\n  body(\"securityDeposit\")\n    .isNumeric()\n    .isFloat({ min: 0 })\n    .withMessage(\"Security deposit must be a positive number\"),\n  body(\"paymentDay\")\n    .isInt({ min: 1, max: 31 })\n    .withMessage(\"Payment day must be between 1 and 31\"),\n  body(\"status\").optional().isIn([\"active\", \"terminated\", \"expired\", \"draft\"]),\n  body(\"terms\").optional().isString().withMessage(\"Terms must be a string\"),\n];\n\n// GET all leases with filtering\nrouter.get(\"/\", authenticateJWT, async (req, res) => {\n  try {\n    const { status, property, tenant, page = 1, limit = 10 } = req.query;\n    const filter = {};\n\n    if (status) filter.status = status;\n    if (property) filter.property = property;\n    if (tenant) filter.tenant = tenant;\n\n    const leases = await Lease.find(filter)\n      .populate(\"property\", \"name location\")\n      .populate(\"tenant\", \"profile.firstName profile.lastName email\")\n      .populate(\"landlord\", \"profile.firstName profile.lastName email\")\n      .sort({ startDate: -1 })\n      .limit(limit * 1)\n      .skip((page - 1) * limit);\n\n    const total = await Lease.countDocuments(filter);\n\n    res.json({\n      success: true,\n      data: leases,\n      pagination: {\n        currentPage: page,\n        totalPages: Math.ceil(total / limit),\n        totalItems: total,\n        itemsPerPage: limit,\n      },\n    });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// GET single lease\nrouter.get(\"/:id\", authenticateJWT, async (req, res) => {\n  try {\n    const lease = await Lease.findById(req.params.id)\n      .populate(\"property\", \"name location\")\n      .populate(\"tenant\", \"profile.firstName profile.lastName email\")\n      .populate(\"landlord\", \"profile.firstName profile.lastName email\");\n\n    if (!lease) {\n      return res\n        .status(404)\n        .json({ success: false, message: \"Lease not found\" });\n    }\n\n    res.json({ success: true, data: lease });\n  } catch {\n    res.status(404).json({ success: false, message: \"Lease not found\" });\n  }\n});\n\n// POST create new lease\nrouter.post(\"/\", authenticateJWT, leaseValidation, async (req, res) => {\n  try {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ success: false, errors: errors.array() });\n    }\n\n    const lease = new Lease({\n      ...req.body,\n      createdBy: req.user.userId,\n    });\n\n    await lease.save();\n    await lease.populate(\"property tenant landlord\");\n\n    res.status(201).json({ success: true, data: lease });\n  } catch {\n    res.status(400).json({ success: false, message: error.message });\n  }\n});\n\n// PUT update lease\nrouter.put(\"/:id\", authenticateJWT, leaseValidation, async (req, res) => {\n  try {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ success: false, errors: errors.array() });\n    }\n\n    const lease = await Lease.findByIdAndUpdate(req.params.id, req.body, {\n      new: true,\n      runValidators: true,\n    }).populate(\"property tenant landlord\");\n\n    if (!lease) {\n      return res\n        .status(404)\n        .json({ success: false, message: \"Lease not found\" });\n    }\n\n    res.json({ success: true, data: lease });\n  } catch {\n    res.status(404).json({ success: false, message: \"Lease not found\" });\n  }\n});\n\n// DELETE lease\nrouter.delete(\"/:id\", authenticateJWT, authorizeAdmin, async (req, res) => {\n  try {\n    const lease = await Lease.findByIdAndDelete(req.params.id);\n\n    if (!lease) {\n      return res\n        .status(404)\n        .json({ success: false, message: \"Lease not found\" });\n    }\n\n    res.json({ success: true, message: \"Lease deleted successfully\" });\n  } catch {\n    res.status(404).json({ success: false, message: \"Lease not found\" });\n  }\n});\n\n// GET overdue leases report\nrouter.get(\"/reports/overdue\", authenticateJWT, async (req, res) => {\n  try {\n    const leases = await Lease.find({\n      status: \"active\",\n      endDate: { $lt: new Date() },\n    })\n      .populate(\"property\", \"name location\")\n      .populate(\"tenant\", \"profile.firstName profile.lastName email\")\n      .populate(\"landlord\", \"profile.firstName profile.lastName email\")\n      .sort({ endDate: 1 });\n\n    res.json({ success: true, data: leases });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\nexport default router;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\paymentRoutes.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":59,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":59,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":79,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":79,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":102,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":102,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":127,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":127,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":144,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":144,"endColumn":58}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import express from \"express\";\nimport Payment from \"../models/Payment.js\";\nimport {\n  authenticateJWT,\n  authorizeAdmin,\n} from \"../middleware/authMiddleware.enhanced.js\";\nimport { body, validationResult } from \"express-validator\";\n\nconst router = express.Router();\n\nconst paymentValidation = [\n  body(\"rent\").isMongoId().withMessage(\"Valid rent ID is required\"),\n  body(\"amount\")\n    .isNumeric()\n    .isFloat({ min: 0 })\n    .withMessage(\"Amount must be a positive number\"),\n  body(\"paymentDate\")\n    .optional()\n    .isISO8601()\n    .withMessage(\"Valid payment date is required\"),\n  body(\"paymentMethod\")\n    .isIn([\"cash\", \"bank_transfer\", \"check\", \"credit_card\", \"direct_debit\"])\n    .withMessage(\"Invalid payment method\"),\n  body(\"status\")\n    .optional()\n    .isIn([\"pending\", \"completed\", \"failed\", \"refunded\"]),\n  body(\"receiptNumber\").optional().isString(),\n];\n\n// GET all payments with filtering\nrouter.get(\"/\", authenticateJWT, async (req, res) => {\n  try {\n    const { status, tenant, page = 1, limit = 10 } = req.query;\n    const filter = {};\n    if (status) filter.status = status;\n    if (tenant) filter.tenant = tenant;\n\n    const payments = await Payment.find(filter)\n      .populate(\"rent\")\n      .populate(\"tenant\", \"profile.firstName profile.lastName email\")\n      .populate(\"processedBy\", \"profile.firstName profile.lastName\")\n      .sort({ paymentDate: -1 })\n      .limit(limit * 1)\n      .skip((page - 1) * limit);\n\n    const total = await Payment.countDocuments(filter);\n\n    res.json({\n      success: true,\n      data: payments,\n      pagination: {\n        currentPage: page,\n        totalPages: Math.ceil(total / limit),\n        totalItems: total,\n        itemsPerPage: limit,\n      },\n    });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// GET single payment\nrouter.get(\"/:id\", authenticateJWT, async (req, res) => {\n  try {\n    const payment = await Payment.findById(req.params.id)\n      .populate(\"rent\")\n      .populate(\"tenant\", \"profile.firstName profile.lastName email\")\n      .populate(\"processedBy\", \"profile.firstName profile.lastName\");\n\n    if (!payment) {\n      return res\n        .status(404)\n        .json({ success: false, message: \"Payment not found\" });\n    }\n\n    res.json({ success: true, data: payment });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// POST create new payment\nrouter.post(\"/\", authenticateJWT, paymentValidation, async (req, res) => {\n  try {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ success: false, errors: errors.array() });\n    }\n\n    const payment = new Payment({\n      ...req.body,\n      processedBy: req.user.userId,\n      tenant: req.body.tenant,\n    });\n\n    await payment.save();\n    await payment.populate(\"rent tenant processedBy\");\n\n    res.status(201).json({ success: true, data: payment });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// PUT update payment\nrouter.put(\"/:id\", authenticateJWT, paymentValidation, async (req, res) => {\n  try {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ success: false, errors: errors.array() });\n    }\n\n    const payment = await Payment.findByIdAndUpdate(req.params.id, req.body, {\n      new: true,\n      runValidators: true,\n    }).populate(\"rent tenant processedBy\");\n\n    if (!payment) {\n      return res\n        .status(404)\n        .json({ success: false, message: \"Payment not found\" });\n    }\n\n    res.json({ success: true, data: payment });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// DELETE payment\nrouter.delete(\"/:id\", authenticateJWT, authorizeAdmin, async (req, res) => {\n  try {\n    const payment = await Payment.findByIdAndDelete(req.params.id);\n\n    if (!payment) {\n      return res\n        .status(404)\n        .json({ success: false, message: \"Payment not found\" });\n    }\n\n    res.json({ success: true, message: \"Payment deleted successfully\" });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\nexport default router;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\projectRoutes.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\projects.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":23,"column":16,"nodeType":"Identifier","messageId":"undef","endLine":23,"endColumn":21},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":44,"column":46,"nodeType":"Identifier","messageId":"undef","endLine":44,"endColumn":51},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":80,"column":46,"nodeType":"Identifier","messageId":"undef","endLine":80,"endColumn":51},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":84,"column":18,"nodeType":"Identifier","messageId":"undef","endLine":84,"endColumn":23},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":105,"column":37,"nodeType":"Identifier","messageId":"undef","endLine":105,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":122,"column":37,"nodeType":"Identifier","messageId":"undef","endLine":122,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":159,"column":40,"nodeType":"Identifier","messageId":"undef","endLine":159,"endColumn":45}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import express from \"express\";\nimport mongoose from \"mongoose\";\n\nimport {\n  authenticateJWT,\n  authorizeAdmin,\n} from \"../middleware/authMiddleware.js\";\nimport Project from \"../models/Project.js\";\n\nconst router = express.Router();\n\n// Get all projects (public)\nrouter.get(\"/\", async (req, res) => {\n  try {\n    const projects = await Project.find().populate(\"tenant\", \"name\");\n    res.status(200).json({\n      success: true,\n      data: projects,\n    });\n  } catch {\n    res.status(500).json({\n      success: false,\n      message: error.message,\n    });\n  }\n});\n\n// Get project by ID (public)\nrouter.get(\"/:id\", async (req, res) => {\n  try {\n    if (!mongoose.Types.ObjectId.isValid(req.params.id)) {\n      return res.status(400).json({ message: \"Invalid project ID format\" });\n    }\n\n    const project = await Project.findById(req.params.id).populate(\n      \"tenant\",\n      \"name\",\n    );\n    if (!project) {\n      return res.status(404).json({ message: \"Project not found\" });\n    }\n    res.json(project);\n  } catch {\n    console.error(\"Error fetching project:\", error);\n    res.status(500).json({ message: \"Server error while fetching project\" });\n  }\n});\n\n// Create new project (authenticated users)\nrouter.post(\"/\", authenticateJWT, async (req, res) => {\n  try {\n    const { name, description, type, location, financials, timeline, tenant } =\n      req.body;\n\n    // Validate required fields\n    if (!name || !description || !type || !financials || !timeline) {\n      return res.status(400).json({\n        message:\n          \"Missing required fields: name, description, type, financials, and timeline are required\",\n      });\n    }\n\n    const project = new Project({\n      name,\n      description,\n      type,\n      location,\n      financials,\n      timeline,\n      tenant: tenant || new mongoose.Types.ObjectId(), // Use provided tenant or create mock\n      createdBy: req.user._id,\n      status: \"draft\",\n    });\n\n    await project.save();\n\n    // Return the project without populating createdBy to maintain ID format\n    res.status(201).json(project);\n  } catch {\n    console.error(\"Project creation error:\", error);\n    res\n      .status(500)\n      .json({\n        message: error.message || \"Server error during project creation\",\n      });\n  }\n});\n\n// Update project (admin only)\nrouter.put(\"/:id\", authenticateJWT, authorizeAdmin, async (req, res) => {\n  try {\n    if (!mongoose.Types.ObjectId.isValid(req.params.id)) {\n      return res.status(400).json({ message: \"Invalid project ID format\" });\n    }\n\n    const project = await Project.findByIdAndUpdate(req.params.id, req.body, {\n      new: true,\n      runValidators: true,\n    });\n    if (!project) {\n      return res.status(404).json({ message: \"Project not found\" });\n    }\n    res.json(project);\n  } catch {\n    res.status(400).json({ message: error.message });\n  }\n});\n\n// Delete project (admin only)\nrouter.delete(\"/:id\", authenticateJWT, authorizeAdmin, async (req, res) => {\n  try {\n    if (!mongoose.Types.ObjectId.isValid(req.params.id)) {\n      return res.status(400).json({ message: \"Invalid project ID format\" });\n    }\n\n    const project = await Project.findByIdAndDelete(req.params.id);\n    if (!project) {\n      return res.status(404).json({ message: \"Project not found\" });\n    }\n    res.json({ message: \"Project deleted successfully\" });\n  } catch {\n    res.status(500).json({ message: error.message });\n  }\n});\n\n// Simulated investment route (authenticated)\nrouter.post(\"/:id/invest\", authenticateJWT, async (req, res) => {\n  try {\n    const projectId = req.params.id;\n    const userId = req.user.id;\n    const { amount } = req.body;\n\n    if (!amount || amount <= 0) {\n      return res\n        .status(400)\n        .json({ message: \"Investment amount must be greater than zero\" });\n    }\n\n    if (!mongoose.Types.ObjectId.isValid(projectId)) {\n      return res.status(400).json({ message: \"Invalid project ID format\" });\n    }\n\n    const project = await Project.findById(projectId);\n    if (!project) {\n      return res.status(404).json({ message: \"Project not found\" });\n    }\n\n    // Simulate investment logic\n    res.status(201).json({\n      message: \"Investment successful (simulated)\",\n      investment: {\n        userId,\n        projectId,\n        amount,\n        investedAt: new Date(),\n      },\n    });\n  } catch {\n    console.error(\"Investment error:\", error);\n    res.status(500).json({ message: \"Server error during investment\" });\n  }\n});\n\nexport default router;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\rentRoutes.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":58,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":58,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":79,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":79,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":101,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":101,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":126,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":126,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":143,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":143,"endColumn":58},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":160,"column":53,"nodeType":"Identifier","messageId":"undef","endLine":160,"endColumn":58}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import express from \"express\";\nimport Rent from \"../models/Rent.js\";\nimport {\n  authenticateJWT,\n  authorizeAdmin,\n} from \"../middleware/authMiddleware.enhanced.js\";\nimport { body, validationResult } from \"express-validator\";\n\nconst router = express.Router();\n\n// Validation rules\nconst rentValidation = [\n  body(\"property\").isMongoId().withMessage(\"Valid property ID is required\"),\n  body(\"tenant\").isMongoId().withMessage(\"Valid tenant ID is required\"),\n  body(\"lease\").isMongoId().withMessage(\"Valid lease ID is required\"),\n  body(\"amount\")\n    .isNumeric()\n    .isFloat({ min: 0 })\n    .withMessage(\"Amount must be a positive number\"),\n  body(\"dueDate\").isISO8601().withMessage(\"Valid due date is required\"),\n  body(\"status\").optional().isIn([\"pending\", \"paid\", \"overdue\", \"cancelled\"]),\n  body(\"paymentMethod\")\n    .optional()\n    .isIn([\"cash\", \"bank_transfer\", \"check\", \"credit_card\", \"direct_debit\"]),\n];\n\n// GET all rents with filtering\nrouter.get(\"/\", authenticateJWT, async (req, res) => {\n  try {\n    const { status, property, tenant, page = 1, limit = 10 } = req.query;\n    const filter = {};\n\n    if (status) filter.status = status;\n    if (property) filter.property = property;\n    if (tenant) filter.tenant = tenant;\n\n    const rents = await Rent.find(filter)\n      .populate(\"property\", \"name location\")\n      .populate(\"tenant\", \"profile.firstName profile.lastName email\")\n      .populate(\"lease\", \"startDate endDate\")\n      .sort({ dueDate: -1 })\n      .limit(limit * 1)\n      .skip((page - 1) * limit);\n\n    const total = await Rent.countDocuments(filter);\n\n    res.json({\n      success: true,\n      data: rents,\n      pagination: {\n        currentPage: page,\n        totalPages: Math.ceil(total / limit),\n        totalItems: total,\n        itemsPerPage: limit,\n      },\n    });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// GET single rent\nrouter.get(\"/:id\", authenticateJWT, async (req, res) => {\n  try {\n    const rent = await Rent.findById(req.params.id)\n      .populate(\"property\", \"name location\")\n      .populate(\"tenant\", \"profile.firstName profile.lastName email\")\n      .populate(\"lease\", \"startDate endDate monthlyRent\")\n      .populate(\"createdBy\", \"profile.firstName profile.lastName\");\n\n    if (!rent) {\n      return res\n        .status(404)\n        .json({ success: false, message: \"Rent not found\" });\n    }\n\n    res.json({ success: true, data: rent });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// POST create new rent\nrouter.post(\"/\", authenticateJWT, rentValidation, async (req, res) => {\n  try {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ success: false, errors: errors.array() });\n    }\n\n    const rent = new Rent({\n      ...req.body,\n      createdBy: req.user.userId,\n    });\n\n    await rent.save();\n    await rent.populate(\"property tenant lease createdBy\");\n\n    res.status(201).json({ success: true, data: rent });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// PUT update rent\nrouter.put(\"/:id\", authenticateJWT, rentValidation, async (req, res) => {\n  try {\n    const errors = validationResult(req);\n    if (!errors.isEmpty()) {\n      return res.status(400).json({ success: false, errors: errors.array() });\n    }\n\n    const rent = await Rent.findByIdAndUpdate(req.params.id, req.body, {\n      new: true,\n      runValidators: true,\n    }).populate(\"property tenant lease createdBy\");\n\n    if (!rent) {\n      return res\n        .status(404)\n        .json({ success: false, message: \"Rent not found\" });\n    }\n\n    res.json({ success: true, data: rent });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// DELETE rent\nrouter.delete(\"/:id\", authenticateJWT, authorizeAdmin, async (req, res) => {\n  try {\n    const rent = await Rent.findByIdAndDelete(req.params.id);\n\n    if (!rent) {\n      return res\n        .status(404)\n        .json({ success: false, message: \"Rent not found\" });\n    }\n\n    res.json({ success: true, message: \"Rent deleted successfully\" });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\n// GET overdue rents\nrouter.get(\"/reports/overdue\", authenticateJWT, async (req, res) => {\n  try {\n    const overdueRents = await Rent.find({\n      status: \"pending\",\n      dueDate: { $lt: new Date() },\n    })\n      .populate(\"property\", \"name location\")\n      .populate(\"tenant\", \"profile.firstName profile.lastName email\")\n      .sort({ dueDate: 1 });\n\n    res.json({ success: true, data: overdueRents });\n  } catch {\n    res.status(500).json({ success: false, message: error.message });\n  }\n});\n\nexport default router;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\sciExpertiseRoutes.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\routes\\test.js","messages":[{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":33,"column":51,"nodeType":"Identifier","messageId":"undef","endLine":33,"endColumn":56},{"ruleId":"no-undef","severity":2,"message":"'error' is not defined.","line":43,"column":51,"nodeType":"Identifier","messageId":"undef","endLine":43,"endColumn":56}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const express = require(\"express\");\nconst router = express.Router();\nconst { seedDatabase, clearDatabase } = require(\"../factories/utils\");\n\n// Test API endpoint for Cypress\nrouter.post(\"/seed\", async (req, res) => {\n  try {\n    const { users = 5, tenants = 2, projects = 10, clear = false } = req.body;\n\n    if (clear) {\n      await clearDatabase();\n    }\n\n    const seedData = await seedDatabase({\n      users,\n      tenants,\n      projects,\n      sciResources: 5,\n      donations: 20,\n    });\n\n    res.json({\n      success: true,\n      data: {\n        users: seedData.users.length,\n        tenants: seedData.tenants.length,\n        projects: seedData.projects.length,\n        sciResources: seedData.sciResources.length,\n        donations: seedData.donations?.length || 0,\n      },\n    });\n  } catch {\n    res.status(500).json({ success: false, error: error.message });\n  }\n});\n\n// Clear test database\nrouter.post(\"/clear\", async (req, res) => {\n  try {\n    await clearDatabase();\n    res.json({ success: true, message: \"Database cleared\" });\n  } catch {\n    res.status(500).json({ success: false, error: error.message });\n  }\n});\n\nmodule.exports = router;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\diagnose-express5-issues.cjs","messages":[{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":106,"column":35,"nodeType":"Identifier","messageId":"undef","endLine":106,"endColumn":42},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":113,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":113,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":120,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":120,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":124,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":124,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":125,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":125,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":128,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":128,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":132,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":132,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":135,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":135,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":137,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":137,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":138,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":138,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":139,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":139,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":141,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":141,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":144,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":144,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":145,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":145,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":146,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":146,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":147,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":147,"endColumn":12}],"suppressedMessages":[],"errorCount":16,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\r\n\r\n/* eslint-env node */\r\n/* eslint-disable no-console */\r\n\r\n/**\r\n * Express 5 Route Pattern Diagnostic\r\n * Identifies \"TypeError: Missing parameter name\" issues\r\n */\r\n\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nclass Express5Diagnostic {\r\n  constructor() {\r\n    this.issues = [];\r\n  }\r\n\r\n  scanFile(filePath) {\r\n    try {\r\n      const content = fs.readFileSync(filePath, 'utf8');\r\n      const lines = content.split('\\n');\r\n      const issues = [];\r\n\r\n      lines.forEach((line, index) => {\r\n        // Check for invalid wildcards\r\n        const wildcardPattern = /['\"][^'\"]*\\*[^'\"]*['\"]/g;\r\n        const wildcardMatches = line.match(wildcardPattern);\r\n        \r\n        if (wildcardMatches) {\r\n          wildcardMatches.forEach(match => {\r\n            if (!match.includes('*splat') && !match.includes('*path') && !match.includes('*wildcard')) {\r\n              issues.push({\r\n                line: index + 1,\r\n                type: 'wildcard',\r\n                original: match,\r\n                fixed: match.replace('*', '*splat')\r\n              });\r\n            }\r\n          });\r\n        }\r\n\r\n        // Check for invalid parameters\r\n        const paramPattern = /['\"][^'\"]*:[^a-zA-Z0-9_][^'\"]*['\"]/g;\r\n        const paramMatches = line.match(paramPattern);\r\n        \r\n        if (paramMatches) {\r\n          paramMatches.forEach(match => {\r\n            if (!match.match(/:[a-zA-Z][a-zA-Z0-9_]*/)) {\r\n              issues.push({\r\n                line: index + 1,\r\n                type: 'parameter',\r\n                original: match,\r\n                fixed: match.replace(/:(?![a-zA-Z][a-zA-Z0-9_]*)/g, ':param')\r\n              });\r\n            }\r\n          });\r\n        }\r\n\r\n        // Check route definitions\r\n        const routePattern = /(app|router)\\.(get|post|put|delete|patch|use)\\s*\\(\\s*['\"`]([^'\"`]*[:*][^'\"`]*)['\"`]/g;\r\n        let routeMatch;\r\n        while ((routeMatch = routePattern.exec(line)) !== null) {\r\n          const route = routeMatch[3];\r\n          if (route.includes('*') && !route.includes('*splat') && !route.includes('*path')) {\r\n            issues.push({\r\n              line: index + 1,\r\n              type: 'route_wildcard',\r\n              original: route,\r\n              fixed: route.replace('*', '*splat')\r\n            });\r\n          }\r\n          if (route.includes(':') && !route.match(/:[a-zA-Z][a-zA-Z0-9_]*/)) {\r\n            issues.push({\r\n              line: index + 1,\r\n              type: 'route_parameter',\r\n              original: route,\r\n              fixed: route.replace(/:(?![a-zA-Z][a-zA-Z0-9_]*)/g, ':param')\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      return issues;\r\n    } catch (_error) {\r\n      return [];\r\n    }\r\n  }\r\n\r\n  scanDirectory(dir) {\r\n    const allIssues = [];\r\n    \r\n    try {\r\n      const files = fs.readdirSync(dir);\r\n      \r\n      files.forEach(file => {\r\n        const filePath = path.join(dir, file);\r\n        const stat = fs.statSync(filePath);\r\n\r\n        if (stat.isDirectory() && !file.startsWith('node_modules') && !file.startsWith('.')) {\r\n          allIssues.push(...this.scanDirectory(filePath));\r\n        } else if (stat.isFile() && (file.endsWith('.js') || file.endsWith('.ts'))) {\r\n          const issues = this.scanFile(filePath);\r\n          if (issues.length > 0) {\r\n            allIssues.push({\r\n              file: path.relative(process.cwd(), filePath),\r\n              issues\r\n            });\r\n          }\r\n        }\r\n      });\r\n    } catch (_error) {\r\n      console.error(`Error scanning directory ${dir}:`, error.message);\r\n    }\r\n\r\n    return allIssues;\r\n  }\r\n\r\n  run() {\r\n    console.log('ðŸ” Scanning for Express 5 path-to-regexp issues...\\n');\r\n    \r\n    const issues = this.scanDirectory('./');\r\n    \r\n    console.log('\\nðŸ“Š EXPRESS 5 ROUTE PATTERN DIAGNOSTIC REPORT\\n');\r\n    console.log('='.repeat(60));\r\n\r\n    if (issues.length === 0) {\r\n      console.log('âœ… No issues found - all route patterns are Express 5 compliant!');\r\n      return;\r\n    }\r\n\r\n    console.log(`âŒ Found ${issues.length} files with route pattern issues:\\n`);\r\n\r\n    issues.forEach(({ file, issues: fileIssues }) => {\r\n      console.log(`ðŸ“ ${file}`);\r\n      fileIssues.forEach(issue => {\r\n        console.log(`  Line ${issue.line}: ${issue.type}`);\r\n        console.log(`    FROM: ${issue.original}`);\r\n        console.log(`    TO:   ${issue.fixed}`);\r\n      });\r\n      console.log();\r\n    });\r\n\r\n    console.log('ðŸ”§ QUICK FIXES:');\r\n    console.log('1. Replace wildcards: \"*\" â†’ \"*splat\" or \"*path\"');\r\n    console.log('2. Ensure all parameters have valid names: [a-zA-Z][a-zA-Z0-9_]*');\r\n    console.log('3. Update test configurations and mocking setups');\r\n  }\r\n}\r\n\r\n// Run the diagnostic\r\nconst diagnostic = new Express5Diagnostic();\r\ndiagnostic.run();\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\diagnose-express5-issues.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\diagnose-route-issues.js","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\/.","line":8,"column":9,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":8,"endColumn":10,"suggestions":[{"messageId":"removeEscape","fix":{"range":[187,188],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[187,187],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-unused-vars","severity":1,"message":"'FILES_TO_SCAN' is assigned a value but never used.","line":14,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":14,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\r\n\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\n// Scan for route patterns that might cause \"Missing parameter name\"\r\nconst ROUTE_PATTERNS = [\r\n  /:\\s*[\\/\\s]/g,  // Colon followed by space or slash\r\n  /:\\s*$/g,       // Colon at end of route\r\n  /\\/:\\//g,       // Colon between slashes\r\n  /\\/:\\s*$/g,     // Colon at end with optional space\r\n];\r\n\r\nconst FILES_TO_SCAN = [\r\n  'routes/*.js',\r\n  'app.js',\r\n  'src/app.js',\r\n  'src/routes/*.js',\r\n  'middleware/*.js'\r\n];\r\n\r\nfunction scanFile(filePath) {\r\n  const content = fs.readFileSync(filePath, 'utf8');\r\n  const lines = content.split('\\n');\r\n  const issues = [];\r\n\r\n  lines.forEach((line, index) => {\r\n    ROUTE_PATTERNS.forEach(pattern => {\r\n      const matches = line.match(pattern);\r\n      if (matches) {\r\n        issues.push({\r\n          line: index + 1,\r\n          content: line.trim(),\r\n          pattern: pattern.toString(),\r\n          matches\r\n        });\r\n      }\r\n    });\r\n  });\r\n\r\n  return issues;\r\n}\r\n\r\nfunction scanDirectory(dirPath) {\r\n  const files = fs.readdirSync(dirPath, { withFileTypes: true });\r\n  const allIssues = [];\r\n\r\n  files.forEach(file => {\r\n    const fullPath = path.join(dirPath, file.name);\r\n    \r\n    if (file.isDirectory() && !file.name.startsWith('.')) {\r\n      try {\r\n        const subIssues = scanDirectory(fullPath);\r\n        allIssues.push(...subIssues);\r\n      } catch (err) {\r\n        // Skip directories we can't read\r\n      }\r\n    } else if (file.isFile() && file.name.endsWith('.js')) {\r\n      try {\r\n        const issues = scanFile(fullPath);\r\n        if (issues.length > 0) {\r\n          allIssues.push({\r\n            file: fullPath,\r\n            issues\r\n          });\r\n        }\r\n      } catch (err) {\r\n        console.error(`Error scanning ${fullPath}:`, err.message);\r\n      }\r\n    }\r\n  });\r\n\r\n  return allIssues;\r\n}\r\n\r\nconsole.log('ðŸ” Scanning for route pattern issues...\\n');\r\n\r\nconst backendDir = path.join(__dirname, '..');\r\nconst issues = scanDirectory(backendDir);\r\n\r\nif (issues.length === 0) {\r\n  console.log('âœ… No route pattern issues found');\r\n} else {\r\n  console.log(`âŒ Found ${issues.length} files with potential issues:\\n`);\r\n  \r\n  issues.forEach(({ file, issues }) => {\r\n    console.log(`ðŸ“ ${file}`);\r\n    issues.forEach(issue => {\r\n      console.log(`  Line ${issue.line}: ${issue.content}`);\r\n      console.log(`  Pattern: ${issue.pattern}`);\r\n    });\r\n    console.log();\r\n  });\r\n}\r\n\r\n// Also check for Express route registration\r\nconsole.log('\\nðŸ” Checking Express route registration...\\n');\r\n\r\ntry {\r\n  const appFiles = ['app.js', 'src/app.js'];\r\n  appFiles.forEach(appFile => {\r\n    const appPath = path.join(backendDir, appFile);\r\n    if (fs.existsSync(appPath)) {\r\n      const content = fs.readFileSync(appPath, 'utf8');\r\n      const routeMatches = content.match(/app\\.(get|post|put|delete|use)\\s*\\(\\s*['\"`][^'\"`]*['\"`]/g);\r\n      if (routeMatches) {\r\n        console.log(`ðŸ“ ${appFile} routes:`);\r\n        routeMatches.forEach(route => console.log(`  ${route}`));\r\n      }\r\n    }\r\n  });\r\n} catch (err) {\r\n  console.error('Error checking app files:', err.message);\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\diagnose-route-issues.mjs","messages":[{"ruleId":"no-useless-escape","severity":2,"message":"Unnecessary escape character: \\/.","line":8,"column":9,"nodeType":"Literal","messageId":"unnecessaryEscape","endLine":8,"endColumn":10,"suggestions":[{"messageId":"removeEscape","fix":{"range":[177,178],"text":""},"desc":"Remove the `\\`. This maintains the current functionality."},{"messageId":"escapeBackslash","fix":{"range":[177,177],"text":"\\"},"desc":"Replace the `\\` with `\\\\` to include the actual backslash character."}]},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":60,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":60,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":68,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":68,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'process' is not defined.","line":70,"column":30,"nodeType":"Identifier","messageId":"undef","endLine":70,"endColumn":37},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":74,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":74,"endColumn":10},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":76,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":76,"endColumn":10},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":79,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":79,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":81,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":81,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":82,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":82,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":84,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":84,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":89,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":89,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":99,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":99,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":100,"column":39,"nodeType":"Identifier","messageId":"undef","endLine":100,"endColumn":46},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":105,"column":3,"nodeType":"Identifier","messageId":"undef","endLine":105,"endColumn":10}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\r\n\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\n// Scan for route patterns that might cause \"Missing parameter name\"\r\nconst ROUTE_PATTERNS = [\r\n  /:\\s*[\\/\\s]/g,  // Colon followed by space or slash\r\n  /:\\s*$/g,       // Colon at end of route\r\n  /\\/:\\//g,       // Colon between slashes\r\n  /\\/:\\s*$/g,     // Colon at end with optional space\r\n];\r\n\r\nfunction scanFile(filePath) {\r\n  const content = fs.readFileSync(filePath, 'utf8');\r\n  const lines = content.split('\\n');\r\n  const issues = [];\r\n\r\n  lines.forEach((line, index) => {\r\n    ROUTE_PATTERNS.forEach(pattern => {\r\n      const matches = line.match(pattern);\r\n      if (matches) {\r\n        issues.push({\r\n          line: index + 1,\r\n          content: line.trim(),\r\n          pattern: pattern.toString(),\r\n          matches\r\n        });\r\n      }\r\n    });\r\n  });\r\n\r\n  return issues;\r\n}\r\n\r\nfunction scanDirectory(dirPath) {\r\n  const files = fs.readdirSync(dirPath, { withFileTypes: true });\r\n  const allIssues = [];\r\n\r\n  files.forEach(file => {\r\n    const fullPath = path.join(dirPath, file.name);\r\n    \r\n    if (file.isDirectory() && !file.name.startsWith('.')) {\r\n      try {\r\n        const subIssues = scanDirectory(fullPath);\r\n        allIssues.push(...subIssues);\r\n      } catch (err) {\r\n        // Skip directories we can't read\r\n      }\r\n    } else if (file.isFile() && file.name.endsWith('.js')) {\r\n      try {\r\n        const issues = scanFile(fullPath);\r\n        if (issues.length > 0) {\r\n          allIssues.push({\r\n            file: fullPath,\r\n            issues\r\n          });\r\n        }\r\n      } catch (err) {\r\n        console.error(`Error scanning ${fullPath}:`, err.message);\r\n      }\r\n    }\r\n  });\r\n\r\n  return allIssues;\r\n}\r\n\r\nconsole.log('ðŸ” Scanning for route pattern issues...\\n');\r\n\r\nconst backendDir = path.join(process.cwd());\r\nconst issues = scanDirectory(backendDir);\r\n\r\nif (issues.length === 0) {\r\n  console.log('âœ… No route pattern issues found');\r\n} else {\r\n  console.log(`âŒ Found ${issues.length} files with potential issues:\\n`);\r\n  \r\n  issues.forEach(({ file, issues }) => {\r\n    console.log(`ðŸ“ ${file}`);\r\n    issues.forEach(issue => {\r\n      console.log(`  Line ${issue.line}: ${issue.content}`);\r\n      console.log(`  Pattern: ${issue.pattern}`);\r\n    });\r\n    console.log();\r\n  });\r\n}\r\n\r\n// Also check for Express route registration\r\nconsole.log('\\nðŸ” Checking Express route registration...\\n');\r\n\r\ntry {\r\n  const appFiles = ['app.js', 'src/app.js'];\r\n  appFiles.forEach(appFile => {\r\n    const appPath = path.join(backendDir, appFile);\r\n    if (fs.existsSync(appPath)) {\r\n      const content = fs.readFileSync(appPath, 'utf8');\r\n      const routeMatches = content.match(/app\\.(get|post|put|delete|use)\\s*\\(\\s*['\"`][^'\"`]*['\"`]/g);\r\n      if (routeMatches) {\r\n        console.log(`ðŸ“ ${appFile} routes:`);\r\n        routeMatches.forEach(route => console.log(`  ${route}`));\r\n      }\r\n    }\r\n  });\r\n} catch (err) {\r\n  console.error('Error checking app files:', err.message);\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\fix-express5-routes.cjs","messages":[{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":85,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":85,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":115,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":115,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":116,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":116,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":119,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":119,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":123,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":123,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":126,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":126,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":128,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":128,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":129,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":129,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":130,"column":9,"nodeType":"Identifier","messageId":"undef","endLine":130,"endColumn":16},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":132,"column":7,"nodeType":"Identifier","messageId":"undef","endLine":132,"endColumn":14},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":135,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":135,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":136,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":136,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":137,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":137,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":138,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":138,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":142,"column":5,"nodeType":"Identifier","messageId":"undef","endLine":142,"endColumn":12},{"ruleId":"no-undef","severity":2,"message":"'__dirname' is not defined.","line":145,"column":23,"nodeType":"Identifier","messageId":"undef","endLine":145,"endColumn":32},{"ruleId":"no-undef","severity":2,"message":"'__dirname' is not defined.","line":145,"column":65,"nodeType":"Identifier","messageId":"undef","endLine":145,"endColumn":74},{"ruleId":"no-undef","severity":2,"message":"'__dirname' is not defined.","line":145,"column":84,"nodeType":"Identifier","messageId":"undef","endLine":145,"endColumn":93}],"suppressedMessages":[],"errorCount":18,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\r\n/* eslint-disable no-console */\r\n\r\n/**\r\n * Express 5 Route Pattern Fixer (CommonJS)\r\n * Fixes \"TypeError: Missing parameter name\" issues with path-to-regexp v8\r\n */\r\n\r\nconst fs = require('fs');\r\nconst path = require('path');\r\n\r\nclass RouteFixer {\r\n  constructor() {\r\n    this.issues = [];\r\n    this.fixed = 0;\r\n  }\r\n\r\n  scanFile(filePath) {\r\n    try {\r\n      const content = fs.readFileSync(filePath, 'utf8');\r\n      const lines = content.split('\\n');\r\n      const issues = [];\r\n\r\n      lines.forEach((line, index) => {\r\n        // Check for invalid wildcards\r\n        const wildcardPattern = /['\"][^'\"]*\\*[^'\"]*['\"]/g;\r\n        const wildcardMatches = line.match(wildcardPattern);\r\n        \r\n        if (wildcardMatches) {\r\n          wildcardMatches.forEach(match => {\r\n            if (!match.includes('*splat') && !match.includes('*path') && !match.includes('*wildcard')) {\r\n              issues.push({\r\n                line: index + 1,\r\n                type: 'wildcard',\r\n                original: match,\r\n                fixed: match.replace('*', '*splat')\r\n              });\r\n            }\r\n          });\r\n        }\r\n\r\n        // Check for invalid colons\r\n        const colonPattern = /['\"][^'\"]*:[^a-zA-Z][^'\"]*['\"]/g;\r\n        const colonMatches = line.match(colonPattern);\r\n        \r\n        if (colonMatches) {\r\n          colonMatches.forEach(match => {\r\n            if (!match.match(/:[a-zA-Z][a-zA-Z0-9_]*/)) {\r\n              issues.push({\r\n                line: index + 1,\r\n                type: 'parameter',\r\n                original: match,\r\n                fixed: match.replace(/:(?![a-zA-Z][a-zA-Z0-9_]*)/g, ':param')\r\n              });\r\n            }\r\n          });\r\n        }\r\n\r\n        // Check for app.route patterns\r\n        const routePattern = /app\\.(get|post|put|delete|patch)\\s*\\(\\s*['\"]([^'\"]*[:*][^a-zA-Z0-9_][^'\"]*)['\"]/g;\r\n        let routeMatch;\r\n        while ((routeMatch = routePattern.exec(line)) !== null) {\r\n          const route = routeMatch[2];\r\n          if (route.includes('*') && !route.includes('*splat') && !route.includes('*path')) {\r\n            issues.push({\r\n              line: index + 1,\r\n              type: 'route_wildcard',\r\n              original: route,\r\n              fixed: route.replace('*', '*splat')\r\n            });\r\n          }\r\n          if (route.includes(':') && !route.match(/:[a-zA-Z][a-zA-Z0-9_]*/)) {\r\n            issues.push({\r\n              line: index + 1,\r\n              type: 'route_parameter',\r\n              original: route,\r\n              fixed: route.replace(/:(?![a-zA-Z][a-zA-Z0-9_]*)/g, ':param')\r\n            });\r\n          }\r\n        }\r\n      });\r\n\r\n      return issues;\r\n    } catch (_error) {\r\n      console.error(`Error reading ${filePath}:`, error.message);\r\n      return [];\r\n    }\r\n  }\r\n\r\n  scanDirectory(dir) {\r\n    const files = fs.readdirSync(dir);\r\n    const allIssues = [];\r\n\r\n    files.forEach(file => {\r\n      const filePath = path.join(dir, file);\r\n      const stat = fs.statSync(filePath);\r\n\r\n      if (stat.isDirectory() && !file.startsWith('node_modules') && !file.startsWith('.')) {\r\n        allIssues.push(...this.scanDirectory(filePath));\r\n      } else if (stat.isFile() && (file.endsWith('.js') || file.endsWith('.ts'))) {\r\n        const issues = this.scanFile(filePath);\r\n        if (issues.length > 0) {\r\n          allIssues.push({\r\n            file: filePath,\r\n            issues\r\n          });\r\n        }\r\n      }\r\n    });\r\n\r\n    return allIssues;\r\n  }\r\n\r\n  generateReport(issues) {\r\n    console.log('\\nðŸ“Š EXPRESS 5 ROUTE PATTERN DIAGNOSTIC REPORT\\n');\r\n    console.log('='.repeat(60));\r\n\r\n    if (issues.length === 0) {\r\n      console.log('âœ… No issues found - all route patterns are Express 5 compliant!');\r\n      return;\r\n    }\r\n\r\n    console.log(`âŒ Found ${issues.length} files with route pattern issues:\\n`);\r\n\r\n    issues.forEach(({ file, issues: fileIssues }) => {\r\n      console.log(`ðŸ“ ${file}`);\r\n      fileIssues.forEach(issue => {\r\n        console.log(`  Line ${issue.line}: ${issue.type}`);\r\n        console.log(`    FROM: ${issue.original}`);\r\n        console.log(`    TO:   ${issue.fixed}`);\r\n      });\r\n      console.log();\r\n    });\r\n\r\n    console.log('ðŸ”§ QUICK FIXES:');\r\n    console.log('1. Replace wildcards: \"*\" â†’ \"*splat\" or \"*path\"');\r\n    console.log('2. Ensure all parameters have valid names: [a-zA-Z][a-zA-Z0-9_]*');\r\n    console.log('3. Update test configurations and mocking setups');\r\n  }\r\n\r\n  main() {\r\n    console.log('ðŸ” Scanning for Express 5 path-to-regexp issues...\\n');\r\n    \r\n    // Get the correct directory path - use current directory since we're already in backend/\r\n    const targetDir = __dirname.includes('scripts') ? path.join(__dirname, '..') : __dirname;\r\n    const issues = this.scanDirectory(targetDir);\r\n    this.generateReport(issues);\r\n  }\r\n}\r\n\r\n// CLI interface\r\nif (require.main === module) {\r\n  const fixer = new RouteFixer();\r\n  fixer.main();\r\n}\r\n\r\nmodule.exports = RouteFixer;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\fix-express5-routes.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\health-check.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'__dirname' is assigned a value but never used.","line":8,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":8,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\nimport mongoose from \"path/to/your/script\";\nimport { fileURLToPath } from \"url\";\nimport path from \"path\";\n\n// Handle ES6 __dirname\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nasync function healthCheck() {\n  try {\n    console.log(\"ðŸ¥ Running health check...\");\n\n    // Check MongoDB connection\n    const mongoUri =\n      process.env.MONGODB_URI || \"mongodb://localhost:27017/sci-solia\";\n    await mongoose.connect(mongoUri);\n    console.log(\"âœ… MongoDB connection: OK\");\n\n    // Check audit log model\n    const AuditLog = (await import(\"../models/AuditLog.js\")).default;\n    const RefreshToken = (await import(\"../models/RefreshToken.js\")).default;\n\n    // Create indexes for performance\n    await AuditLog.collection.createIndex({ userId: 1, timestamp: -1 });\n    await AuditLog.collection.createIndex({ action: 1, timestamp: -1 });\n    await RefreshToken.collection.createIndex(\n      { expiresAt: 1 },\n      { expireAt: 0 },\n    );\n\n    console.log(\"âœ… Indexes created successfully\");\n\n    // Clean up expired refresh tokens\n    const result = await RefreshToken.deleteMany({\n      expiresAt: { $lt: new Date() },\n    });\n    console.log(`ðŸ§¹ Cleaned up ${result.deletedCount} expired refresh tokens`);\n\n    console.log(\"âœ… Health check completed successfully\");\n    process.exit(0);\n  } catch (_error) {\n    console.error(\"âŒ Health check failed:\", error);\n    process.exit(1);\n  }\n}\n\n// Run if called directly\nif (process.argv[1] === fileURLToPath(import.meta.url)) {\n  setupMonitoring();\n}\n\nexport default setupMonitoring;\nhealthCheck;\nasync function setupMonitoring() {\n  try {\n    console.log(\"Setting up monitoring...\");\n    // Add any monitoring setup code here\n    console.log(\"Monitoring setup complete\");\n  } catch (_error) {\n    console.error(\"Error setting up monitoring:\", error);\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\seed-dev.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'bcrypt' is assigned a value but never used.","line":4,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const mongoose = require(\"mongoose\");\nconst User = require(\"../models/User\");\nconst Project = require(\"../models/Project\");\nconst bcrypt = require(\"bcryptjs\");\n\nconst seedDatabase = async () => {\n  try {\n    await mongoose.connect(\n      process.env.MONGO_URI || \"mongodb://localhost:27017/solia_sci\",\n      {\n        useNewUrlParser: true,\n        useUnifiedTopology: true,\n      },\n    );\n\n    console.log(\"Connected to MongoDB\");\n\n    // Create test users\n    const testUsers = [\n      {\n        email: \"test@example.com\",\n        password: \"password123\",\n        name: \"Test User\",\n        role: \"investor\",\n      },\n      {\n        email: \"admin@example.com\",\n        password: \"admin123\",\n        name: \"Admin User\",\n        role: \"admin\",\n      },\n    ];\n\n    for (const userData of testUsers) {\n      const existingUser = await User.findOne({ email: userData.email });\n      if (!existingUser) {\n        const user = new User(userData);\n        await user.save();\n        console.log(`Created user: ${user.email}`);\n      } else {\n        console.log(`User already exists: ${userData.email}`);\n      }\n    }\n\n    // Create test projects\n    const testProjects = [\n      {\n        title: \"Test Project 1\",\n        description: \"A test project for Postman testing\",\n        investmentGoal: 10000,\n        currentInvestment: 2500,\n        status: \"active\",\n        category: \"renewable_energy\",\n      },\n      {\n        title: \"Test Project 2\",\n        description: \"Another test project for Postman testing\",\n        investmentGoal: 50000,\n        currentInvestment: 10000,\n        status: \"active\",\n        category: \"sustainable_agriculture\",\n      },\n    ];\n\n    for (const projectData of testProjects) {\n      const existingProject = await Project.findOne({\n        title: projectData.title,\n      });\n      if (!existingProject) {\n        const project = new Project(projectData);\n        await project.save();\n        console.log(`Created project: ${project.title}`);\n      } else {\n        console.log(`Project already exists: ${projectData.title}`);\n      }\n    }\n\n    console.log(\"Database seeded successfully!\");\n    console.log(\"\\nTest credentials:\");\n    console.log(\"Email: test@example.com, Password: password123\");\n    console.log(\"Email: admin@example.com, Password: admin123\");\n    console.log(\"\\nTest endpoints:\");\n    console.log(\"POST /api/auth/register\");\n    console.log(\"POST /api/auth/login\");\n    console.log(\"GET /api/projects\");\n    console.log(\"GET /api/projects/:id\");\n    console.log(\"POST /api/kyc/submit\");\n    console.log(\"GET /api/kyc/status\");\n  } catch (_error) {\n    console.error(\"Error seeding database:\", error);\n  } finally {\n    await mongoose.disconnect();\n  }\n};\n\n// Run the seeder\nif (require.main === module) {\n  seedDatabase();\n}\n\nmodule.exports = seedDatabase;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\setup-monitoring.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'fs' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":10},{"ruleId":"no-unused-vars","severity":1,"message":"'__dirname' is assigned a value but never used.","line":10,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\nimport mongoose from \"mongoose\";\nimport { fileURLToPath } from \"url\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport { logAudit } from \"../middleware/auditLogger.js\";\n\n// Handle ES6 __dirname\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\n\nasync function setupMonitoring() {\n  try {\n    console.log(\"ðŸ”§ Setting up monitoring and audit system...\");\n\n    // Connect to MongoDB\n    const mongoUri =\n      process.env.MONGODB_URI || \"mongodb://localhost:27017/sci-solia\";\n    await mongoose.connect(mongoUri);\n    console.log(\"âœ… Connected to MongoDB\");\n\n    // Import models dynamically\n    const AuditLog = (await import(\"../models/AuditLog.js\")).default;\n    const RefreshToken = (await import(\"../models/RefreshToken.js\")).default;\n\n    // Create indexes for performance\n    console.log(\"ðŸ“Š Creating indexes...\");\n\n    await AuditLog.collection.createIndex({ userId: 1, timestamp: -1 });\n    await AuditLog.collection.createIndex({ action: 1, timestamp: -1 });\n    await AuditLog.collection.createIndex({ resourceType: 1, resourceId: 1 });\n    await RefreshToken.collection.createIndex(\n      { expiresAt: 1 },\n      { expireAfterSeconds: 0 },\n    );\n\n    console.log(\"âœ… Indexes created successfully\");\n\n    // Clean up expired refresh tokens\n    const result = await RefreshToken.deleteMany({\n      expiresAt: { $lt: new Date() },\n    });\n    console.log(`ðŸ§¹ Cleaned up ${result.deletedCount} expired refresh tokens`);\n\n    // Create initial audit log entry\n    await logAudit(null, \"SYSTEM_STARTUP\", \"SYSTEM\", null, {\n      metadata: { message: \"Monitoring system initialized\" },\n    });\n\n    console.log(\"ðŸŽ‰ Monitoring setup completed successfully!\");\n    process.exit(0);\n  } catch (_error) {\n    console.error(\"âŒ Monitoring setup failed:\", error);\n    process.exit(1);\n  }\n}\n\n// Run if called directly\nif (process.argv[1] === fileURLToPath(import.meta.url)) {\n  setupMonitoring();\n}\n\nexport default setupMonitoring;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\setup-test-env.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'path' is defined but never used.","line":4,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":12}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\r\nimport { execSync } from 'child_process';\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\n// Create .env.test file for testing\r\nconst envTestContent = `\r\nNODE_ENV=test\r\nMONGODB_URI=mongodb://localhost:27017/scisoliainvest_test\r\nJWT_SECRET=test_jwt_secret_key_12345\r\nPORT=3001\r\n`;\r\n\r\nfs.writeFileSync('.env.test', envTestContent.trim());\r\nconsole.log('âœ… Created .env.test file');\r\n\r\n// Ensure MongoDB is running\r\ntry {\r\n  execSync('docker ps', { stdio: 'pipe' });\r\n  console.log('âœ… Docker is available');\r\n} catch (_error) {\r\n  console.log('âš ï¸  Docker not found, assuming local MongoDB');\r\n}\r\n\r\n// Create test database if it doesn't exist\r\nconsole.log('âœ… Test environment configured');\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\verify-api-corrections.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\verify-routes-and-tests-fixed.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'express' is defined but never used.","line":10,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\n\n/**\n * Comprehensive Route and Test Validation Script\n *\n * This script verifies that all routes referenced in tests actually exist\n * and that the test environment is properly configured.\n */\n\nimport express from \"express\";\nimport request from \"supertest\";\nimport mongoose from \"mongoose\";\nimport app from \"../app.js\";\n\n/**\n * Simple verification script that tests all critical routes\n */\n\nasync function verifyRoutes() {\n  console.log(\"ðŸš€ Starting comprehensive route and test validation...\");\n\n  const server = app.listen(0); // Use port 0 for dynamic port assignment\n\n  try {\n    // Ensure MongoDB connection is ready\n    if (\n      mongoose.connection.readyState !== mongoose.ConnectionStates.connected\n    ) {\n      await mongoose.connect(\n        process.env.MONGO_URI_TEST || \"mongodb://localhost:27017/testdb\",\n      );\n    }\n\n    console.log(\"âœ… Database connection established\");\n\n    // Test basic route accessibility\n    const routesToTest = [\n      {\n        method: \"POST\",\n        path: \"/api/auth/login\",\n        expectedStatus: 200,\n        payload: { email: \"test@test.com\", password: \"test123\" },\n      },\n      { method: \"GET\", path: \"/api/user/profile\", expectedStatus: 200 },\n      { method: \"GET\", path: \"/api/admin/users\", expectedStatus: 200 },\n      { method: \"GET\", path: \"/api/admin/stats\", expectedStatus: 200 },\n      { method: \"GET\", path: \"/api/admin/logs\", expectedStatus: 200 },\n    ];\n\n    let passed = 0;\n    let failed = 0;\n\n    for (const route of routesToTest) {\n      try {\n        let response;\n\n        if (route.method === \"POST\") {\n          response = await request(app).post(route.path).send(route.payload);\n        } else {\n          response = await request(app).get(route.path);\n        }\n\n        const status = response.status;\n        const expected = route.expectedStatus;\n\n        if (status === expected) {\n          console.log(`âœ… ${route.method} ${route.path} - Status ${status}`);\n          passed++;\n        } else {\n          console.log(\n            `âŒ ${route.method} ${route.path} - Status ${status} (expected ${expected})`,\n          );\n          failed++;\n        }\n      } catch (_error) {\n        console.log(\n          `âŒ ${route.method} ${route.path} - Error: ${error.message}`,\n        );\n        failed++;\n      }\n    }\n\n    console.log(`\\nðŸ“Š Results: ${passed} passed, ${failed} failed`);\n\n    if (failed === 0) {\n      console.log(\"ðŸŽ‰ All routes are correctly configured and accessible!\");\n    }\n  } catch (_error) {\n    console.error(\"âŒ Verification failed:\", error);\n  } finally {\n    await mongoose.connection.close();\n    server.close();\n  }\n}\n\n// Run verification\nverifyRoutes().catch(console.error);\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\scripts\\verify-routes-and-tests.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'express' is defined but never used.","line":10,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":10,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'adminUser' is assigned a value but never used.","line":37,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":37,"endColumn":28},{"ruleId":"no-unused-vars","severity":1,"message":"'regularUser' is assigned a value but never used.","line":39,"column":19,"nodeType":"Identifier","messageId":"unusedVar","endLine":39,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":0,"source":"#!/usr/bin/env node\n\n/**\n * Route and Test Verification Script\n *\n * This script verifies that all routes referenced in tests actually exist\n * and that the test environment is properly configured.\n */\n\nimport express from \"express\";\nimport request from \"supertest\";\nimport mongoose from \"mongoose\";\nimport app from \"../app.js\";\nimport { TestHelpers } from \"../tests/setup/test_helpers.js\";\n\nconst PORT = process.env.PORT || 3001;\n\nasync function verifyRoutes() {\n  console.log(\"ðŸ” Verifying routes and test alignment...\\n\");\n\n  const server = app.listen(PORT);\n\n  try {\n    // Test database connection\n    if (\n      mongoose.connection.readyState !== mongoose.ConnectionStates.connected\n    ) {\n      await mongoose.connect(\n        process.env.MONGO_URI_TEST || \"mongodb://localhost:27017/testdb\",\n      );\n    }\n\n    // Clean up test data\n    await TestHelpers.cleanupTestUsers();\n\n    // Create test users\n    const { user: adminUser, token: adminToken } =\n      await TestHelpers.createAdminUser();\n    const { user: regularUser, token: userToken } =\n      await TestHelpers.createRegularUser();\n\n    const routesToTest = [\n      {\n        method: \"POST\",\n        path: \"/api/auth/login\",\n        expectedStatus: 200,\n        payload: { email: \"admin@test.com\", password: \"AdminPass123!\" },\n      },\n      {\n        method: \"POST\",\n        path: \"/api/auth/register\",\n        expectedStatus: 201,\n        payload: {\n          email: \"newuser@test.com\",\n          password: \"NewPass123!\",\n          firstName: \"New\",\n          lastName: \"User\",\n        },\n      },\n      {\n        method: \"GET\",\n        path: \"/api/auth/me\",\n        expectedStatus: 200,\n        auth: adminToken,\n      },\n      {\n        method: \"GET\",\n        path: \"/api/user/profile\",\n        expectedStatus: 200,\n        auth: adminToken,\n      },\n      {\n        method: \"GET\",\n        path: \"/api/admin/users\",\n        expectedStatus: 200,\n        auth: adminToken,\n      },\n      {\n        method: \"GET\",\n        path: \"/api/admin/stats\",\n        expectedStatus: 200,\n        auth: adminToken,\n      },\n      {\n        method: \"GET\",\n        path: \"/api/admin/logs\",\n        expectedStatus: 200,\n        auth: adminToken,\n      },\n      {\n        method: \"GET\",\n        path: \"/api/admin/users\",\n        expectedStatus: 403,\n        auth: userToken,\n      }, // Regular user should be denied\n    ];\n\n    let passed = 0;\n    let failed = 0;\n\n    for (const route of routesToTest) {\n      try {\n        let response;\n\n        if (route.method === \"GET\") {\n          response = await request(app)\n            .get(route.path)\n            .set(route.auth ? { Authorization: `Bearer ${route.auth}` } : {});\n        } else if (route.method === \"POST\") {\n          response = await request(app).post(route.path).send(route.payload);\n        }\n\n        const status = response.status;\n        const expected = route.expectedStatus;\n\n        if (status === expected) {\n          console.log(\n            `âœ… ${route.method} ${route.path} - Status ${status} (expected ${expected})`,\n          );\n          passed++;\n        } else {\n          console.log(\n            `âŒ ${route.method} ${route.path} - Status ${status} (expected ${expected})`,\n          );\n          failed++;\n        }\n      } catch (_error) {\n        console.log(\n          `âŒ ${route.method} ${route.path} - Error: ${error.message}`,\n        );\n        failed++;\n      }\n    }\n\n    console.log(`\\nðŸ“Š Results: ${passed} passed, ${failed} failed`);\n\n    if (failed === 0) {\n      console.log(\"ðŸŽ‰ All routes are correctly configured and accessible!\");\n    } else {\n      console.log(\n        \"âš ï¸  Some routes need attention. Check the failed tests above.\",\n      );\n    }\n  } catch (_error) {\n    console.error(\"âŒ Verification failed:\", error);\n  } finally {\n    await mongoose.connection.close();\n    server.close();\n  }\n}\n\n// Run verification\nverifyRoutes().catch(console.error);\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\server.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\services\\sciCalculatorService.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'propertyValue' is assigned a value but never used.","line":19,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":19,"endColumn":20},{"ruleId":"no-unused-vars","severity":1,"message":"'ownershipYears' is assigned a value but never used.","line":20,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":20,"endColumn":21},{"ruleId":"no-unused-vars","severity":1,"message":"'shares' is assigned a value but never used.","line":21,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'purchaseDate' is assigned a value but never used.","line":100,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":100,"endColumn":19},{"ruleId":"no-unused-vars","severity":1,"message":"'saleDate' is assigned a value but never used.","line":101,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":101,"endColumn":15},{"ruleId":"no-unused-vars","severity":1,"message":"'shares' is assigned a value but never used.","line":191,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":191,"endColumn":13},{"ruleId":"no-unused-vars","severity":1,"message":"'yearsBetweenDonations' is assigned a value but never used.","line":195,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":195,"endColumn":28}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":7,"fixableErrorCount":0,"fixableWarningCount":0,"source":"class SCICalculatorService {\n  /**\n   * Calculate SCI tax implications based on regime and parameters\n   * @param {Object} params - Calculation parameters\n   * @param {string} params.regime - 'IR' or 'IS'\n   * @param {number} params.rentalIncome - Annual rental income\n   * @param {number} params.expenses - Annual expenses\n   * @param {number} params.propertyValue - Property market value\n   * @param {number} params.ownershipYears - Years of ownership\n   * @param {number} params.shares - Number of shares\n   * @param {Array} params.associates - Array of associate details\n   * @returns {Object} Tax calculation results\n   */\n  static calculateSCITax(params) {\n    const {\n      regime,\n      rentalIncome,\n      expenses,\n      propertyValue,\n      ownershipYears,\n      shares,\n      associates,\n    } = params;\n\n    const netIncome = rentalIncome - expenses;\n    let taxResults = {};\n\n    if (regime === \"IR\") {\n      // ImpÃ´t sur le revenu - BIC\n      const taxableIncome = Math.max(0, netIncome);\n      const microBIC = rentalIncome * 0.5; // 50% abattement micro BIC\n\n      taxResults = {\n        regime: \"IR\",\n        taxableIncome,\n        microBIC,\n        associates: associates.map((assoc) => ({\n          name: assoc.name,\n          share: assoc.share,\n          taxableAmount: (taxableIncome * assoc.share) / 100,\n          marginalRate: assoc.marginalRate,\n          taxAmount:\n            ((taxableIncome * assoc.share) / 100) * (assoc.marginalRate / 100),\n        })),\n        totalTax: associates.reduce(\n          (sum, assoc) =>\n            sum +\n            ((taxableIncome * assoc.share) / 100) * (assoc.marginalRate / 100),\n          0,\n        ),\n      };\n    } else if (regime === \"IS\") {\n      // ImpÃ´t sur les sociÃ©tÃ©s\n      const isRates = [\n        { threshold: 42500, rate: 0.15 },\n        { threshold: Infinity, rate: 0.25 },\n      ];\n\n      let corporateTax = 0;\n      let remainingIncome = Math.max(0, netIncome);\n\n      for (const bracket of isRates) {\n        if (remainingIncome > 0) {\n          const taxableInBracket = Math.min(remainingIncome, bracket.threshold);\n          corporateTax += taxableInBracket * bracket.rate;\n          remainingIncome -= taxableInBracket;\n        }\n      }\n\n      taxResults = {\n        regime: \"IS\",\n        taxableIncome: netIncome,\n        corporateTax,\n        netAfterTax: netIncome - corporateTax,\n        dividendTax: associates.map((assoc) => {\n          const dividend = ((netIncome - corporateTax) * assoc.share) / 100;\n          const flatTax = dividend * 0.3; // PrÃ©lÃ¨vement forfaitaire unique\n          return {\n            name: assoc.name,\n            dividend,\n            flatTax,\n            netDividend: dividend - flatTax,\n          };\n        }),\n      };\n    }\n\n    return taxResults;\n  }\n\n  /**\n   * Calculate capital gains tax for SCI\n   * @param {Object} params - Sale parameters\n   * @returns {Object} Capital gains calculation\n   */\n  static calculateCapitalGains(params) {\n    const {\n      purchasePrice,\n      salePrice,\n      purchaseDate,\n      saleDate,\n      improvementCosts,\n      acquisitionCosts,\n      ownershipYears,\n    } = params;\n\n    const grossGain = salePrice - purchasePrice;\n    const totalCosts = improvementCosts + acquisitionCosts;\n    const netGain = Math.max(0, grossGain - totalCosts);\n\n    // Abattement pour durÃ©e de dÃ©tention\n    let reductionRate = 0;\n    if (ownershipYears >= 6) {\n      reductionRate = Math.min((ownershipYears - 5) * 0.06, 0.36); // 6% per year after 5 years\n    }\n    if (ownershipYears >= 22) {\n      reductionRate = 0.36 + Math.min((ownershipYears - 21) * 0.04, 0.24); // Additional 4% per year\n    }\n\n    const reducedGain = netGain * (1 - reductionRate);\n    const socialTax = reducedGain * 0.172; // 17.2% social contributions\n    const incomeTax = reducedGain * 0.19; // 19% income tax\n\n    return {\n      grossGain,\n      netGain,\n      reductionRate: reductionRate * 100,\n      reducedGain,\n      socialTax,\n      incomeTax,\n      totalTax: socialTax + incomeTax,\n      netAfterTax: salePrice - totalCosts - socialTax - incomeTax,\n    };\n  }\n\n  /**\n   * Calculate financing capacity and leverage\n   * @param {Object} params - Financing parameters\n   * @returns {Object} Financing analysis\n   */\n  static calculateFinancing(params) {\n    const {\n      propertyPrice,\n      personalContribution,\n      rentalYield,\n      loanRate,\n      loanDuration,\n      vacancyRate,\n      managementFees,\n    } = params;\n\n    const loanAmount = propertyPrice - personalContribution;\n    const monthlyRate = loanRate / 12 / 100;\n    const numPayments = loanDuration * 12;\n\n    // Monthly payment calculation\n    const monthlyPayment =\n      (loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, numPayments))) /\n      (Math.pow(1 + monthlyRate, numPayments) - 1);\n\n    const annualRentalIncome = propertyPrice * (rentalYield / 100);\n    const effectiveRentalIncome = annualRentalIncome * (1 - vacancyRate / 100);\n    const netRentalIncome = effectiveRentalIncome * (1 - managementFees / 100);\n\n    const annualPayment = monthlyPayment * 12;\n    const cashFlow = netRentalIncome - annualPayment;\n    const dscr = netRentalIncome / annualPayment;\n\n    return {\n      propertyPrice,\n      loanAmount,\n      personalContribution,\n      monthlyPayment,\n      annualPayment,\n      netRentalIncome,\n      cashFlow,\n      dscr,\n      leverageRatio: (loanAmount / propertyPrice) * 100,\n      roi: ((cashFlow / personalContribution) * 100).toFixed(2),\n    };\n  }\n\n  /**\n   * Calculate succession planning scenarios\n   * @param {Object} params - Succession parameters\n   * @returns {Object} Succession analysis\n   */\n  static calculateSuccession(params) {\n    const {\n      propertyValue,\n      shares,\n      donorAge,\n      doneeRelationship,\n      existingAllowance,\n      yearsBetweenDonations,\n    } = params;\n\n    // Abattement selon le lien de parentÃ©\n    const allowances = {\n      \"parent-child\": 100000,\n      \"grandparent-grandchild\": 31865,\n      siblings: 15932,\n      other: 1597,\n    };\n\n    const allowance = allowances[doneeRelationship] || allowances.other;\n    const remainingAllowance = Math.max(0, allowance - existingAllowance);\n\n    // Taux de taxation progressifs\n    const taxBrackets = [\n      { threshold: 0, rate: 0.05 },\n      { threshold: 8072, rate: 0.1 },\n      { threshold: 12109, rate: 0.15 },\n      { threshold: 15932, rate: 0.2 },\n      { threshold: 552324, rate: 0.3 },\n      { threshold: 902838, rate: 0.4 },\n      { threshold: 1805677, rate: 0.45 },\n    ];\n\n    const taxableValue = Math.max(0, propertyValue - remainingAllowance);\n    let taxAmount = 0;\n    let remainingValue = taxableValue;\n\n    for (const bracket of taxBrackets) {\n      if (remainingValue > 0) {\n        const taxableInBracket =\n          Math.min(\n            remainingValue,\n            taxBrackets[taxBrackets.indexOf(bracket) + 1]?.threshold ||\n              Infinity,\n          ) - bracket.threshold;\n        taxAmount += Math.max(0, taxableInBracket) * bracket.rate;\n        remainingValue -= taxableInBracket;\n      }\n    }\n\n    // RÃ©duction selon l'Ã¢ge du donateur\n    let ageReduction = 0;\n    if (donorAge >= 70 && donorAge < 80) ageReduction = 0.3;\n    else if (donorAge >= 80) ageReduction = 0.5;\n\n    const finalTax = taxAmount * (1 - ageReduction);\n\n    return {\n      propertyValue,\n      allowance: remainingAllowance,\n      taxableValue,\n      grossTax: taxAmount,\n      ageReduction: ageReduction * 100,\n      finalTax,\n      netValue: propertyValue - finalTax,\n      taxRate: (finalTax / propertyValue) * 100,\n    };\n  }\n\n  /**\n   * Calculate optimal SCI structure\n   * @param {Object} params - Structure parameters\n   * @returns {Object} Structure recommendations\n   */\n  static optimizeStructure(params) {\n    const {\n      propertyValue,\n      associates,\n      investmentHorizon,\n      rentalYield,\n      exitStrategy,\n    } = params;\n\n    const scenarios = {\n      ir: {\n        regime: \"IR\",\n        advantages: [\n          \"Transparence fiscale\",\n          \"Imposition au taux marginal des associÃ©s\",\n          \"Pas de double imposition\",\n          \"DÃ©ficits imputables sur revenus globaux\",\n        ],\n        disadvantages: [\n          \"Imposition immÃ©diate des bÃ©nÃ©fices\",\n          \"Pas de report d'imposition\",\n          \"Limitation des charges dÃ©ductibles\",\n        ],\n        estimatedTax: this.calculateSCITax({\n          regime: \"IR\",\n          rentalIncome: (propertyValue * rentalYield) / 100,\n          expenses: propertyValue * 0.2, // 20% charges\n          associates,\n        }).totalTax,\n      },\n      is: {\n        regime: \"IS\",\n        advantages: [\n          \"Taux d'imposition fixes\",\n          \"Report d'imposition possible\",\n          \"DÃ©ductibilitÃ© des intÃ©rÃªts d'emprunt\",\n          \"PossibilitÃ© de rÃ©investir\",\n        ],\n        disadvantages: [\n          \"Double imposition (IS + flat tax)\",\n          \"RÃ©gime fiscal plus complexe\",\n          \"Obligations comptables accrues\",\n        ],\n        estimatedTax: this.calculateSCITax({\n          regime: \"IS\",\n          rentalIncome: (propertyValue * rentalYield) / 100,\n          expenses: propertyValue * 0.2,\n          associates,\n        }).corporateTax,\n      },\n    };\n\n    return {\n      scenarios,\n      recommendation:\n        scenarios.ir.estimatedTax < scenarios.is.estimatedTax ? \"IR\" : \"IS\",\n      factors: {\n        investmentHorizon,\n        exitStrategy,\n        associateProfiles: associates.map((a) => a.marginalRate),\n      },\n    };\n  }\n}\n\nexport default SCICalculatorService;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\src\\app-fixed.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Expected 'multiple' syntax before 'single' syntax.","line":2,"column":1,"nodeType":"ImportDeclaration","messageId":"unexpectedSyntaxOrder","endLine":2,"endColumn":68},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":83,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":83,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2623,2648],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import cors from 'cors';\r\nimport express, { NextFunction, Request, Response } from 'express';\r\nimport helmet from 'helmet';\r\nimport morgan from 'morgan';\r\n\r\n// Import routes\r\nimport adminRoutes from '../routes/admin_new.js';\r\nimport authRoutes from '../routes/auth.js';\r\nimport healthRoutes from '../routes/health.js';\r\nimport kycRoutes from '../routes/kyc.js';\r\nimport leaseRoutes from '../routes/leaseRoutes.js';\r\nimport paymentRoutes from '../routes/paymentRoutes.js';\r\nimport projectsRoutes from '../routes/projects.js';\r\nimport rentRoutes from '../routes/rentRoutes.js';\r\nimport sciExpertiseRoutes from '../routes/sciExpertiseRoutes.js';\r\n\r\n// Import middleware\r\nimport { authenticateJWT } from '../middleware/authMiddleware.js';\r\nimport { requestLogger } from '../middleware/requestLogger.js';\r\n\r\n// Extend Express Request interface to include user property\r\ninterface AuthenticatedRequest extends Request {\r\n  user?: { userId: string };\r\n}\r\n\r\nconst app = express();\r\n\r\n// Security middleware\r\napp.use(helmet());\r\napp.use(cors());\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: true }));\r\n\r\n// Logging\r\napp.use(morgan('combined'));\r\napp.use(requestLogger);\r\n\r\n// Health check (no auth required)\r\napp.use('/api/health', healthRoutes);\r\n\r\n// Public routes\r\napp.use('/api/auth', authRoutes);\r\n\r\n// Protected routes\r\napp.use('/api/admin', authenticateJWT, adminRoutes);\r\napp.use('/api/projects', authenticateJWT, projectsRoutes);\r\napp.use('/api/leases', authenticateJWT, leaseRoutes);\r\napp.use('/api/payments', authenticateJWT, paymentRoutes);\r\napp.use('/api/rents', authenticateJWT, rentRoutes);\r\napp.use('/api/sci-expertise', authenticateJWT, sciExpertiseRoutes);\r\napp.use('/api/kyc', authenticateJWT, kycRoutes);\r\n\r\n// User profile route\r\napp.get(\r\n  '/api/user/profile',\r\n  authenticateJWT,\r\n  async (req: AuthenticatedRequest, res: Response): Promise<Response> => {\r\n    try {\r\n      const User = (await import('../models/User.js')).default;\r\n      const user = await User.findById(req.user?.userId).select('-password');\r\n      if (!user) {\r\n        return res.status(404).json({ message: 'User not found' });\r\n      }\r\n      return res.json({\r\n        id: user._id,\r\n        email: user.email,\r\n        role: user.role,\r\n        profile: user.profile,\r\n      });\r\n    } catch {\r\n      return res.status(500).json({ message: 'Server error' });\r\n    }\r\n  },\r\n);\r\n\r\n// 404 handler\r\napp.use((req: Request, res: Response) => {\r\n  res.status(404).json({ message: 'Route not found' });\r\n});\r\n\r\n// Error handling middleware\r\napp.use((err: Error, req: Request, res: Response, _next: NextFunction) => {\r\n  console.error(err.stack);\r\n  res.status(500).json({ message: 'Something went wrong!' });\r\n});\r\n\r\nexport default app;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\src\\app.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'mongoose' is defined but never used.","line":5,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import express from 'express';\r\nimport cors from 'cors';\r\nimport helmet from 'helmet';\r\nimport morgan from 'morgan';\r\nimport mongoose from 'mongoose';\r\nimport path from 'path';\r\n\r\n// Import routes\r\nimport authRoutes from '../routes/auth.js';\r\nimport projectRoutes from '../routes/projects.js';\r\nimport adminRoutes from '../routes/admin.js';\r\nimport kycRoutes from '../routes/kyc.js';\r\nimport healthRoutes from '../routes/health.js';\r\n\r\n// Import middleware\r\nimport { authenticateJWT, authorizeAdmin } from '../middleware/authMiddleware.js';\r\nimport errorHandler from '../middleware/errorHandler.js';\r\n\r\nconst app = express();\r\n\r\n// Security middleware\r\napp.use(helmet());\r\napp.use(cors());\r\napp.use(morgan('combined'));\r\n\r\n// Body parsing middleware\r\napp.use(express.json());\r\napp.use(express.urlencoded({ extended: true }));\r\n\r\n// Static files\r\napp.use('/uploads', express.static(path.join(__dirname, '../uploads')));\r\n\r\n// Health check route (before auth middleware)\r\napp.use('/api/health', healthRoutes);\r\n\r\n// Public routes\r\napp.use('/api/auth', authRoutes);\r\n\r\n// Protected routes\r\napp.use('/api/projects', authenticateJWT, projectRoutes);\r\napp.use('/api/admin', authenticateJWT, authorizeAdmin, adminRoutes);\r\napp.use('/api/kyc', authenticateJWT, kycRoutes);\r\n\r\n// Error handling middleware\r\napp.use(errorHandler);\r\n\r\n// 404 handler\r\napp.use('*', (req, res) => {\r\n  res.status(404).json({ \r\n    success: false, \r\n    message: 'Route not found' \r\n  });\r\n});\r\n\r\nexport default app;\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\src\\app.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":50},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":12,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":12,"endColumn":25},{"ruleId":"sort-imports","severity":2,"message":"Expected 'multiple' syntax before 'single' syntax.","line":13,"column":1,"nodeType":"ImportDeclaration","messageId":"unexpectedSyntaxOrder","endLine":13,"endColumn":68},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement.","line":83,"column":3,"nodeType":"MemberExpression","messageId":"unexpected","endLine":83,"endColumn":16,"suggestions":[{"messageId":"removeConsole","data":{"propertyName":"error"},"fix":{"range":[2541,2566],"text":""},"desc":"Remove the console.error()."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { authenticateJWT } from '../middleware/authMiddleware.js';\nimport { requestLogger } from '../middleware/requestLogger.js';\nimport adminRoutes from '../routes/admin_new.js';\nimport authRoutes from '../routes/auth.js';\nimport healthRoutes from '../routes/health.js';\nimport kycRoutes from '../routes/kyc.js';\nimport leaseRoutes from '../routes/leaseRoutes.js';\nimport paymentRoutes from '../routes/paymentRoutes.js';\nimport projectsRoutes from '../routes/projects.js';\nimport rentRoutes from '../routes/rentRoutes.js';\nimport sciExpertiseRoutes from '../routes/sciExpertiseRoutes.js';\nimport cors from 'cors';\nimport express, { NextFunction, Request, Response } from 'express';\nimport helmet from 'helmet';\nimport morgan from 'morgan';\n\n// Import routes\n\n// Import middleware\n\n// Extend Express Request interface to include user property\ninterface AuthenticatedRequest extends Request {\n  user?: { userId: string };\n}\n\nconst app = express();\n\n// Security middleware\napp.use(helmet());\napp.use(cors());\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\n\n// Logging\napp.use(morgan('combined'));\napp.use(requestLogger);\n\n// Health check (no auth required)\napp.use('/api/health', healthRoutes);\n\n// Public routes\napp.use('/api/auth', authRoutes);\n\n// Protected routes\napp.use('/api/admin', authenticateJWT, adminRoutes);\napp.use('/api/projects', authenticateJWT, projectsRoutes);\napp.use('/api/leases', authenticateJWT, leaseRoutes);\napp.use('/api/payments', authenticateJWT, paymentRoutes);\napp.use('/api/rents', authenticateJWT, rentRoutes);\napp.use('/api/sci-expertise', authenticateJWT, sciExpertiseRoutes);\napp.use('/api/kyc', authenticateJWT, kycRoutes);\n\n// User profile route\napp.get(\n  '/api/user/profile',\n  authenticateJWT,\n  async (req: AuthenticatedRequest, res: Response): Promise<Response> => {\n    try {\n      const User = (await import('../models/User.js')).default;\n      const user = await User.findById(req.user?.userId).select('-password');\n      if (!user) {\n        return res.status(404).json({ message: 'User not found' });\n      }\n      return res.json({\n        id: user._id,\n        email: user.email,\n        role: user.role,\n        profile: user.profile,\n      });\n    } catch {\n      return res.status(500).json({ message: 'Server error' });\n    }\n  },\n);\n\n// 404 handler\napp.use((req: Request, res: Response) => {\n  res.status(404).json({ message: 'Route not found' });\n});\n\n// Error handling middleware\napp.use((err: Error, req: Request, res: Response, _next: NextFunction) => {\n  console.error(err.stack);\n  res.status(500).json({ message: 'Something went wrong!' });\n});\n\nexport default app;\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\src\\middleware\\authMiddleware-fixed.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":10,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":10,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[241,244],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[241,244],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { NextFunction, Request, Response } from \"express\";\nimport jwt from \"jsonwebtoken\";\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"testsecret\";\n\ninterface JwtPayload {\n  _id: string;\n  email: string;\n  role?: string;\n  [key: string]: any;\n}\n\nexport interface AuthRequest extends Request {\n  user?: JwtPayload;\n}\n\nexport const authenticateJWT = (\n  req: AuthRequest,\n  res: Response,\n  next: NextFunction,\n): void => {\n  const authHeader = req.headers.authorization;\n\n  if (!authHeader || !authHeader.startsWith(\"Bearer \")) {\n    res.status(401).json({ message: \"No token provided\" });\n    return;\n  }\n\n  const token = authHeader.split(\" \")[1];\n\n  if (!token) {\n    res.status(401).json({ message: \"No token provided\" });\n    return;\n  }\n\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET) as JwtPayload;\n    req.user = decoded;\n    next();\n  } catch {\n    res.status(401).json({ message: \"Invalid token\" });\n  }\n};\n\nexport const authorizeAdmin = (\n  req: AuthRequest,\n  res: Response,\n  next: NextFunction,\n): void => {\n  if (req.user && req.user.role === \"admin\") {\n    next();\n  } else {\n    res.status(403).json({ message: \"Access denied. Admin role required.\" });\n  }\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\src\\middleware\\authMiddleware.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\src\\middleware\\authMiddleware.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\src\\routes\\projects-minimal.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\src\\utils\\type-safety.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\test_config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\test_factory.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\test_factory.mjs","messages":[{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":12,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":12,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":20,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":20,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":35,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":35,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":43,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":43,"endColumn":8},{"ruleId":"no-undef","severity":2,"message":"'console' is not defined.","line":50,"column":1,"nodeType":"Identifier","messageId":"undef","endLine":50,"endColumn":8}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Types } from \"mongoose\";\nimport {\n  createProjectData,\n  createMinimalProject,\n  createFundedProject,\n} from \"./factories/project.factory-new.js\";\n\n// Simple validation test\nconst tenantId = new Types.ObjectId();\nconst userId = new Types.ObjectId();\n\nconsole.log(\"Testing Project Factory...\");\n\n// Test createProjectData\nconst projectData = createProjectData({\n  tenant: tenantId,\n  createdBy: userId,\n});\n\nconsole.log(\"âœ… createProjectData works:\", {\n  name: projectData.name,\n  description: projectData.description.substring(0, 50) + \"...\",\n  type: projectData.type,\n  financials: {\n    totalInvestment: projectData.financials.totalInvestment,\n    targetAmount: projectData.financials.targetAmount,\n    currentAmount: projectData.financials.currentAmount,\n  },\n  tenant: projectData.tenant.toString(),\n  createdBy: projectData.createdBy.toString(),\n});\n\n// Test createMinimalProject\nconst minimalProject = createMinimalProject(tenantId, userId);\nconsole.log(\"âœ… createMinimalProject works:\", {\n  name: minimalProject.name,\n  type: minimalProject.type,\n  status: minimalProject.status,\n});\n\n// Test createFundedProject\nconst fundedProject = createFundedProject(tenantId, userId);\nconsole.log(\"âœ… createFundedProject works:\", {\n  name: fundedProject.name,\n  status: fundedProject.status,\n  currentAmount: fundedProject.financials.currentAmount,\n  targetAmount: fundedProject.financials.targetAmount,\n});\n\nconsole.log(\"ðŸŽ‰ All factory functions work correctly!\");\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\admin_critical.test.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":31},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'mongoose' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":16},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":5,"endColumn":33},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":6,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":6,"endColumn":38},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":7,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":7,"endColumn":44},{"ruleId":"sort-imports","severity":2,"message":"Expected 'multiple' syntax before 'single' syntax.","line":8,"column":1,"nodeType":"ImportDeclaration","messageId":"unexpectedSyntaxOrder","endLine":8,"endColumn":96},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":34,"column":5,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":34,"endColumn":39},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":34,"column":34,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":34,"endColumn":39},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":54,"column":5,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":54,"endColumn":37},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":54,"column":32,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":54,"endColumn":37},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .logs on an `any` value.","line":149,"column":37,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":149,"endColumn":41}],"suppressedMessages":[],"errorCount":11,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { afterAll, beforeAll, beforeEach, describe, expect, it } from \"vitest\";\nimport request from \"supertest\";\nimport bcrypt from \"bcryptjs\";\nimport mongoose from \"mongoose\";\nimport app from \"../src/app.js\";\nimport User from \"../models/User.js\";\nimport Project from \"../models/Project.js\";\nimport { clearTestDB, seedAdminUser, setupTestDB, teardownTestDB } from \"./setup/env-setup.js\";\n\ndescribe(\"Admin Critical Endpoints\", () => {\n  let adminToken: string;\n  let userToken: string;\n\n  beforeAll(async () => {\n    await setupTestDB();\n    await seedAdminUser();\n  });\n\n  afterAll(async () => {\n    await teardownTestDB();\n  });\n\n  beforeEach(async () => {\n    await clearTestDB();\n\n    // Seed admin user again after clearing DB\n    await seedAdminUser();\n\n    const adminLogin = await request(app)\n      .post(\"/api/auth/login\")\n      .send({ email: \"admin@test.com\", password: \"AdminPass123!\" });\n\n    console.log(\"Admin login response:\", adminLogin.status, adminLogin.body);\n    adminToken = adminLogin.body.token;\n\n    const userPassword = await bcrypt.hash(\"UserPass123!\", 10);\n    const user = new User({\n      email: \"user@test.com\",\n      password: userPassword,\n      role: \"investor\",\n      username: \"user\",\n      profile: {\n        firstName: \"Regular\",\n        lastName: \"User\",\n      },\n    });\n    await user.save();\n\n    const userLogin = await request(app)\n      .post(\"/api/auth/login\")\n      .send({ email: \"user@test.com\", password: \"UserPass123!\" });\n\n    console.log(\"User login response:\", userLogin.status, userLogin.body);\n    userToken = userLogin.body.token;\n  });\n\n  describe(\"GET /api/admin/stats\", () => {\n    it(\"should return comprehensive admin stats\", async () => {\n      const project = new Project({\n        name: \"Test Project 1\",\n        status: \"active\",\n        description: \"Test project 1\",\n        type: \"residential\",\n        createdBy: \"507f1f77bcf86cd799439011\",\n        tenant: \"507f1f77bcf86cd799439012\",\n        timeline: {\n          startDate: new Date(\"2024-01-01\"),\n          endDate: new Date(\"2024-12-31\"),\n        },\n        financials: {\n          totalInvestment: 100000,\n          targetAmount: 500000,\n          expectedReturn: 15,\n          duration: 12,\n          entryTicket: 1000,\n        },\n      });\n      await project.save();\n\n      const res = await request(app)\n        .get(\"/api/admin/stats\")\n        .set(\"Authorization\", `Bearer ${adminToken}`);\n\n      console.log(\"Admin stats response:\", res.status, res.body);\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"users\");\n      expect(res.body).toHaveProperty(\"projects\");\n      expect(res.body).toHaveProperty(\"kyc\");\n    });\n\n    it(\"should reject non-admin users\", async () => {\n      const res = await request(app)\n        .get(\"/api/admin/stats\")\n        .set(\"Authorization\", `Bearer ${userToken}`);\n\n      console.log(\"Non-admin access response:\", res.status, res.body);\n      expect(res.status).toBe(403);\n    });\n\n    it(\"should reject unauthenticated requests\", async () => {\n      const res = await request(app).get(\"/api/admin/stats\");\n\n      console.log(\"Unauthenticated access response:\", res.status, res.body);\n      expect(res.status).toBe(401);\n    });\n  });\n\n  describe(\"GET /api/admin/users\", () => {\n    it(\"should return user list for admin\", async () => {\n      const user2 = new User({\n        email: \"user2@test.com\",\n        password: await bcrypt.hash(\"UserPass123!\", 10),\n        role: \"investor\",\n        username: \"user2\",\n        profile: {\n          firstName: \"Test\",\n          lastName: \"User2\",\n        },\n      });\n      await user2.save();\n\n      const res = await request(app)\n        .get(\"/api/admin/users\")\n        .set(\"Authorization\", `Bearer ${adminToken}`);\n\n      console.log(\"Admin users response:\", res.status, res.body);\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"length\");\n    });\n\n    it(\"should reject non-admin users\", async () => {\n      const res = await request(app)\n        .get(\"/api/admin/users\")\n        .set(\"Authorization\", `Bearer ${userToken}`);\n\n      console.log(\"Non-admin users response:\", res.status, res.body);\n      expect(res.status).toBe(403);\n    });\n  });\n\n  describe(\"GET /api/admin/logs\", () => {\n    it(\"should return system logs for admin\", async () => {\n      const res = await request(app)\n        .get(\"/api/admin/logs\")\n        .set(\"Authorization\", `Bearer ${adminToken}`);\n\n      console.log(\"Admin logs response:\", res.status, res.body);\n      expect(res.status).toBe(200);\n      expect(Array.isArray(res.body.logs)).toBe(true);\n    });\n\n    it(\"should reject non-admin users\", async () => {\n      const res = await request(app)\n        .get(\"/api/admin/logs\")\n        .set(\"Authorization\", `Bearer ${userToken}`);\n\n      console.log(\"Non-admin logs response:\", res.status, res.body);\n      expect(res.status).toBe(403);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\admin_integration.test.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":43},{"ruleId":"sort-imports","severity":2,"message":"Expected 'multiple' syntax before 'single' syntax.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"unexpectedSyntaxOrder","endLine":5,"endColumn":80},{"ruleId":"@typescript-eslint/await-thenable","severity":2,"message":"Unexpected `await` of a non-Promise (non-\"Thenable\") value.","line":25,"column":17,"nodeType":"AwaitExpression","messageId":"await","endLine":25,"endColumn":40,"suggestions":[{"messageId":"removeAwait","fix":{"range":[580,585],"text":""},"desc":"Remove unnecessary `await`."}]},{"ruleId":"@typescript-eslint/await-thenable","severity":2,"message":"Unexpected `await` of a non-Promise (non-\"Thenable\") value.","line":26,"column":19,"nodeType":"AwaitExpression","messageId":"await","endLine":26,"endColumn":41,"suggestions":[{"messageId":"removeAwait","fix":{"range":[623,628],"text":""},"desc":"Remove unnecessary `await`."}]},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":63,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":63,"endColumn":32},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":64,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":64,"endColumn":32},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":65,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":65,"endColumn":32},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":91,"column":42,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":91,"endColumn":46},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":103,"column":42,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":103,"endColumn":46}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { beforeAll, describe, expect, it } from \"vitest\";\nimport request from \"supertest\";\nimport type { Response } from \"supertest\";\nimport app from \"../src/app.js\";\nimport { createTestAdmin, createTestUser } from \"../factories/user.factory.js\";\n\ninterface TestUser {\n  email: string;\n}\n\ninterface AuthResponseBody {\n  data?: {\n    token?: string;\n  };\n}\n\ndescribe(\"Admin API Integration Tests\", () => {\n  let adminToken: string;\n  let userToken: string;\n  let adminUser: TestUser;\n  let regularUser: TestUser;\n\n  beforeAll(async () => {\n    // Create test users\n    adminUser = await createTestAdmin();\n    regularUser = await createTestUser();\n\n    // Get admin token\n    const adminResponse: Response = await request(app)\n      .post(\"/api/auth/login\")\n      .send({ email: adminUser.email, password: \"Test123456\" });\n\n    const adminBody = adminResponse.body as AuthResponseBody;\n    if (!adminBody.data?.token) {\n      throw new Error(\n        `Admin login failed: ${JSON.stringify(adminResponse.body)}`,\n      );\n    }\n    adminToken = adminBody.data.token;\n\n    // Get user token\n    const userResponse: Response = await request(app)\n      .post(\"/api/auth/login\")\n      .send({ email: regularUser.email, password: \"Test123456\" });\n\n    const userBody = userResponse.body as AuthResponseBody;\n    if (!userBody.data?.token) {\n      throw new Error(\n        `User login failed: ${JSON.stringify(userResponse.body)}`,\n      );\n    }\n    userToken = userBody.data.token;\n  });\n\n  describe(\"GET /api/admin/stats\", () => {\n    it(\"should return admin stats for authorized admin\", async () => {\n      const response: Response = await request(app)\n        .get(\"/api/admin/stats\")\n        .set(\"Authorization\", `Bearer ${adminToken}`);\n\n      expect(response.status).toBe(200);\n      expect(response.body).toHaveProperty(\"data\");\n      expect(response.body.data).toHaveProperty(\"totalUsers\");\n      expect(response.body.data).toHaveProperty(\"totalProjects\");\n      expect(response.body.data).toHaveProperty(\"totalDonations\");\n    });\n\n    it(\"should return 403 for non-admin users\", async () => {\n      const response: Response = await request(app)\n        .get(\"/api/admin/stats\")\n        .set(\"Authorization\", `Bearer ${userToken}`);\n\n      expect(response.status).toBe(403);\n    });\n\n    it(\"should return 401 for unauthenticated requests\", async () => {\n      const response: Response = await request(app).get(\"/api/admin/stats\");\n\n      expect(response.status).toBe(401);\n    });\n  });\n\n  describe(\"GET /api/admin/logs\", () => {\n    it(\"should return system logs for admin\", async () => {\n      const response: Response = await request(app)\n        .get(\"/api/admin/logs\")\n        .set(\"Authorization\", `Bearer ${adminToken}`);\n\n      expect(response.status).toBe(200);\n      expect(response.body).toHaveProperty(\"data\");\n      expect(Array.isArray(response.body.data)).toBe(true);\n    });\n  });\n\n  describe(\"GET /api/admin/users\", () => {\n    it(\"should return all users for admin\", async () => {\n      const response: Response = await request(app)\n        .get(\"/api/admin/users\")\n        .set(\"Authorization\", `Bearer ${adminToken}`);\n\n      expect(response.status).toBe(200);\n      expect(response.body).toHaveProperty(\"data\");\n      expect(Array.isArray(response.body.data)).toBe(true);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\admin_test.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":32},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":4,"endColumn":38},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":5,"endColumn":44},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":40,"column":5,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":40,"endColumn":37},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":40,"column":32,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":40,"endColumn":37},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":45,"column":5,"nodeType":"AssignmentExpression","messageId":"anyAssignment","endLine":45,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":45,"column":30,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":45,"endColumn":35}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { afterEach, beforeEach, describe, expect, it } from \"vitest\";\nimport request from \"supertest\";\nimport app from \"../server.js\";\nimport User from \"../models/User.js\";\nimport Project from \"../models/Project.js\";\n\ndescribe(\"Admin Routes\", () => {\n  let adminToken: string;\n  let userToken: string;\n\n  beforeEach(async () => {\n    // Create test admin\n    const admin = new User({\n      email: \"admin@test.com\",\n      password: \"admin123\",\n      role: \"admin\",\n      profile: {\n        firstName: \"Admin\",\n        lastName: \"User\",\n      },\n    });\n    await admin.save();\n\n    // Create test user\n    const user = new User({\n      email: \"user@test.com\",\n      password: \"user123\",\n      role: \"investor\",\n      profile: {\n        firstName: \"Test\",\n        lastName: \"User\",\n      },\n    });\n    await user.save();\n\n    // Get tokens\n    const adminRes = await request(app)\n      .post(\"/api/auth/login\")\n      .send({ email: \"admin@test.com\", password: \"admin123\" });\n    adminToken = adminRes.body.token;\n\n    const userRes = await request(app)\n      .post(\"/api/auth/login\")\n      .send({ email: \"user@test.com\", password: \"user123\" });\n    userToken = userRes.body.token;\n  });\n\n  afterEach(async () => {\n    await User.deleteMany({});\n    await Project.deleteMany({});\n  });\n\n  describe(\"GET /api/admin/stats\", () => {\n    it(\"should return admin stats for admin users\", async () => {\n      const res = await request(app)\n        .get(\"/api/admin/stats\")\n        .set(\"Authorization\", `Bearer ${adminToken}`);\n\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"totalUsers\");\n      expect(res.body).toHaveProperty(\"totalProjects\");\n      expect(res.body).toHaveProperty(\"totalDonations\");\n    });\n\n    it(\"should return 403 for non-admin users\", async () => {\n      const res = await request(app)\n        .get(\"/api/admin/stats\")\n        .set(\"Authorization\", `Bearer ${userToken}`);\n\n      expect(res.status).toBe(403);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\auth.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\auth_test.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'mongoose' is defined but never used.","line":3,"column":8,"nodeType":"Identifier","messageId":"unusedVar","endLine":3,"endColumn":16},{"ruleId":"no-unused-vars","severity":1,"message":"'testUser' is assigned a value but never used.","line":11,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":11,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, it, expect, beforeAll, afterAll, beforeEach } from \"vitest\";\nimport request from \"supertest\";\nimport mongoose from \"mongoose\";\nimport jwt from \"jsonwebtoken\";\nimport bcrypt from \"bcryptjs\";\nimport app from \"../server.js\";\nimport User from \"../models/User.js\";\n\ndescribe(\"Authentication Endpoints\", () => {\n  let authToken;\n  let testUser;\n\n  beforeAll(async () => {\n    // Connection is handled by vitest setup file\n    // Skip explicit connection setup\n  });\n\n  afterAll(async () => {\n    // Disconnection is handled by vitest setup file\n    // Skip explicit disconnection\n  });\n\n  beforeEach(async () => {\n    // Clean up database before each test\n    await User.deleteMany({});\n    authToken = null;\n    testUser = null;\n  });\n\n  describe(\"POST /api/auth/register\", () => {\n    it(\"should register a new user successfully\", async () => {\n      const userData = {\n        email: \"test@example.com\",\n        password: \"Test123456!\",\n        firstName: \"John\",\n        lastName: \"Doe\",\n        role: \"investor\",\n      };\n\n      const response = await request(app)\n        .post(\"/api/auth/register\")\n        .send(userData)\n        .expect(201);\n\n      expect(response.body).toHaveProperty(\"token\");\n      expect(response.body.user).toHaveProperty(\"email\", userData.email);\n      expect(response.body.user).toHaveProperty(\"role\", userData.role);\n      expect(response.body.user).not.toHaveProperty(\"password\");\n    });\n\n    it(\"should not register user with invalid email\", async () => {\n      const userData = {\n        email: \"invalid-email\",\n        password: \"Test123456!\",\n        firstName: \"John\",\n        lastName: \"Doe\",\n      };\n\n      const response = await request(app)\n        .post(\"/api/auth/register\")\n        .send(userData)\n        .expect(400);\n\n      expect(response.body).toHaveProperty(\"errors\");\n    });\n\n    it(\"should not register user with duplicate email\", async () => {\n      const userData = {\n        email: \"duplicate@example.com\",\n        password: \"Test123456!\",\n        firstName: \"John\",\n        lastName: \"Doe\",\n      };\n\n      // Create first user\n      await request(app).post(\"/api/auth/register\").send(userData).expect(201);\n\n      // Try to create duplicate\n      const response = await request(app)\n        .post(\"/api/auth/register\")\n        .send(userData)\n        .expect(400);\n\n      expect(response.body).toHaveProperty(\"message\");\n      expect(response.body.message).toContain(\"already exists\");\n    });\n\n    it(\"should not register user with weak password\", async () => {\n      const userData = {\n        email: \"weakpass@example.com\",\n        password: \"123\",\n        firstName: \"John\",\n        lastName: \"Doe\",\n      };\n\n      const response = await request(app)\n        .post(\"/api/auth/register\")\n        .send(userData)\n        .expect(400);\n\n      expect(response.body).toHaveProperty(\"errors\");\n    });\n  });\n\n  describe(\"POST /api/auth/login\", () => {\n    beforeEach(async () => {\n      // Create a test user for login tests\n      const hashedPassword = await bcrypt.hash(\"Test123456!\", 10);\n      testUser = await User.create({\n        email: \"login@example.com\",\n        password: hashedPassword,\n        firstName: \"Test\",\n        lastName: \"User\",\n        role: \"investor\",\n      });\n    });\n\n    it(\"should login with valid credentials\", async () => {\n      const response = await request(app)\n        .post(\"/api/auth/login\")\n        .send({\n          email: \"login@example.com\",\n          password: \"Test123456!\",\n        })\n        .expect(200);\n\n      expect(response.body).toHaveProperty(\"token\");\n      expect(response.body.user).toHaveProperty(\"email\", \"login@example.com\");\n      expect(response.body.user).toHaveProperty(\"role\", \"investor\");\n      expect(response.body.user).not.toHaveProperty(\"password\");\n\n      authToken = response.body.token;\n    });\n\n    it(\"should not login with invalid credentials\", async () => {\n      const response = await request(app)\n        .post(\"/api/auth/login\")\n        .send({\n          email: \"login@example.com\",\n          password: \"wrongpassword\",\n        })\n        .expect(401);\n\n      expect(response.body).toHaveProperty(\"message\", \"Invalid credentials\");\n    });\n\n    it(\"should not login with non-existent user\", async () => {\n      const response = await request(app)\n        .post(\"/api/auth/login\")\n        .send({\n          email: \"nonexistent@example.com\",\n          password: \"Test123456!\",\n        })\n        .expect(401);\n\n      expect(response.body).toHaveProperty(\"message\", \"Invalid credentials\");\n    });\n\n    it(\"should not login with missing fields\", async () => {\n      const response = await request(app)\n        .post(\"/api/auth/login\")\n        .send({\n          email: \"login@example.com\",\n          // Missing password\n        })\n        .expect(400);\n\n      expect(response.body).toHaveProperty(\"errors\");\n    });\n  });\n\n  describe(\"GET /api/auth/me\", () => {\n    beforeEach(async () => {\n      // Create and login a test user\n      const hashedPassword = await bcrypt.hash(\"Test123456!\", 10);\n      testUser = await User.create({\n        email: \"me@example.com\",\n        password: hashedPassword,\n        firstName: \"Me\",\n        lastName: \"Test\",\n        role: \"investor\",\n      });\n\n      const response = await request(app).post(\"/api/auth/login\").send({\n        email: \"me@example.com\",\n        password: \"Test123456!\",\n      });\n\n      authToken = response.body.token;\n    });\n\n    it(\"should get current user profile with valid token\", async () => {\n      const response = await request(app)\n        .get(\"/api/auth/me\")\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .expect(200);\n\n      expect(response.body).toHaveProperty(\"email\", \"me@example.com\");\n      expect(response.body).toHaveProperty(\"role\", \"investor\");\n      expect(response.body).not.toHaveProperty(\"password\");\n    });\n\n    it(\"should not get profile without token\", async () => {\n      const response = await request(app).get(\"/api/auth/me\").expect(401);\n\n      expect(response.body).toHaveProperty(\"message\", \"No token provided\");\n    });\n\n    it(\"should not get profile with invalid token\", async () => {\n      const response = await request(app)\n        .get(\"/api/auth/me\")\n        .set(\"Authorization\", \"Bearer invalidtoken\")\n        .expect(401);\n\n      expect(response.body).toHaveProperty(\"message\", \"Invalid token\");\n    });\n  });\n\n  describe(\"PUT /api/auth/profile\", () => {\n    beforeEach(async () => {\n      // Create and login a test user\n      const hashedPassword = await bcrypt.hash(\"Test123456!\", 10);\n      testUser = await User.create({\n        email: \"profile@example.com\",\n        password: hashedPassword,\n        firstName: \"Profile\",\n        lastName: \"Test\",\n        role: \"investor\",\n      });\n\n      const response = await request(app).post(\"/api/auth/login\").send({\n        email: \"profile@example.com\",\n        password: \"Test123456!\",\n      });\n\n      authToken = response.body.token;\n    });\n\n    it(\"should update user profile with valid token\", async () => {\n      const updateData = {\n        firstName: \"Updated\",\n        lastName: \"Name\",\n        phone: \"+1234567890\",\n      };\n\n      const response = await request(app)\n        .put(\"/api/auth/profile\")\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .send(updateData)\n        .expect(200);\n\n      expect(response.body).toHaveProperty(\"firstName\", \"Updated\");\n      expect(response.body).toHaveProperty(\"lastName\", \"Name\");\n      expect(response.body).toHaveProperty(\"phone\", \"+1234567890\");\n    });\n\n    it(\"should not update profile without token\", async () => {\n      const response = await request(app)\n        .put(\"/api/auth/profile\")\n        .send({ firstName: \"Updated\" })\n        .expect(401);\n\n      expect(response.body).toHaveProperty(\"message\", \"No token provided\");\n    });\n\n    it(\"should not update email through profile update\", async () => {\n      const response = await request(app)\n        .put(\"/api/auth/profile\")\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .send({ email: \"newemail@example.com\" })\n        .expect(200);\n\n      // Email should remain unchanged\n      expect(response.body).toHaveProperty(\"email\", \"profile@example.com\");\n    });\n  });\n\n  describe(\"POST /api/auth/logout\", () => {\n    beforeEach(async () => {\n      // Create and login a test user\n      const hashedPassword = await bcrypt.hash(\"Test123456!\", 10);\n      testUser = await User.create({\n        email: \"logout@example.com\",\n        password: hashedPassword,\n        firstName: \"Logout\",\n        lastName: \"Test\",\n        role: \"investor\",\n      });\n\n      const response = await request(app).post(\"/api/auth/login\").send({\n        email: \"logout@example.com\",\n        password: \"Test123456!\",\n      });\n\n      authToken = response.body.token;\n    });\n\n    it(\"should logout user with valid token\", async () => {\n      const response = await request(app)\n        .post(\"/api/auth/logout\")\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .expect(200);\n\n      expect(response.body).toHaveProperty(\n        \"message\",\n        \"Logged out successfully\",\n      );\n    });\n\n    it(\"should handle logout without token\", async () => {\n      const response = await request(app).post(\"/api/auth/logout\").expect(401);\n\n      expect(response.body).toHaveProperty(\"message\", \"No token provided\");\n    });\n  });\n\n  describe(\"Protected Routes\", () => {\n    beforeEach(async () => {\n      // Create users with different roles\n      const hashedPassword = await bcrypt.hash(\"Test123456!\", 10);\n\n      // Regular user\n      await User.create({\n        email: \"user@example.com\",\n        password: hashedPassword,\n        firstName: \"Regular\",\n        lastName: \"User\",\n        role: \"investor\",\n      });\n\n      // Admin user\n      await User.create({\n        email: \"admin@example.com\",\n        password: hashedPassword,\n        firstName: \"Admin\",\n        lastName: \"User\",\n        role: \"admin\",\n      });\n    });\n\n    it(\"should allow access to user routes with valid user token\", async () => {\n      const loginResponse = await request(app).post(\"/api/auth/login\").send({\n        email: \"user@example.com\",\n        password: \"Test123456!\",\n      });\n\n      const userToken = loginResponse.body.token;\n\n      // Test accessing a protected user route\n      const response = await request(app)\n        .get(\"/api/auth/me\")\n        .set(\"Authorization\", `Bearer ${userToken}`)\n        .expect(200);\n\n      expect(response.body).toHaveProperty(\"role\", \"investor\");\n    });\n\n    it(\"should allow access to admin routes with admin token\", async () => {\n      const loginResponse = await request(app).post(\"/api/auth/login\").send({\n        email: \"admin@example.com\",\n        password: \"Test123456!\",\n      });\n\n      const adminToken = loginResponse.body.token;\n\n      // Test accessing an admin route (assuming /api/admin/users exists)\n      const response = await request(app)\n        .get(\"/api/admin/users\")\n        .set(\"Authorization\", `Bearer ${adminToken}`)\n        .expect(200);\n\n      expect(Array.isArray(response.body)).toBe(true);\n    });\n\n    it(\"should deny access to admin routes with regular user token\", async () => {\n      const loginResponse = await request(app).post(\"/api/auth/login\").send({\n        email: \"user@example.com\",\n        password: \"Test123456!\",\n      });\n\n      const userToken = loginResponse.body.token;\n\n      // Try to access admin route with user token\n      const response = await request(app)\n        .get(\"/api/admin/users\")\n        .set(\"Authorization\", `Bearer ${userToken}`)\n        .expect(403);\n\n      expect(response.body).toHaveProperty(\"message\", \"Access denied\");\n    });\n\n    it(\"should deny access to protected routes with expired token\", async () => {\n      // Create an expired token\n      const expiredToken = jwt.sign(\n        { userId: \"testuser\" },\n        process.env.JWT_SECRET || \"test-secret\",\n        { expiresIn: \"-1h\" },\n      );\n\n      const response = await request(app)\n        .get(\"/api/auth/me\")\n        .set(\"Authorization\", `Bearer ${expiredToken}`)\n        .expect(401);\n\n      expect(response.body).toHaveProperty(\"message\", \"Invalid token\");\n    });\n\n    it(\"should deny access with malformed token\", async () => {\n      const response = await request(app)\n        .get(\"/api/auth/me\")\n        .set(\"Authorization\", \"Bearer malformed.token.here\")\n        .expect(401);\n\n      expect(response.body).toHaveProperty(\"message\", \"Invalid token\");\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\config\\test-config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\examples\\mongoose-complete-example.test.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":2,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":2,"endColumn":59},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":6,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":6,"endColumn":50},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'testUser._id' will use Object's default stringification format ('[object Object]') when stringified.","line":40,"column":12,"nodeType":"MemberExpression","messageId":"baseToString","endLine":40,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'getTestUserIdSafe' is defined but never used. Allowed unused vars must match /^_/u.","line":44,"column":12,"nodeType":null,"messageId":"unusedVar","endLine":44,"endColumn":29},{"ruleId":"@typescript-eslint/no-base-to-string","severity":2,"message":"'testUser._id' will use Object's default stringification format ('[object Object]') when stringified.","line":48,"column":12,"nodeType":"MemberExpression","messageId":"baseToString","endLine":48,"endColumn":24},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'project' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":294,"column":13,"nodeType":null,"messageId":"unusedVar","endLine":294,"endColumn":20}],"suppressedMessages":[],"errorCount":6,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose, { Types } from \"mongoose\";\nimport { beforeEach, describe, expect, it } from \"vitest\";\n\nimport Project from \"../../models/Project\";\nimport User from \"../../models/User\";\nimport type { IUser } from \"../../models/User.d\";\n\ndescribe(\"Mongoose Complete Example\", () => {\n  let testUser: IUser;\n\n  beforeEach(async () => {\n    testUser = await User.create({\n      email: \"test@example.com\",\n      password: \"hashedpassword123\",\n      profile: {\n        firstName: \"Test\",\n        lastName: \"User\",\n        kycStatus: \"pending\",\n        kycDocuments: [],\n      },\n      role: \"investor\",\n      investments: [],\n      preferences: {\n        riskTolerance: \"medium\",\n        investmentHorizon: \"medium\",\n        notifications: {\n          email: true,\n          sms: false,\n          push: true,\n        },\n      },\n    });\n  });\n\n  // Helper function to safely get testUser._id as string\n  function getTestUserId(): string {\n    if (!testUser || !testUser._id) {\n      throw new Error(\"testUser or testUser._id is undefined\");\n    }\n    return testUser._id.toString();\n  }\n\n  // Explicitly handle ObjectId stringification to prevent ESLint warnings\n  function getTestUserIdSafe(): string {\n    if (!testUser || !testUser._id) {\n      throw new Error(\"testUser or testUser._id is undefined\");\n    }\n    return testUser._id.toString();\n  }\n\n  describe(\"User Model Tests\", () => {\n    it(\"should create a user with required fields\", async () => {\n      const user = await User.create({\n        email: \"newuser@test.com\",\n        password: \"securepassword123\",\n        profile: {\n          firstName: \"John\",\n          lastName: \"Doe\",\n          kycStatus: \"pending\",\n          kycDocuments: [],\n        },\n        role: \"investor\",\n        investments: [],\n        preferences: {\n          riskTolerance: \"medium\",\n          investmentHorizon: \"medium\",\n          notifications: {\n            email: true,\n            sms: false,\n            push: true,\n          },\n        },\n      });\n\n      expect(user._id).toBeDefined();\n      expect(user.email).toBe(\"newuser@test.com\");\n      expect(user.profile.firstName).toBe(\"John\");\n      expect(user.createdAt).toBeDefined();\n    });\n\n    it(\"should enforce email uniqueness\", async () => {\n      await expect(\n        User.create({\n          email: \"test@example.com\",\n          password: \"anotherpassword\",\n          profile: {\n            firstName: \"Another\",\n            lastName: \"User\",\n            kycStatus: \"pending\",\n            kycDocuments: [],\n          },\n          role: \"investor\",\n          investments: [],\n          preferences: {\n            riskTolerance: \"medium\",\n            investmentHorizon: \"medium\",\n            notifications: {\n              email: true,\n              sms: false,\n              push: true,\n            },\n          },\n        }),\n      ).rejects.toThrow();\n    });\n\n    it(\"should find user by email\", async () => {\n      const foundUser = await User.findOne({ email: \"test@example.com\" });\n      expect(foundUser).toBeDefined();\n      expect(foundUser?.profile.firstName).toBe(\"Test\");\n    });\n  });\n\n  describe(\"Project Model Tests\", () => {\n    it(\"should create a project with owner reference\", async () => {\n      const project = await Project.create({\n        name: \"Test Project\",\n        description: \"A test project description\",\n        type: \"residential\",\n        location: {\n          address: \"123 Test St\",\n          city: \"Test City\",\n          postalCode: \"12345\",\n        },\n        financials: {\n          totalInvestment: 50000,\n          targetAmount: 100000,\n          currentAmount: 0,\n          expectedReturn: 8.5,\n          duration: 12,\n          entryTicket: 1000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n        status: \"active\",\n        tenant: new Types.ObjectId(),\n        createdBy: getTestUserId(),\n        investors: [],\n      });\n\n      expect(project._id).toBeDefined();\n      expect(project.name).toBe(\"Test Project\");\n      expect(project.createdBy.toString()).toBe(getTestUserId());\n    });\n\n    it(\"should populate owner when querying projects\", async () => {\n      const project = await Project.create({\n        name: \"Populated Project\",\n        description: \"Testing population\",\n        type: \"commercial\",\n        location: {\n          address: \"456 Populated St\",\n          city: \"Populated City\",\n          postalCode: \"67890\",\n        },\n        financials: {\n          totalInvestment: 25000,\n          targetAmount: 50000,\n          currentAmount: 0,\n          expectedReturn: 7.5,\n          duration: 6,\n          entryTicket: 500,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n        status: \"planning\",\n        tenant: new Types.ObjectId(),\n        createdBy: getTestUserId(),\n        investors: [],\n      });\n\n      const populatedProject = await Project.findById(project._id).populate(\n        \"createdBy\",\n      );\n\n      expect(populatedProject).toBeDefined();\n      expect(populatedProject?.createdBy).toBeDefined();\n\n      const populatedUser = populatedProject?.createdBy as unknown as IUser;\n      expect(populatedUser.email).toBe(\"test@example.com\");\n    });\n\n    it(\"should update project status\", async () => {\n      const project = await Project.create({\n        name: \"Update Test Project\",\n        description: \"Testing updates\",\n        type: \"residential\",\n        location: {\n          address: \"789 Update St\",\n          city: \"Update City\",\n          postalCode: \"11111\",\n        },\n        financials: {\n          totalInvestment: 10000,\n          targetAmount: 20000,\n          currentAmount: 0,\n          expectedReturn: 6.5,\n          duration: 3,\n          entryTicket: 100,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n        status: \"active\",\n        tenant: new Types.ObjectId(),\n        createdBy: getTestUserId(),\n        investors: [],\n      });\n\n      project.status = \"completed\";\n      await project.save();\n\n      const updatedProject = await Project.findById(project._id);\n      expect(updatedProject?.status).toBe(\"completed\");\n    });\n  });\n\n  describe(\"Complex Queries and Relationships\", () => {\n    it(\"should find all projects for a user\", async () => {\n      await Project.create([\n        {\n          name: \"Project 1\",\n          description: \"First project\",\n          type: \"residential\",\n          location: {\n            address: \"111 First St\",\n            city: \"First City\",\n            postalCode: \"22222\",\n          },\n          financials: {\n            totalInvestment: 10000,\n            targetAmount: 20000,\n            currentAmount: 0,\n            expectedReturn: 7.0,\n            duration: 6,\n            entryTicket: 100,\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n            milestones: [],\n          },\n          status: \"active\",\n          tenant: new Types.ObjectId(),\n          createdBy: getTestUserId(),\n          investors: [],\n        },\n        {\n          name: \"Project 2\",\n          description: \"Second project\",\n          type: \"commercial\",\n          location: {\n            address: \"222 Second St\",\n            city: \"Second City\",\n            postalCode: \"33333\",\n          },\n          financials: {\n            totalInvestment: 20000,\n            targetAmount: 40000,\n            currentAmount: 0,\n            expectedReturn: 8.0,\n            duration: 12,\n            entryTicket: 200,\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n            milestones: [],\n          },\n          status: \"planning\",\n          tenant: new Types.ObjectId(),\n          createdBy: getTestUserId(),\n          investors: [],\n        },\n      ]);\n\n      const userProjects = await Project.find({ createdBy: getTestUserId() });\n      expect(userProjects).toHaveLength(2);\n      expect(userProjects[0]?.createdBy?.toString()).toBe(getTestUserId());\n    });\n\n    it(\"should handle date range queries\", async () => {\n      const startDate = new Date(\"2024-01-01\");\n      const endDate = new Date(\"2024-12-31\");\n\n      const project = await Project.create({\n        name: \"Date Range Project\",\n        description: \"Testing date queries\",\n        type: \"mixed\",\n        location: {\n          address: \"333 Date St\",\n          city: \"Date City\",\n          postalCode: \"44444\",\n        },\n        financials: {\n          totalInvestment: 15000,\n          targetAmount: 30000,\n          currentAmount: 0,\n          expectedReturn: 7.5,\n          duration: 9,\n          entryTicket: 150,\n        },\n        timeline: {\n          startDate,\n          endDate,\n          milestones: [],\n        },\n        status: \"active\",\n        tenant: new Types.ObjectId(),\n        createdBy: getTestUserId(),\n        investors: [],\n      });\n\n      const foundProjects = await Project.find({\n        \"timeline.startDate\": { $gte: new Date(\"2023-12-01\") },\n        \"timeline.endDate\": { $lte: new Date(\"2025-01-01\") },\n      });\n\n      expect(foundProjects).toHaveLength(1);\n      expect(foundProjects[0]?.name).toBe(\"Date Range Project\");\n    });\n  });\n\n  describe(\"Validation and Error Handling\", () => {\n    it(\"should validate required fields\", async () => {\n      await expect(\n        User.create({\n          email: \"invalid@test.com\",\n        }),\n      ).rejects.toThrow();\n    });\n\n    it(\"should handle invalid ObjectId references\", async () => {\n      const invalidId = new mongoose.Types.ObjectId();\n\n      await expect(\n        Project.create({\n          name: \"Invalid Owner\",\n          description: \"Testing invalid owner\",\n          type: \"residential\",\n          location: {\n            address: \"Invalid St\",\n            city: \"Invalid City\",\n            postalCode: \"00000\",\n          },\n          financials: {\n            totalInvestment: 1000,\n            targetAmount: 2000,\n            currentAmount: 0,\n            expectedReturn: 5.0,\n            duration: 1,\n            entryTicket: 10,\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n            milestones: [],\n          },\n          status: \"active\",\n          tenant: new Types.ObjectId(),\n          createdBy: invalidId,\n          investors: [],\n        }),\n      ).rejects.toThrow();\n    });\n\n    it(\"should handle database errors gracefully\", async () => {\n      try {\n        await User.create({\n          email: \"test@example.com\", // Duplicate email\n          password: \"test123\",\n          profile: {\n            firstName: \"Duplicate\",\n            lastName: \"User\",\n            kycStatus: \"pending\",\n            kycDocuments: [],\n          },\n          role: \"investor\",\n          investments: [],\n          preferences: {\n            riskTolerance: \"medium\",\n            investmentHorizon: \"medium\",\n            notifications: {\n              email: true,\n              sms: false,\n              push: true,\n            },\n          },\n        });\n      } catch (_error) {\n        expect(error).toBeDefined();\n        if (error instanceof Error) {\n          expect(error.message).toContain(\"duplicate\");\n        }\n      }\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\examples\\multi-tenant-complete-example.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .name on an `any` value.","line":181,"column":48,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":181,"endColumn":52},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .name on an `any` value.","line":230,"column":31,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":230,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .name on an `any` value.","line":233,"column":31,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":233,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":243,"column":13,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":247,"endColumn":9},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":249,"column":13,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":256,"endColumn":9},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":252,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":252,"endColumn":24},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":252,"column":21,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":252,"endColumn":24},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":258,"column":13,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":260,"endColumn":26},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":259,"column":17,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":259,"endColumn":20},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .owner on an `any` value.","line":263,"column":32,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":263,"endColumn":37},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .owner on an `any` value.","line":264,"column":32,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":264,"endColumn":37},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":301,"column":13,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":303,"endColumn":9},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .name on an `any` value.","line":308,"column":25,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":308,"endColumn":29}],"suppressedMessages":[],"errorCount":13,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { afterAll, beforeAll, beforeEach, describe, expect, it } from \"vitest\";\nimport mongoose, { Connection, Schema } from \"mongoose\";\nimport { MongoMemoryServer } from \"mongodb-memory-server\";\n\n// Export schemas instead of models for multi-tenant usage\nconst UserSchema = new Schema({\n  name: { type: String, required: true },\n  email: { type: String, required: true, unique: true },\n  tenantId: { type: String, required: true },\n  createdAt: { type: Date, default: Date.now },\n});\n\nconst ProjectSchema = new Schema({\n  name: { type: String, required: true },\n  description: String,\n  owner: { type: Schema.Types.ObjectId, ref: \"User\", required: true },\n  tenantId: { type: String, required: true },\n  status: {\n    type: String,\n    enum: [\"active\", \"inactive\", \"planning\"],\n    default: \"planning\",\n  },\n  budget: { type: Number, default: 0 },\n  createdAt: { type: Date, default: Date.now },\n});\n\n// Pattern 1: Single connection with useDb() for multi-tenant\nclass SingleConnectionMultiTenant {\n  private connection: mongoose.Connection | null = null;\n\n  async connect(uri: string): Promise<mongoose.Connection> {\n    if (!this.connection) {\n      await mongoose.connect(uri);\n      this.connection = mongoose.connection;\n    }\n    return this.connection;\n  }\n\n  getTenantDb(tenantId: string): mongoose.Connection {\n    if (!this.connection) {\n      throw new Error(\"Database not connected\");\n    }\n    return this.connection.useDb(`tenant_${tenantId}`, { useCache: true });\n  }\n\n  async disconnect(): Promise<void> {\n    if (this.connection) {\n      await mongoose.disconnect();\n      this.connection = null;\n    }\n  }\n}\n\n// Pattern 2: Multiple connections (one per tenant)\nclass MultipleConnectionMultiTenant {\n  private connections: Map<string, Connection> = new Map();\n\n  async getConnection(\n    tenantId: string,\n    uriTemplate: string,\n  ): Promise<Connection> {\n    if (this.connections.has(tenantId)) {\n      return this.connections.get(tenantId)!;\n    }\n\n    const uri = uriTemplate.replace(\"{tenantId}\", tenantId);\n    const conn = mongoose.createConnection(uri);\n\n    // Register models on this connection\n    conn.model(\"User\", UserSchema);\n    conn.model(\"Project\", ProjectSchema);\n\n    await conn.asPromise();\n    this.connections.set(tenantId, conn);\n\n    return conn;\n  }\n\n  async disconnectAll(): Promise<void> {\n    const promises = Array.from(this.connections.values()).map((conn) =>\n      conn.close(),\n    );\n    await Promise.all(promises);\n    this.connections.clear();\n  }\n\n  getConnectionCount(): number {\n    return this.connections.size;\n  }\n}\n\n// Test setup\ndescribe(\"Multi-Tenant Mongoose Patterns\", () => {\n  let mongoServer: MongoMemoryServer;\n  let singleTenant: SingleConnectionMultiTenant;\n  let multiTenant: MultipleConnectionMultiTenant;\n\n  beforeAll(async () => {\n    mongoServer = await MongoMemoryServer.create();\n    singleTenant = new SingleConnectionMultiTenant();\n    multiTenant = new MultipleConnectionMultiTenant();\n  });\n\n  afterAll(async () => {\n    await singleTenant.disconnect();\n    await multiTenant.disconnectAll();\n    await mongoServer.stop();\n  });\n\n  describe(\"Pattern 1:param Single Connection with useDb()\", () => {\n    beforeAll(async () => {\n      const uri = mongoServer.getUri();\n      await singleTenant.connect(uri);\n    });\n\n    beforeEach(async () => {\n      // Clean tenant databases\n      const tenant1Db = singleTenant.getTenantDb(\"tenant1\");\n      const tenant2Db = singleTenant.getTenantDb(\"tenant2\");\n\n      await tenant1Db.dropDatabase();\n      await tenant2Db.dropDatabase();\n    });\n\n    it(\"should isolate data between tenants\", async () => {\n      // Tenant 1 operations\n      const tenant1Db = singleTenant.getTenantDb(\"tenant1\");\n      const tenant1UserModel = tenant1Db.model(\"User\", UserSchema);\n\n      await tenant1UserModel.create({\n        name: \"Alice\",\n        email: \"alice@example.com\",\n        tenantId: \"tenant1\",\n      });\n\n      // Tenant 2 operations\n      const tenant2Db = singleTenant.getTenantDb(\"tenant2\");\n      const tenant2UserModel = tenant2Db.model(\"User\", UserSchema);\n\n      await tenant2UserModel.create({\n        name: \"Bob\",\n        email: \"bob@example.com\",\n        tenantId: \"tenant2\",\n      });\n\n      // Verify isolation\n      const tenant1Users = await tenant1UserModel.find();\n      const tenant2Users = await tenant2UserModel.find();\n\n      expect(tenant1Users).toHaveLength(1);\n      expect(tenant1Users[0]?.name).toBe(\"Alice\");\n\n      expect(tenant2Users).toHaveLength(1);\n      expect(tenant2Users[0]?.name).toBe(\"Bob\");\n    });\n\n    it(\"should handle project relationships within tenant\", async () => {\n      const tenant1Db = singleTenant.getTenantDb(\"tenant1\");\n      const tenant1UserModel = tenant1Db.model(\"User\", UserSchema);\n      const tenant1ProjectModel = tenant1Db.model(\"Project\", ProjectSchema);\n\n      const user = await tenant1UserModel.create({\n        name: \"Charlie\",\n        email: \"charlie@example.com\",\n        tenantId: \"tenant1\",\n      });\n\n      const project = await tenant1ProjectModel.create({\n        name: \"Project Alpha\",\n        description: \"First project\",\n        owner: user._id,\n        tenantId: \"tenant1\",\n      });\n\n      const populatedProject = await tenant1ProjectModel\n        .findById(project._id)\n        .populate(\"owner\");\n\n      expect(populatedProject).toBeDefined();\n      expect(populatedProject?.owner).toBeDefined();\n      expect((populatedProject?.owner as any)?.name).toBe(\"Charlie\");\n    });\n  });\n\n  describe(\"Pattern 2: Multiple Connections\", () => {\n    beforeEach(async () => {\n      await multiTenant.disconnectAll();\n    });\n\n    it(\"should create separate connections for each tenant\", async () => {\n      const uriTemplate = mongoServer.getUri() + \"/{tenantId}\";\n\n      const conn1 = await multiTenant.getConnection(\"tenant1\", uriTemplate);\n      const conn2 = await multiTenant.getConnection(\"tenant2\", uriTemplate);\n\n      expect(conn1).toBeDefined();\n      expect(conn2).toBeDefined();\n      expect(conn1).not.toBe(conn2);\n      expect(multiTenant.getConnectionCount()).toBe(2);\n    });\n\n    it(\"should maintain separate data per tenant connection\", async () => {\n      const uriTemplate = mongoServer.getUri() + \"/{tenantId}\";\n\n      // Tenant 1\n      const conn1 = await multiTenant.getConnection(\"tenant1\", uriTemplate);\n      const UserModel1 = conn1.model(\"User\");\n\n      await UserModel1.create({\n        name: \"David\",\n        email: \"david@example.com\",\n        tenantId: \"tenant1\",\n      });\n\n      // Tenant 2\n      const conn2 = await multiTenant.getConnection(\"tenant2\", uriTemplate);\n      const UserModel2 = conn2.model(\"User\");\n\n      await UserModel2.create({\n        name: \"Eve\",\n        email: \"eve@example.com\",\n        tenantId: \"tenant2\",\n      });\n\n      // Verify isolation\n      const tenant1Users = await UserModel1.find();\n      const tenant2Users = await UserModel2.find();\n\n      expect(tenant1Users).toHaveLength(1);\n      expect(tenant1Users[0]?.name).toBe(\"David\");\n\n      expect(tenant2Users).toHaveLength(1);\n      expect(tenant2Users[0]?.name).toBe(\"Eve\");\n    });\n\n    it(\"should handle complex relationships across tenant connections\", async () => {\n      const uriTemplate = mongoServer.getUri() + \"/{tenant1}\" + \"/{tenantId}\";\n\n      const conn1 = await multiTenant.getConnection(\"tenant1\", uriTemplate);\n      const UserModel1 = conn1.model(\"User\");\n      const ProjectModel1 = conn1.model(\"Project\");\n\n      const user = await UserModel1.create({\n        name: \"Frank\",\n        email: \"frank@example.com\",\n        tenantId: \"tenant1\",\n      });\n\n      const project = await ProjectModel1.create({\n        name: \"Project Beta\",\n        description: \"Second project\",\n        owner: user._id,\n        tenantId: \"tenant1\",\n        status: \"active\",\n        budget: 50000,\n      });\n\n      const populatedProject = await ProjectModel1.findById(\n        project._id,\n      ).populate(\"owner\");\n\n      expect(populatedProject).toBeDefined();\n      expect(populatedProject?.owner).toBeDefined();\n      expect(populatedProject?.owner.name).toBe(\"Frank\");\n    });\n  });\n\n  describe(\"Performance Comparison\", () => {\n    it(\"should demonstrate both patterns work correctly\", async () => {\n      const uri = mongoServer.getUri();\n      const uriTemplate = uri + \"/{tenantId}\";\n\n      // Test single connection pattern\n      await singleTenant.connect(uri);\n      const singleConn = singleTenant.getTenantDb(\"perf-test\");\n      const singleUserModel = singleConn.model(\"User\", UserSchema);\n\n      await singleUserModel.create({\n        name: \"Performance Test User\",\n        email: \"perf@test.com\",\n        tenantId: \"perf-test\",\n      });\n\n      // Test multiple connection pattern\n      const multiConn = await multiTenant.getConnection(\n        \"perf-test\",\n        uriTemplate,\n      );\n      const multiUserModel = multiConn.model(\"User\");\n\n      await multiUserModel.create({\n        name: \"Multi Connection User\",\n        email: \"multi@test.com\",\n        tenantId: \"perf-test\",\n      });\n\n      // Verify both work\n      const singleUser = await singleUserModel.findOne({\n        email: \"perf@test.com\",\n      });\n      const multiUser = await multiUserModel.findOne({\n        email: \"multi@test.com\",\n      });\n\n      expect(singleUser).toBeDefined();\n      expect(multiUser).toBeDefined();\n      expect(singleUser?.name).toBe(\"Performance Test User\");\n      expect(multiUser?.name).toBe(\"Multi Connection User\");\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\helpers\\testHelpers.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":32},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":4,"endColumn":31},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":5,"endColumn":38},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":60,"column":26,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":60,"endColumn":31}],"suppressedMessages":[],"errorCount":4,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose from \"mongoose\";\nimport request from \"supertest\";\nimport jwt from \"jsonwebtoken\";\nimport bcrypt from \"bcryptjs\";\nimport User from \"../../models/User\";\nimport app from \"../../app\";\n\nexport interface TestUser {\n  email: string;\n  password: string;\n  role: string;\n  token?: string;\n  userId?: string;\n}\n\nexport class TestHelpers {\n  static async createTestUser(userData: Partial<TestUser> = {}) {\n    const defaultUser = {\n      email: \"test@example.com\",\n      password: \"Test123!\",\n      role: \"investor\",\n      ...userData,\n    };\n\n    const hashedPassword = await bcrypt.hash(defaultUser.password, 10);\n\n    const user = new User({\n      email: defaultUser.email,\n      password: hashedPassword,\n      role: defaultUser.role,\n      firstName: \"Test\",\n      lastName: \"User\",\n      isEmailVerified: true,\n      isActive: true,\n    });\n\n    await user.save();\n\n    const token = jwt.sign(\n      { userId: user._id, email: user.email, role: user.role },\n      process.env.JWT_SECRET || \"test-secret-key\",\n      { expiresIn: \"7d\" },\n    );\n\n    return {\n      user,\n      token,\n      password: defaultUser.password,\n    };\n  }\n\n  static async authenticateUser(\n    email: string,\n    password: string,\n  ): Promise<string> {\n    const response = await request(app)\n      .post(\"/api/auth/login\")\n      .send({ email, password });\n\n    return response.body.token as string;\n  }\n\n  static generateAuthToken(userId: string, role: string = \"investor\"): string {\n    return jwt.sign(\n      { userId, role },\n      process.env.JWT_SECRET || \"test-secret-key\",\n      { expiresIn: \"7d\" },\n    );\n  }\n\n  static async createAuthenticatedUser(role: string = \"investor\") {\n    const userData = await this.createTestUser({ role });\n    return {\n      ...userData,\n      authHeader: `Bearer ${userData.token}`,\n    };\n  }\n\n  static async clearAllCollections(): Promise<void> {\n    const collections = mongoose.connection.collections;\n    for (const key in collections) {\n      const collection = collections[key];\n      if (collection) {\n        await collection.deleteMany({});\n      }\n    }\n  }\n}\n\nexport const testUsers = {\n  admin: {\n    email: \"admin@test.com\",\n    password: \"Admin123!\",\n    role: \"admin\",\n  },\n  investor: {\n    email: \"investor@test.com\",\n    password: \"Investor123!\",\n    role: \"investor\",\n  },\n  tenant: {\n    email: \"tenant@test.com\",\n    password: \"Tenant123!\",\n    role: \"tenant\",\n  },\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\helpers\\userHelpers.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\helpers\\userHelpers.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":2,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":2,"endColumn":44}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import bcrypt from \"bcryptjs\";\nimport { IUser } from \"../../types/models\";\nimport User from \"../../models/User\";\n\n/**\n * Creates a valid test user with all required fields\n * @param overrides - Override default user data\n * @returns Created user document\n */\nexport const createValidTestUser = async (\n  overrides: Partial<IUser> = {},\n): Promise<any> => {\n  const defaultUser = {\n    email: \"test@example.com\",\n    password: await bcrypt.hash(\"Test123!\", 10),\n    role: \"investor\",\n    isEmailVerified: true,\n    profile: {\n      firstName: \"Test\",\n      lastName: \"User\",\n      phone: \"+1234567890\",\n      ...overrides.profile,\n    },\n    ...overrides,\n  };\n\n  const user = new User(defaultUser);\n  return await user.save();\n};\n\n/**\n * Creates a valid test admin user\n * @param overrides - Override default admin data\n * @returns Created admin user document\n */\nexport const createValidTestAdmin = async (\n  overrides: Partial<IUser> = {},\n): Promise<any> => {\n  const defaultAdmin = {\n    email: \"admin@test.com\",\n    password: await bcrypt.hash(\"admin123\", 10),\n    role: \"admin\",\n    isEmailVerified: true,\n    profile: {\n      firstName: \"Admin\",\n      lastName: \"User\",\n      phone: \"+1234567890\",\n      ...overrides.profile,\n    },\n    ...overrides,\n  };\n\n  const admin = new User(defaultAdmin);\n  return await admin.save();\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\integration\\admin-api.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":13,"column":13,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":13,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":13,"column":40,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":13,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .users on an `any` value.","line":21,"column":42,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":21,"endColumn":47},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":31,"column":13,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":31,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":31,"column":40,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":31,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":48,"column":13,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":48,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":48,"column":40,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":48,"endColumn":45}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, expect, it } from \"vitest\";\r\nimport { request } from \"../setup/test-setup\";\r\n\r\ndescribe(\"Admin API Integration Tests\", () => {\r\n  describe(\"GET /api/admin/users\", () => {\r\n    it(\"should return 200 for admin users\", async () => {\r\n      // Login as admin\r\n      const loginResponse = await request.post(\"/api/auth/login\").send({\r\n        email: \"admin@solia.org\",\r\n        password: \"admin123\",\r\n      });\r\n\r\n      const token = loginResponse.body.token;\r\n\r\n      const response = await request\r\n        .get(\"/api/admin/users\")\r\n        .set(\"Authorization\", `Bearer ${token}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty(\"users\");\r\n      expect(Array.isArray(response.body.users)).toBe(true);\r\n    });\r\n\r\n    it(\"should return 403 for non-admin users\", async () => {\r\n      // Login as regular user\r\n      const loginResponse = await request.post(\"/api/auth/login\").send({\r\n        email: \"user@solia.org\",\r\n        password: \"user123\",\r\n      });\r\n\r\n      const token = loginResponse.body.token;\r\n\r\n      const response = await request\r\n        .get(\"/api/admin/users\")\r\n        .set(\"Authorization\", `Bearer ${token}`);\r\n\r\n      expect(response.status).toBe(403);\r\n    });\r\n  });\r\n\r\n  describe(\"GET /api/admin/stats\", () => {\r\n    it(\"should return admin statistics\", async () => {\r\n      const loginResponse = await request.post(\"/api/auth/login\").send({\r\n        email: \"admin@solia.org\",\r\n        password: \"admin123\",\r\n      });\r\n\r\n      const token = loginResponse.body.token;\r\n\r\n      const response = await request\r\n        .get(\"/api/admin/stats\")\r\n        .set(\"Authorization\", `Bearer ${token}`);\r\n\r\n      expect(response.status).toBe(200);\r\n      expect(response.body).toHaveProperty(\"totalUsers\");\r\n      expect(response.body).toHaveProperty(\"totalProjects\");\r\n    });\r\n  });\r\n});\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\kyc_integration.test.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'afterAll' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":11},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'beforeAll' is defined but never used. Allowed unused vars must match /^_/u.","line":3,"column":3,"nodeType":null,"messageId":"unusedVar","endLine":3,"endColumn":12},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":12,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":12,"endColumn":31},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":14,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":14,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `any` typed value.","line":42,"column":11,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":42,"endColumn":20},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .save on an `any` value.","line":42,"column":16,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":42,"endColumn":20},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":44,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":44,"endColumn":25},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":44,"column":22,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":44,"endColumn":25},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":72,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":72,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":73,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":73,"endColumn":32},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":74,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":74,"endColumn":32},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":76,"column":52,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":76,"endColumn":55},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":88,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":88,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":89,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":89,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":98,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":98,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":113,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":113,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":114,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":114,"endColumn":35},{"ruleId":"@typescript-eslint/unbound-method","severity":2,"message":"Avoid referencing unbound methods which may cause unintentional scoping of `this`.\nIf your function does not access `this`, you can annotate it with `this: void`, or consider using an arrow function instead.","line":119,"column":32,"nodeType":"MemberExpression","messageId":"unboundWithoutThisAnnotation","endLine":119,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":128,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":128,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":129,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":129,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .profile on an `any` value.","line":138,"column":12,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":138,"endColumn":19},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .profile on an `any` value.","line":139,"column":12,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":139,"endColumn":19},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `any` typed value.","line":142,"column":13,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":142,"endColumn":22},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .save on an `any` value.","line":142,"column":18,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":142,"endColumn":22},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":149,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":149,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":150,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":150,"endColumn":32},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":151,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":151,"endColumn":32},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":165,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":165,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":166,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":166,"endColumn":35},{"ruleId":"@typescript-eslint/unbound-method","severity":2,"message":"Avoid referencing unbound methods which may cause unintentional scoping of `this`.\nIf your function does not access `this`, you can annotate it with `this: void`, or consider using an arrow function instead.","line":170,"column":32,"nodeType":"MemberExpression","messageId":"unboundWithoutThisAnnotation","endLine":170,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":178,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":178,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":179,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":179,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .profile on an `any` value.","line":189,"column":12,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":189,"endColumn":19},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `any` typed value.","line":190,"column":13,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":190,"endColumn":22},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .save on an `any` value.","line":190,"column":18,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":190,"endColumn":22},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":192,"column":71,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":192,"endColumn":74},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":195,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":195,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":196,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":196,"endColumn":32},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"ObjectId\" of template literal expression.","line":203,"column":28,"nodeType":"Identifier","messageId":"invalidType","endLine":203,"endColumn":41},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":207,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":207,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":208,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":208,"endColumn":35},{"ruleId":"@typescript-eslint/unbound-method","severity":2,"message":"Avoid referencing unbound methods which may cause unintentional scoping of `this`.\nIf your function does not access `this`, you can annotate it with `this: void`, or consider using an arrow function instead.","line":212,"column":32,"nodeType":"MemberExpression","messageId":"unboundWithoutThisAnnotation","endLine":212,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":215,"column":71,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":215,"endColumn":74},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":218,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":218,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":219,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":219,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":230,"column":38,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":230,"endColumn":41},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":234,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":234,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .data on an `any` value.","line":235,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":235,"endColumn":32},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":237,"column":52,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":237,"endColumn":55},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"ObjectId\" of template literal expression.","line":245,"column":33,"nodeType":"Identifier","messageId":"invalidType","endLine":245,"endColumn":46},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":249,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":249,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":250,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":250,"endColumn":35},{"ruleId":"@typescript-eslint/unbound-method","severity":2,"message":"Avoid referencing unbound methods which may cause unintentional scoping of `this`.\nIf your function does not access `this`, you can annotate it with `this: void`, or consider using an arrow function instead.","line":254,"column":32,"nodeType":"MemberExpression","messageId":"unboundWithoutThisAnnotation","endLine":254,"endColumn":45},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":258,"column":38,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":258,"endColumn":41},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .success on an `any` value.","line":262,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":262,"endColumn":35},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .message on an `any` value.","line":263,"column":28,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":263,"endColumn":35}],"suppressedMessages":[],"errorCount":56,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import {\n  afterAll,\n  beforeAll,\n  beforeEach,\n  describe,\n  expect,\n  it,\n  vi,\n} from \"vitest\";\nimport mongoose from \"mongoose\";\nimport request from \"supertest\";\nimport express from \"express\";\nimport jwt from \"jsonwebtoken\";\nimport User from \"../models/User\";\nimport kycRoutes from \"../routes/kyc\";\n\nconst app = express();\napp.use(express.json());\napp.use(\"/api/kyc\", kycRoutes);\n\n// Use global setup for database connection\n// Connection is handled in tests/setup/global-setup.ts\n\nbeforeEach(async () => {\n  // Clear collections - handled by global setup\n  await User.deleteMany({});\n});\n\ndescribe(\"KYC Integration Tests\", () => {\n  let user: any;\n  let token: string;\n\n  beforeEach(async () => {\n    user = new User({\n      email: \"test@example.com\",\n      password: \"password123\",\n      profile: {\n        firstName: \"Test\",\n        lastName: \"User\",\n      },\n    });\n    await user.save();\n    token = jwt.sign(\n      { userId: user._id },\n      process.env.JWT_SECRET || \"your-secret-key\",\n    );\n  });\n\n  describe(\"POST /api/kyc/submit\", () => {\n    it(\"should submit KYC successfully\", async () => {\n      const kycData = {\n        documents: [\n          {\n            type: \"id_card\",\n            url: \"https://example.com/id.pdf\",\n            status: \"pending\",\n          },\n          {\n            type: \"proof_of_address\",\n            url: \"https://example.com/address.pdf\",\n            status: \"pending\",\n          },\n        ],\n      };\n\n      const response = await request(app)\n        .post(\"/api/kyc/submit\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({ kycData });\n\n      expect(response.status).toBe(201);\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.status).toBe(\"pending\");\n      expect(response.body.data.kycId).toBeDefined();\n\n      const updatedUser = await User.findById(user._id);\n      expect(updatedUser?.profile.kycStatus).toBe(\"pending\");\n      expect(updatedUser?.profile.kycDocuments).toHaveLength(2);\n    });\n\n    it(\"should return 400 for missing KYC data\", async () => {\n      const response = await request(app)\n        .post(\"/api/kyc/submit\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({});\n\n      expect(response.status).toBe(400);\n      expect(response.body.success).toBe(false);\n      expect(response.body.message).toBe(\"KYC data and documents are required\");\n    });\n\n    it(\"should return 401 for missing token\", async () => {\n      const response = await request(app)\n        .post(\"/api/kyc/submit\")\n        .send({ kycData: { documents: [] } });\n\n      expect(response.status).toBe(401);\n      expect(response.body.message).toBe(\"No token provided\");\n    });\n\n    it(\"should return 404 for non-existent user\", async () => {\n      const invalidToken = jwt.sign(\n        { userId: new mongoose.Types.ObjectId() },\n        process.env.JWT_SECRET || \"your-secret-key\",\n      );\n\n      const response = await request(app)\n        .post(\"/api/kyc/submit\")\n        .set(\"Authorization\", `Bearer ${invalidToken}`)\n        .send({ kycData: { documents: [] } });\n\n      expect(response.status).toBe(404);\n      expect(response.body.success).toBe(false);\n      expect(response.body.message).toBe(\"User not found\");\n    });\n\n    it(\"should return 500 for server error\", async () => {\n      // Mock User.findById to throw an error\n      const originalFindById = User.findById;\n      User.findById = vi.fn().mockRejectedValue(new Error(\"Database error\"));\n\n      const response = await request(app)\n        .post(\"/api/kyc/submit\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({ kycData: { documents: [] } });\n\n      expect(response.status).toBe(500);\n      expect(response.body.success).toBe(false);\n      expect(response.body.message).toBe(\"Server error during KYC submission\");\n\n      // Restore original method\n      User.findById = originalFindById;\n    });\n  });\n\n  describe(\"GET /api/kyc/status\", () => {\n    it(\"should get KYC status successfully\", async () => {\n      user.profile.kycStatus = \"verified\";\n      user.profile.kycDocuments = [\n        { type: \"id_card\", url: \"test.pdf\", status: \"approved\" },\n      ];\n      await user.save();\n\n      const response = await request(app)\n        .get(\"/api/kyc/status\")\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(response.status).toBe(200);\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.status).toBe(\"verified\");\n      expect(response.body.data.documents).toHaveLength(1);\n    });\n\n    it(\"should return 404 for non-existent user\", async () => {\n      const invalidToken = jwt.sign(\n        { userId: new mongoose.Types.ObjectId() },\n        process.env.JWT_SECRET || \"your-secret-key\",\n      );\n\n      const response = await request(app)\n        .get(\"/api/kyc/status\")\n        .set(\"Authorization\", `Bearer ${invalidToken}`);\n\n      expect(response.status).toBe(404);\n      expect(response.body.success).toBe(false);\n      expect(response.body.message).toBe(\"User not found\");\n    });\n\n    it(\"should return 500 for server error\", async () => {\n      const originalFindById = User.findById;\n      User.findById = vi.fn().mockRejectedValue(new Error(\"Database error\"));\n\n      const response = await request(app)\n        .get(\"/api/kyc/status\")\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(response.status).toBe(500);\n      expect(response.body.success).toBe(false);\n      expect(response.body.message).toBe(\n        \"Server error while fetching KYC status\",\n      );\n\n      User.findById = originalFindById;\n    });\n  });\n\n  describe(\"GET /api/kyc/status/:userId\", () => {\n    it(\"should get KYC status by user ID successfully\", async () => {\n      user.profile.kycStatus = \"rejected\";\n      await user.save();\n\n      const response = await request(app).get(`/api/kyc/status/${user._id}`);\n\n      expect(response.status).toBe(200);\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.status).toBe(\"rejected\");\n    });\n\n    it(\"should return 404 for non-existent user\", async () => {\n      const nonExistentId = new mongoose.Types.ObjectId();\n\n      const response = await request(app).get(\n        `/api/kyc/status/${nonExistentId}`,\n      );\n\n      expect(response.status).toBe(404);\n      expect(response.body.success).toBe(false);\n      expect(response.body.message).toBe(\"User not found\");\n    });\n\n    it(\"should return 500 for server error\", async () => {\n      const originalFindById = User.findById;\n      User.findById = vi.fn().mockRejectedValue(new Error(\"Database error\"));\n\n      const response = await request(app).get(`/api/kyc/status/${user._id}`);\n\n      expect(response.status).toBe(500);\n      expect(response.body.success).toBe(false);\n      expect(response.body.message).toBe(\n        \"Server error while fetching KYC status\",\n      );\n\n      User.findById = originalFindById;\n    });\n  });\n\n  describe(\"PUT /api/kyc/status/:userId\", () => {\n    it(\"should update KYC status successfully\", async () => {\n      const response = await request(app)\n        .put(`/api/kyc/status/${user._id}`)\n        .send({ status: \"verified\", comments: \"All documents verified\" });\n\n      expect(response.status).toBe(200);\n      expect(response.body.success).toBe(true);\n      expect(response.body.data.status).toBe(\"verified\");\n\n      const updatedUser = await User.findById(user._id);\n      expect(updatedUser?.profile.kycStatus).toBe(\"verified\");\n    });\n\n    it(\"should return 404 for non-existent user\", async () => {\n      const nonExistentId = new mongoose.Types.ObjectId();\n\n      const response = await request(app)\n        .put(`/api/kyc/status/${nonExistentId}`)\n        .send({ status: \"verified\" });\n\n      expect(response.status).toBe(404);\n      expect(response.body.success).toBe(false);\n      expect(response.body.message).toBe(\"User not found\");\n    });\n\n    it(\"should return 500 for server error\", async () => {\n      const originalFindById = User.findById;\n      User.findById = vi.fn().mockRejectedValue(new Error(\"Database error\"));\n\n      const response = await request(app)\n        .put(`/api/kyc/status/${user._id}`)\n        .send({ status: \"verified\" });\n\n      expect(response.status).toBe(500);\n      expect(response.body.success).toBe(false);\n      expect(response.body.message).toBe(\"Server error during KYC update\");\n\n      User.findById = originalFindById;\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\matchers\\project.matchers.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'T' is defined but never used. Allowed unused vars must match /^_/u.","line":195,"column":23,"nodeType":null,"messageId":"unusedVar","endLine":195,"endColumn":24}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { Types } from \"mongoose\";\nimport { expect } from \"vitest\";\n\ninterface ProjectData {\n  name?: string;\n  description?: string;\n  type?: string;\n  financials?: {\n    totalInvestment?: number;\n    targetAmount?: number;\n    expectedReturn?: number;\n    duration?: number;\n    entryTicket?: number;\n    currentAmount?: number;\n  };\n  timeline?: {\n    startDate?: Date;\n    endDate?: Date;\n  };\n  tenant?: Types.ObjectId;\n  createdBy?: Types.ObjectId;\n  status?: string;\n}\n\n// Custom matchers pour les tests de projets avec types sÃ©curisÃ©s\nexpect.extend({\n  toBeValidProject(received: unknown) {\n    const { isNot } = this;\n    const project = received as ProjectData;\n\n    const pass = Boolean(\n      project &&\n        typeof project === \"object\" &&\n        project.name &&\n        project.description &&\n        project.type &&\n        project.financials &&\n        project.timeline &&\n        project.tenant &&\n        project.createdBy,\n    );\n\n    return {\n      pass,\n      message: () => {\n        const hint = this.utils.matcherHint(\"toBeValidProject\", undefined, \"\", {\n          isNot,\n        });\n\n        if (pass && isNot) {\n          return `${hint}\\n\\nExpected value not to be a valid project, but it was`;\n        }\n\n        if (!pass && !isNot) {\n          return (\n            `${hint}\\n\\nExpected value to be a valid project\\n` +\n            `Received: ${this.utils.printReceived(received)}`\n          );\n        }\n\n        return `${hint}`;\n      },\n    };\n  },\n\n  toHaveFinancialStructure(received: unknown) {\n    const { isNot } = this;\n    const project = received as ProjectData;\n\n    const financials = project?.financials;\n    const pass = Boolean(\n      financials &&\n        typeof financials.totalInvestment === \"number\" &&\n        financials.totalInvestment > 0 &&\n        typeof financials.targetAmount === \"number\" &&\n        financials.targetAmount > 0 &&\n        typeof financials.expectedReturn === \"number\" &&\n        financials.expectedReturn > 0 &&\n        typeof financials.duration === \"number\" &&\n        financials.duration > 0 &&\n        typeof financials.entryTicket === \"number\" &&\n        financials.entryTicket > 0,\n    );\n\n    return {\n      pass,\n      message: () => {\n        const hint = this.utils.matcherHint(\n          \"toHaveFinancialStructure\",\n          undefined,\n          \"\",\n          {\n            isNot,\n          },\n        );\n\n        if (pass && isNot) {\n          return `${hint}\\n\\nExpected project not to have valid financial structure`;\n        }\n\n        if (!pass && !isNot) {\n          return (\n            `${hint}\\n\\nExpected project to have valid financial structure\\n` +\n            `Financials: ${this.utils.printReceived(project?.financials)}`\n          );\n        }\n\n        return `${hint}`;\n      },\n    };\n  },\n\n  toHaveValidTimeline(received: unknown) {\n    const { isNot } = this;\n    const project = received as ProjectData;\n\n    const timeline = project?.timeline;\n    const pass = Boolean(\n      timeline &&\n        timeline.startDate instanceof Date &&\n        timeline.endDate instanceof Date &&\n        timeline.endDate.getTime() > timeline.startDate.getTime(),\n    );\n\n    return {\n      pass,\n      message: () => {\n        const hint = this.utils.matcherHint(\n          \"toHaveValidTimeline\",\n          undefined,\n          \"\",\n          {\n            isNot,\n          },\n        );\n\n        if (pass && isNot) {\n          return `${hint}\\n\\nExpected project not to have valid timeline`;\n        }\n\n        if (!pass && !isNot) {\n          return (\n            `${hint}\\n\\nExpected project to have valid timeline\\n` +\n            `Timeline: ${this.utils.printReceived(project?.timeline)}`\n          );\n        }\n\n        return `${hint}`;\n      },\n    };\n  },\n\n  toBeFundedProject(received: unknown) {\n    const { isNot } = this;\n    const project = received as ProjectData;\n\n    const pass = Boolean(\n      project?.status === \"funded\" &&\n        project.financials?.currentAmount === project.financials?.targetAmount,\n    );\n\n    return {\n      pass,\n      message: () => {\n        const hint = this.utils.matcherHint(\n          \"toBeFundedProject\",\n          undefined,\n          \"\",\n          {\n            isNot,\n          },\n        );\n\n        if (pass && isNot) {\n          return `${hint}\\n\\nExpected project not to be funded`;\n        }\n\n        if (!pass && !isNot) {\n          return (\n            `${hint}\\n\\nExpected project to be funded\\n` +\n            `Status: ${this.utils.printReceived(project?.status)}\\n` +\n            `Current: ${this.utils.printReceived(project?.financials?.currentAmount)}\\n` +\n            `Target: ${this.utils.printReceived(project?.financials?.targetAmount)}`\n          );\n        }\n\n        return `${hint}`;\n      },\n    };\n  },\n});\n\n// Types TypeScript pour les matchers customs\ndeclare module \"vitest\" {\n  interface Assertion<T = any> {\n    toBeValidProject(): void;\n    toHaveFinancialStructure(): void;\n    toHaveValidTimeline(): void;\n    toBeFundedProject(): void;\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\middleware\\admin.integration.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\middleware\\auth.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\models\\Project.model.test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\models\\Project.test.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'connection' is assigned a value but never used.","line":6,"column":7,"nodeType":"Identifier","messageId":"unusedVar","endLine":6,"endColumn":17}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, it, expect, beforeEach, afterEach } from \"vitest\";\nimport mongoose from \"mongoose\";\nimport Project from \"../../models/Project.js\";\n\ndescribe(\"Project Model\", () => {\n  let connection;\n\n  beforeEach(async () => {\n    // Connect to in-memory MongoDB\n    connection = await mongoose.connect(\n      process.env.MONGODB_URI || \"mongodb:param//localhost:param27017/test_db\",\n    );\n  });\n\n  afterEach(async () => {\n    await mongoose.connection.dropDatabase();\n    await mongoose.connection.close();\n  });\n\n  describe(\"Schema Validation\", () => {\n    it(\"should create a valid project with all required fields\", async () => {\n      const projectData = {\n        name: \"Test Residential Project\",\n        description: \"A test project for residential development\",\n        type: \"residential\",\n        location: {\n          address: \"123 Test Street\",\n          city: \"Test City\",\n          postalCode: \"12345\",\n          coordinates: { lat: 40.7128, lng: -74.006 },\n        },\n        financials: {\n          totalInvestment: 1000000,\n          targetAmount: 500000,\n          expectedReturn: 8.5,\n          duration: 24,\n          entryTicket: 10000,\n        },\n        timeline: {\n          startDate: new Date(\"2024-01-01\"),\n          endDate: new Date(\"2025-12-31\"),\n        },\n        tenant: new mongoose.Types.ObjectId(),\n        createdBy: new mongoose.Types.ObjectId(),\n      };\n\n      const project = new Project(projectData);\n      const savedProject = await project.save();\n\n      expect(savedProject._id).toBeDefined();\n      expect(savedProject.name).toBe(\"Test Residential Project\");\n      expect(savedProject.type).toBe(\"residential\");\n      expect(savedProject.status).toBe(\"draft\");\n    });\n\n    it(\"should fail validation when required fields are missing\", async () => {\n      const invalidProject = new Project({\n        name: \"Incomplete Project\",\n        // Missing required fields\n      });\n\n      let error;\n      try {\n        await invalidProject.save();\n      } catch (err) {\n        error = err;\n      }\n\n      expect(error).toBeDefined();\n      expect(error.errors).toHaveProperty(\"description\");\n      expect(error.errors).toHaveProperty(\"type\");\n      expect(error.errors).toHaveProperty(\"financials.totalInvestment\");\n    });\n\n    it(\"should validate enum values for type field\", async () => {\n      const invalidProject = new Project({\n        name: \"Test Project\",\n        description: \"Test description\",\n        type: \"invalid_type\",\n        financials: {\n          totalInvestment: 1000000,\n          targetAmount: 500000,\n          expectedReturn: 8.5,\n          duration: 24,\n          entryTicket: 10000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(),\n        },\n        tenant: new mongoose.Types.ObjectId(),\n        createdBy: new mongoose.Types.ObjectId(),\n      });\n\n      let error;\n      try {\n        await invalidProject.save();\n      } catch (err) {\n        error = err;\n      }\n\n      expect(error).toBeDefined();\n      expect(error.errors.type.message).toContain(\n        \"`invalid_type` is not a valid enum value\",\n      );\n    });\n  });\n\n  describe(\"Virtual Properties\", () => {\n    it(\"should calculate progress correctly\", async () => {\n      const project = new Project({\n        name: \"Progress Test\",\n        description: \"Testing progress calculation\",\n        type: \"commercial\",\n        financials: {\n          totalInvestment: 1000000,\n          targetAmount: 500000,\n          currentAmount: 250000,\n          expectedReturn: 10,\n          duration: 36,\n          entryTicket: 5000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(),\n        },\n        tenant: new mongoose.Types.ObjectId(),\n        createdBy: new mongoose.Types.ObjectId(),\n      });\n\n      expect(project.progress).toBe(50);\n    });\n\n    it(\"should calculate remaining amount correctly\", async () => {\n      const project = new Project({\n        name: \"Remaining Amount Test\",\n        description: \"Testing remaining amount\",\n        type: \"mixed\",\n        financials: {\n          totalInvestment: 2000000,\n          targetAmount: 1000000,\n          currentAmount: 300000,\n          expectedReturn: 12,\n          duration: 48,\n          entryTicket: 25000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(),\n        },\n        tenant: new mongoose.Types.ObjectId(),\n        createdBy: new mongoose.Types.ObjectId(),\n      });\n\n      expect(project.remainingAmount).toBe(700000);\n    });\n\n    it(\"should handle zero current amount\", async () => {\n      const project = new Project({\n        name: \"Zero Progress Test\",\n        description: \"Testing zero progress\",\n        type: \"residential\",\n        financials: {\n          totalInvestment: 500000,\n          targetAmount: 500000,\n          currentAmount: 0,\n          expectedReturn: 7,\n          duration: 18,\n          entryTicket: 5000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(),\n        },\n        tenant: new mongoose.Types.ObjectId(),\n        createdBy: new mongoose.Types.ObjectId(),\n      });\n\n      expect(project.progress).toBe(0);\n      expect(project.remainingAmount).toBe(500000);\n    });\n  });\n\n  describe(\"Financial Calculations\", () => {\n    it(\"should handle edge cases for progress calculation\", async () => {\n      const project = new Project({\n        name: \"Edge Case Test\",\n        description: \"Testing edge cases\",\n        type: \"commercial\",\n        financials: {\n          totalInvestment: 1000000,\n          targetAmount: 0,\n          currentAmount: 0,\n          expectedReturn: 5,\n          duration: 12,\n          entryTicket: 1000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(),\n        },\n        tenant: new mongoose.Types.ObjectId(),\n        createdBy: new mongoose.Types.ObjectId(),\n      });\n\n      expect(project.progress).toBe(Infinity);\n    });\n\n    it(\"should handle fully funded projects\", async () => {\n      const project = new Project({\n        name: \"Fully Funded Test\",\n        description: \"Testing fully funded project\",\n        type: \"residential\",\n        financials: {\n          totalInvestment: 2000000,\n          targetAmount: 1000000,\n          currentAmount: 1000000,\n          expectedReturn: 15,\n          duration: 24,\n          entryTicket: 10000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(),\n        },\n        tenant: new mongoose.Types.ObjectId(),\n        createdBy: new mongoose.Types.ObjectId(),\n      });\n\n      expect(project.progress).toBe(100);\n      expect(project.remainingAmount).toBe(0);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\projects-comprehensive.test.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":4,"endColumn":41}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { beforeEach, describe, expect, it } from \"vitest\";\nimport jwt from \"jsonwebtoken\";\nimport supertest from \"supertest\";\nimport Project from \"../models/Project\";\nimport User from \"../models/User\";\nimport app from \"../src/app\";\n\nconst request = supertest(app);\n\ndescribe(\"Projects API\", () => {\n  let userToken: string;\n  let userId: string;\n\n  beforeEach(async () => {\n    const user = await User.create({\n      name: \"Test User\",\n      email: \"test@example.com\",\n      password: \"password123\",\n      role: \"investor\",\n    });\n\n    userId = String(user._id);\n    userToken = jwt.sign(\n      { userId },\n      process.env.JWT_SECRET || \"test-secret\"\n    );\n  });\n\n  describe(\"POST /api/projects\", () => {\n    it(\"should create a new project\", async () => {\n      const res = await request\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${userToken}`)\n        .send({\n          name: \"Test Project\",\n          description: \"A test project\",\n          type: \"residential\",\n          financials: {\n            totalInvestment: 100000,\n            targetAmount: 50000,\n            currentAmount: 0,\n            expectedReturn: 8,\n            duration: 12,\n            entryTicket: 1000,\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000),\n            milestones: [],\n          },\n        });\n\n      expect(res.status).toBe(201);\n      expect(res.body).toHaveProperty(\"name\", \"Test Project\");\n    });\n\n    it(\"should validate entryTicket < targetAmount\", async () => {\n      const res = await request\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${userToken}`)\n        .send({\n          name: \"Invalid Financial Project\",\n          description: \"Test\",\n          type: \"residential\",\n          financials: {\n            totalInvestment: 10000,\n            targetAmount: 5000,\n            currentAmount: 0,\n            expectedReturn: 5,\n            duration: 12,\n            entryTicket: 10000,\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n            milestones: [],\n          },\n        });\n\n      expect(res.status).toBe(400);\n      expect(res.body).toHaveProperty(\"error\");\n    });\n\n    it(\"should get all projects\", async () => {\n      await Project.create({\n        name: \"Test Project 1\",\n        description: \"Test project 1\",\n        type: \"residential\",\n        createdBy: userId,\n        financials: {\n          totalInvestment: 100000,\n          targetAmount: 50000,\n          currentAmount: 0,\n          expectedReturn: 8,\n          duration: 12,\n          entryTicket: 1000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n      });\n\n      const res = await request\n        .get(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${userToken}`);\n\n      expect(res.status).toBe(200);\n      expect(Array.isArray(res.body)).toBe(true);\n    });\n\n    it(\"should get project by id\", async () => {\n      const project = await Project.create({\n        name: \"Test Project\",\n        description: \"Test project\",\n        type: \"residential\",\n        createdBy: userId,\n        financials: {\n          totalInvestment: 100000,\n          targetAmount: 50000,\n          currentAmount: 0,\n          expectedReturn: 8,\n          duration: 12,\n          entryTicket: 1000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n      });\n\n      const res = await request\n        .get(`/api/projects/${String(project._id)}`)\n        .set(\"Authorization\", `Bearer ${userToken}`);\n\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"name\", \"Test Project\");\n    });\n\n    it(\"should update project\", async () => {\n      const project = await Project.create({\n        name: \"Old Project\",\n        description: \"Old description\",\n        type: \"residential\",\n        createdBy: userId,\n        financials: {\n          totalInvestment: 100000,\n          targetAmount: 50000,\n          currentAmount: 0,\n          expectedReturn: 8,\n          duration: 12,\n          entryTicket: 1000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n      });\n\n      const res = await request\n        .put(`/api/projects/${String(project._id)}`)\n        .set(\"Authorization\", `Bearer ${userToken}`)\n        .send({\n          name: \"Updated Project\",\n          description: \"Updated description\",\n        });\n\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"name\", \"Updated Project\");\n    });\n\n    it(\"should delete project\", async () => {\n      const project = await Project.create({\n        name: \"Project to delete\",\n        description: \"Project to delete\",\n        type: \"residential\",\n        createdBy: userId,\n        financials: {\n          totalInvestment: 100000,\n          targetAmount: 50000,\n          currentAmount: 0,\n          expectedReturn: 8,\n          duration: 12,\n          entryTicket: 1000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 365 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n      });\n\n      const res = await request\n        .delete(`/api/projects/${String(project._id)}`)\n        .set(\"Authorization\", `Bearer ${userToken}`);\n\n      expect(res.status).toBe(200);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\projects-edge-cases.test.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":41},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":21,"column":22,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":21,"endColumn":27},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .user on an `any` value.","line":22,"column":24,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":22,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":55,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":55,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":87,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":87,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":112,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":112,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":132,"column":25,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":132,"endColumn":30},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"unknown\" of template literal expression.","line":166,"column":31,"nodeType":"MemberExpression","messageId":"invalidType","endLine":166,"endColumn":42},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":174,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":174,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":189,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":189,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":203,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":203,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":213,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":213,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":248,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":248,"endColumn":28},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .error on an `any` value.","line":281,"column":23,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":281,"endColumn":28}],"suppressedMessages":[],"errorCount":14,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, expect, it } from \"vitest\";\nimport { request } from \"./setup\";\nimport Project from \"../models/Project\";\nimport User from \"../models/User\";\n\ndescribe(\"Project Management - Edge Cases\", () => {\n  let token: string;\n  let userId: string;\n\n  beforeEach(async () => {\n    await User.deleteMany({});\n    await Project.deleteMany({});\n\n    const reg = await request.post(\"/api/auth/register\").send({\n      email: \"edgecase@tenant.com\",\n      password: \"pass1234\",\n      firstName: \"Edge\",\n      lastName: \"Case\",\n    });\n\n    token = reg.body.token as string;\n    userId = (reg.body.user as { _id: string })._id;\n  });\n\n  describe(\"POST /api/projects - Missing required fields\", () => {\n    it('âŒ should fail when \"name\" field is missing', async () => {\n      const res = await request\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          description: \"Projet test sans nom\",\n          type: \"residential\",\n          location: {\n            address: \"123 Test St\",\n            city: \"Test City\",\n            postalCode: \"12345\",\n          },\n          financials: {\n            totalInvestment: 100000,\n            targetAmount: 50000,\n            currentAmount: 0,\n            expectedReturn: 5,\n            duration: 12,\n            entryTicket: 1000,\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(),\n            milestones: [],\n          },\n        });\n\n      expect(res.status).toBe(400);\n      expect(res.body).toHaveProperty(\"error\");\n      expect(res.body.error).toMatch(/name.*required/i);\n    });\n\n    it('âŒ should fail when \"type\" field is missing', async () => {\n      const res = await request\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          name: \"Test Project\",\n          description: \"Projet test sans type\",\n          location: {\n            address: \"123 Test St\",\n            city: \"Test City\",\n            postalCode: \"12345\",\n          },\n          financials: {\n            totalInvestment: 100000,\n            targetAmount: 50000,\n            currentAmount: 0,\n            expectedReturn: 5,\n            duration: 12,\n            entryTicket: 1000,\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(),\n            milestones: [],\n          },\n        });\n\n      expect(res.status).toBe(400);\n      expect(res.body).toHaveProperty(\"error\");\n      expect(res.body.error).toMatch(/type.*required/i);\n    });\n\n    it('âŒ should fail when \"financials\" object is missing', async () => {\n      const res = await request\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          name: \"Test Project\",\n          description: \"Projet test sans financials\",\n          type: \"residential\",\n          location: {\n            address: \"123 Test St\",\n            city: \"Test City\",\n            postalCode: \"12345\",\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(),\n            milestones: [],\n          },\n        });\n\n      expect(res.status).toBe(400);\n      expect(res.body).toHaveProperty(\"error\");\n      expect(res.body.error).toMatch(/financials.*required/i);\n    });\n  });\n\n  describe(\"GET /api/projects/:id - Invalid ID format\", () => {\n    it(\"âŒ should return 400 for malformed MongoDB ObjectId\", async () => {\n      const invalidIds = [\n        \"123\", // too short\n        \"507f1f77bcf86cd799439011123\", // too long\n        \"not-a-valid-id\", // invalid characters\n        \"507f1f77bcf86cd79943901g\", // invalid hex character\n      ];\n\n      for (const invalidId of invalidIds) {\n        const res = await request\n          .get(`/api/projects/${invalidId}`)\n          .set(\"Authorization\", `Bearer ${token}`);\n\n        expect(res.status).toBe(400);\n        expect(res.body).toHaveProperty(\"error\");\n        expect(res.body.error).toMatch(/invalid.*id/i);\n      }\n    });\n  });\n\n  describe(\"PUT /api/projects/:id - Invalid updates\", () => {\n    it(\"âŒ should fail when updating with invalid status value\", async () => {\n      const project = await Project.create({\n        name: \"Update Test Project\",\n        description: \"Testing invalid updates\",\n        type: \"residential\",\n        location: {\n          address: \"123 Update St\",\n          city: \"Update City\",\n          postalCode: \"12345\",\n        },\n        financials: {\n          totalInvestment: 10000,\n          targetAmount: 20000,\n          currentAmount: 0,\n          expectedReturn: 6.5,\n          duration: 3,\n          entryTicket: 100,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(),\n          milestones: [],\n        },\n        status: \"active\",\n        createdBy: userId,\n      });\n\n      const res = await request\n        .put(`/api/projects/${project._id}`)\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          status: \"invalid_status_value\",\n        });\n\n      expect(res.status).toBe(400);\n      expect(res.body).toHaveProperty(\"error\");\n      expect(res.body.error).toMatch(/status.*invalid/i);\n    });\n\n    it(\"âŒ should fail when updating non-existent project\", async () => {\n      const nonExistentId = \"507f1f77bcf86cd799439011\";\n\n      const res = await request\n        .put(`/api/projects/${nonExistentId}`)\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          name: \"Updated Name\",\n        });\n\n      expect(res.status).toBe(404);\n      expect(res.body).toHaveProperty(\"error\");\n      expect(res.body.error).toMatch(/project.*not found/i);\n    });\n  });\n\n  describe(\"DELETE /api/projects/:id - Edge cases\", () => {\n    it(\"âŒ should fail when deleting non-existent project\", async () => {\n      const nonExistentId = \"507f1f77bcf86cd799439011\";\n\n      const res = await request\n        .delete(`/api/projects/${nonExistentId}`)\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(404);\n      expect(res.body).toHaveProperty(\"error\");\n      expect(res.body.error).toMatch(/project.*not found/i);\n    });\n\n    it(\"âŒ should fail with 400 for malformed ID on delete\", async () => {\n      const res = await request\n        .delete(\"/api/projects/invalid-id\")\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(400);\n      expect(res.body).toHaveProperty(\"error\");\n      expect(res.body.error).toMatch(/invalid.*id/i);\n    });\n  });\n\n  describe(\"Data validation edge cases\", () => {\n    it(\"âŒ should fail when financials.totalInvestment is negative\", async () => {\n      const res = await request\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          name: \"Negative Investment Project\",\n          description: \"Testing negative investment\",\n          type: \"residential\",\n          location: {\n            address: \"123 Test St\",\n            city: \"Test City\",\n            postalCode: \"12345\",\n          },\n          financials: {\n            totalInvestment: -1000, // Negative value\n            targetAmount: 50000,\n            currentAmount: 0,\n            expectedReturn: 5,\n            duration: 12,\n            entryTicket: 1000,\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(),\n            milestones: [],\n          },\n        });\n\n      expect(res.status).toBe(400);\n      expect(res.body).toHaveProperty(\"error\");\n      expect(res.body.error).toMatch(/totalInvestment.*positive/i);\n    });\n\n    it(\"âŒ should fail when timeline.startDate is after endDate\", async () => {\n      const res = await request\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          name: \"Invalid Timeline Project\",\n          description: \"Testing invalid timeline\",\n          type: \"residential\",\n          location: {\n            address: \"123 Test St\",\n            city: \"Test City\",\n            postalCode: \"12345\",\n          },\n          financials: {\n            totalInvestment: 10000,\n            targetAmount: 50000,\n            currentAmount: 0,\n            expectedReturn: 5,\n            duration: 12,\n            entryTicket: 1000,\n          },\n          timeline: {\n            startDate: new Date(\"2025-01-01\"), // After end date\n            endDate: new Date(\"2024-01-01\"),\n            milestones: [],\n          },\n        });\n\n      expect(res.status).toBe(400);\n      expect(res.body).toHaveProperty(\"error\");\n      expect(res.body.error).toMatch(/startDate.*before.*endDate/i);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\projects.test.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":35},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":4,"endColumn":41},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":21,"column":22,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":21,"endColumn":27},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .user on an `any` value.","line":22,"column":24,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":22,"endColumn":28},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"unknown\" of template literal expression.","line":132,"column":31,"nodeType":"MemberExpression","messageId":"invalidType","endLine":132,"endColumn":42},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"unknown\" of template literal expression.","line":179,"column":31,"nodeType":"MemberExpression","messageId":"invalidType","endLine":179,"endColumn":42},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"unknown\" of template literal expression.","line":216,"column":54,"nodeType":"MemberExpression","messageId":"invalidType","endLine":216,"endColumn":65},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"unknown\" of template literal expression.","line":253,"column":34,"nodeType":"MemberExpression","messageId":"invalidType","endLine":253,"endColumn":45},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"unknown\" of template literal expression.","line":286,"column":57,"nodeType":"MemberExpression","messageId":"invalidType","endLine":286,"endColumn":68}],"suppressedMessages":[],"errorCount":9,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { beforeEach, describe, expect, it } from \"vitest\";\nimport { request } from \"./setup\";\nimport User from \"../models/User\";\nimport Project from \"../models/Project\";\n\ndescribe(\"Project Management\", () => {\n  let token: string;\n  let userId: string;\n\n  beforeEach(async () => {\n    await User.deleteMany({});\n    await Project.deleteMany({});\n\n    const reg = await request.post(\"/api/auth/register\").send({\n      email: \"user@tenant.com\",\n      password: \"pass1234\",\n      firstName: \"Test\",\n      lastName: \"User\",\n    });\n\n    token = reg.body.token as string;\n    userId = (reg.body.user as { _id: string })._id;\n  });\n\n  describe(\"GET /api/projects\", () => {\n    it(\"should get all projects\", async () => {\n      const res = await request\n        .get(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(200);\n      expect(Array.isArray(res.body)).toBe(true);\n    });\n\n    it(\"should return empty array when no projects\", async () => {\n      const res = await request\n        .get(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveLength(0);\n    });\n  });\n\n  describe(\"POST /api/projects\", () => {\n    it(\"should create a new project with valid data\", async () => {\n      const res = await request\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          name: \"Test Project\",\n          description: \"A test project\",\n          type: \"residential\",\n          location: {\n            address: \"123 Test St\",\n            city: \"Test City\",\n            postalCode: \"12345\",\n          },\n          financials: {\n            totalInvestment: 50000,\n            targetAmount: 100000,\n            currentAmount: 0,\n            expectedReturn: 8.5,\n            duration: 12,\n            entryTicket: 1000,\n          },\n          timeline: {\n            startDate: new Date(),\n            endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n            milestones: [],\n          },\n          status: \"active\",\n          createdBy: userId,\n        });\n\n      expect(res.status).toBe(201);\n      expect(res.body).toHaveProperty(\"name\", \"Test Project\");\n      expect(res.body).toHaveProperty(\"_id\");\n    });\n\n    it(\"should not create project without authentication\", async () => {\n      const res = await request.post(\"/api/projects\").send({\n        name: \"Test Project\",\n        description: \"A test project\",\n      });\n\n      expect(res.status).toBe(401);\n    });\n\n    it(\"should not create project with invalid data\", async () => {\n      const res = await request\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          name: \"\",\n          description: \"A test project\",\n        });\n\n      expect(res.status).toBe(400);\n    });\n  });\n\n  describe(\"GET /api/projects/:id\", () => {\n    it(\"should get project by id\", async () => {\n      const project = await Project.create({\n        name: \"Test Project\",\n        description: \"A test project\",\n        type: \"residential\",\n        location: {\n          address: \"123 Test St\",\n          city: \"Test City\",\n          postalCode: \"12345\",\n        },\n        financials: {\n          totalInvestment: 50000,\n          targetAmount: 100000,\n          currentAmount: 0,\n          expectedReturn: 8.5,\n          duration: 12,\n          entryTicket: 1000,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n        status: \"active\",\n        createdBy: userId,\n      });\n\n      const res = await request\n        .get(`/api/projects/${project._id}`)\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"name\", \"Test Project\");\n    });\n\n    it(\"should return 404 for non-existent project\", async () => {\n      const nonExistentId = \"507f1f77bcf86cd799439011\";\n\n      const res = await request\n        .get(`/api/projects/${nonExistentId}`)\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(404);\n    });\n  });\n\n  describe(\"PUT /api/projects/:id\", () => {\n    it(\"should update project status\", async () => {\n      const project = await Project.create({\n        name: \"Update Test Project\",\n        description: \"Testing updates\",\n        type: \"residential\",\n        location: {\n          address: \"123 Update St\",\n          city: \"Update City\",\n          postalCode: \"12345\",\n        },\n        financials: {\n          totalInvestment: 10000,\n          targetAmount: 20000,\n          currentAmount: 0,\n          expectedReturn: 6.5,\n          duration: 3,\n          entryTicket: 100,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n        status: \"active\",\n        createdBy: userId,\n      });\n\n      const res = await request\n        .put(`/api/projects/${project._id}`)\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          status: \"completed\",\n        });\n\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"status\", \"completed\");\n    });\n\n    it(\"should not update project without authentication\", async () => {\n      const project = await Project.create({\n        name: \"Update Test Project\",\n        description: \"Testing updates\",\n        type: \"residential\",\n        location: {\n          address: \"123 Update St\",\n          city: \"Update City\",\n          postalCode: \"12345\",\n        },\n        financials: {\n          totalInvestment: 10000,\n          targetAmount: 20000,\n          currentAmount: 0,\n          expectedReturn: 6.5,\n          duration: 3,\n          entryTicket: 100,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n        status: \"active\",\n        createdBy: userId,\n      });\n\n      const res = await request.put(`/api/projects/${project._id}`).send({\n        status: \"completed\",\n      });\n\n      expect(res.status).toBe(401);\n    });\n  });\n\n  describe(\"DELETE /api/projects/:id\", () => {\n    it(\"should delete project with valid id\", async () => {\n      const project = await Project.create({\n        name: \"Delete Test Project\",\n        description: \"Testing deletion\",\n        type: \"residential\",\n        location: {\n          address: \"123 Delete St\",\n          city: \"Delete City\",\n          postalCode: \"11111\",\n        },\n        financials: {\n          totalInvestment: 10000,\n          targetAmount: 20000,\n          currentAmount: 0,\n          expectedReturn: 6.5,\n          duration: 3,\n          entryTicket: 100,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n        status: \"active\",\n        createdBy: userId,\n      });\n\n      const res = await request\n        .delete(`/api/projects/${project._id}`)\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(200);\n    });\n\n    it(\"should not delete project without authentication\", async () => {\n      const project = await Project.create({\n        name: \"Delete Test Project\",\n        description: \"Testing deletion\",\n        type: \"residential\",\n        location: {\n          address: \"123 Delete St\",\n          city: \"Delete City\",\n          postalCode: \"11111\",\n        },\n        financials: {\n          totalInvestment: 10000,\n          targetAmount: 20000,\n          currentAmount: 0,\n          expectedReturn: 6.5,\n          duration: 3,\n          entryTicket: 100,\n        },\n        timeline: {\n          startDate: new Date(),\n          endDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\n          milestones: [],\n        },\n        status: \"active\",\n        createdBy: userId,\n      });\n\n      const res = await request.delete(`/api/projects/${project._id}`);\n\n      expect(res.status).toBe(401);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\projects_integration.test.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'User' is assigned a value but never used.","line":5,"column":18,"nodeType":"Identifier","messageId":"unusedVar","endLine":5,"endColumn":22},{"ruleId":"no-unused-vars","severity":1,"message":"'response' is assigned a value but never used.","line":103,"column":13,"nodeType":"Identifier","messageId":"unusedVar","endLine":103,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"const request = require(\"supertest\");\nconst app = require(\"../server\");\nconst { sequelize } = require(\"../database/connection\");\nconst { createProject, createUser } = require(\"../factories\");\nconst { Project, User } = require(\"../models\");\n\ndescribe(\"Projects API Integration Tests\", () => {\n  let authToken;\n  let testUser;\n\n  beforeAll(async () => {\n    await sequelize.sync({ force: true });\n    testUser = await createUser({ role: \"investor\" });\n    authToken = testUser.generateAuthToken();\n  });\n\n  afterAll(async () => {\n    await sequelize.close();\n  });\n\n  beforeEach(async () => {\n    await Project.destroy({ where: {} });\n  });\n\n  describe(\"POST /api/projects\", () => {\n    it(\"should create a new project\", async () => {\n      const projectData = {\n        name: \"Test Project\",\n        description: \"Test Description\",\n        targetAmount: 100000,\n        minimumInvestment: 1000,\n        duration: 12,\n        expectedReturn: 8.5,\n        riskLevel: \"medium\",\n        category: \"residential\",\n      };\n\n      const response = await request(app)\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .send(projectData)\n        .expect(201);\n\n      expect(response.body).toHaveProperty(\"id\");\n      expect(response.body.name).toBe(projectData.name);\n      expect(response.body.status).toBe(\"active\");\n    });\n\n    it(\"should return 400 for invalid project data\", async () => {\n      const response = await request(app)\n        .post(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .send({ name: \"Incomplete\" })\n        .expect(400);\n\n      expect(response.body).toHaveProperty(\"error\");\n    });\n  });\n\n  describe(\"GET /api/projects\", () => {\n    it(\"should return all projects\", async () => {\n      await createProject({ status: \"active\" });\n      await createProject({ status: \"funded\" });\n\n      const response = await request(app)\n        .get(\"/api/projects\")\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .expect(200);\n\n      expect(response.body).toHaveLength(2);\n      expect(response.body[0]).toHaveProperty(\"id\");\n      expect(response.body[0]).toHaveProperty(\"name\");\n    });\n\n    it(\"should filter projects by status\", async () => {\n      await createProject({ status: \"active\" });\n      await createProject({ status: \"funded\" });\n\n      const response = await request(app)\n        .get(\"/api/projects?status=active\")\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .expect(200);\n\n      expect(response.body).toHaveLength(1);\n      expect(response.body[0].status).toBe(\"active\");\n    });\n  });\n\n  describe(\"GET /api/projects/:id\", () => {\n    it(\"should return a specific project\", async () => {\n      const project = await createProject();\n\n      const response = await request(app)\n        .get(`/api/projects/${project.id}`)\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .expect(200);\n\n      expect(response.body.id).toBe(project.id);\n      expect(response.body.name).toBe(project.name);\n    });\n\n    it(\"should return 404 for non-existent project\", async () => {\n      const response = await request(app)\n        .get(\"/api/projects/99999\")\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .expect(404);\n    });\n  });\n\n  describe(\"PUT /api/projects/:id\", () => {\n    it(\"should update a project\", async () => {\n      const project = await createProject();\n\n      const updateData = {\n        name: \"Updated Project Name\",\n        targetAmount: 200000,\n      };\n\n      const response = await request(app)\n        .put(`/api/projects/${project.id}`)\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .send(updateData)\n        .expect(200);\n\n      expect(response.body.name).toBe(updateData.name);\n      expect(response.body.targetAmount).toBe(updateData.targetAmount);\n    });\n  });\n\n  describe(\"DELETE /api/projects/:id\", () => {\n    it(\"should delete a project\", async () => {\n      const project = await createProject();\n\n      await request(app)\n        .delete(`/api/projects/${project.id}`)\n        .set(\"Authorization\", `Bearer ${authToken}`)\n        .expect(204);\n\n      const deletedProject = await Project.findByPk(project.id);\n      expect(deletedProject).toBeNull();\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\projects_test.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":59},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":5,"endColumn":30}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { afterAll, beforeAll, beforeEach } from \"vitest\";\nimport mongoose from \"mongoose\";\nimport { MongoMemoryServer } from \"mongodb-memory-server\";\nimport supertest from \"supertest\";\nimport app from \"../src/app\";\n\nlet mongo: MongoMemoryServer;\nexport const request = supertest(app);\n\nbeforeAll(async () => {\n  mongo = await MongoMemoryServer.create();\n  const mongoUri = mongo.getUri();\n  await mongoose.connect(mongoUri);\n});\n\nbeforeEach(async () => {\n  const collections = mongoose.connection.collections;\n  for (const key in collections) {\n    const collection = collections[key];\n    if (collection) {\n      await collection.deleteMany({});\n    }\n  }\n});\n\nafterAll(async () => {\n  await mongoose.connection.dropDatabase();\n  await mongoose.connection.close();\n  await mongo.stop();\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\database-setup.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\env-setup.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\global-setup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\mongo-memory-server.ts","messages":[{"ruleId":"@typescript-eslint/no-unsafe-enum-comparison","severity":2,"message":"The two values in this comparison do not have a shared enum type.","line":11,"column":9,"nodeType":"BinaryExpression","messageId":"mismatchedCondition","endLine":11,"endColumn":45,"suggestions":[{"messageId":"replaceValueWithEnum","fix":{"range":[333,334],"text":"ConnectionStates.connected"},"desc":"Replace with an enum value comparison."}]},{"ruleId":"@typescript-eslint/no-unsafe-enum-comparison","severity":2,"message":"The two values in this comparison do not have a shared enum type.","line":17,"column":9,"nodeType":"BinaryExpression","messageId":"mismatchedCondition","endLine":17,"endColumn":45,"suggestions":[{"messageId":"replaceValueWithEnum","fix":{"range":[512,513],"text":"ConnectionStates.disconnected"},"desc":"Replace with an enum value comparison."}]},{"ruleId":"@typescript-eslint/no-unsafe-enum-comparison","severity":2,"message":"The two values in this comparison do not have a shared enum type.","line":55,"column":24,"nodeType":"BinaryExpression","messageId":"mismatchedCondition","endLine":55,"endColumn":60,"suggestions":[{"messageId":"replaceValueWithEnum","fix":{"range":[1514,1515],"text":"ConnectionStates.connected"},"desc":"Replace with an enum value comparison."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { afterAll, afterEach, beforeAll } from \"vitest\";\nimport { MongoMemoryServer } from \"mongodb-memory-server\";\nimport mongoose from \"mongoose\";\n\nlet mongoServer: MongoMemoryServer;\nlet isConnected = false;\n\nbeforeAll(async () => {\n  try {\n    // Check if mongoose is already connected\n    if (mongoose.connection.readyState === 1) {\n      console.log(\"Already connected to MongoDB\");\n      return;\n    }\n\n    // Ensure any existing connections are properly closed\n    if (mongoose.connection.readyState !== 0) {\n      await mongoose.disconnect();\n    }\n\n    // Add a small delay to ensure cleanup\n    await new Promise((resolve) => setTimeout(resolve, 100));\n\n    // Start MongoDB Memory Server\n    mongoServer = await MongoMemoryServer.create({\n      instance: { dbName: \"test_db\" },\n    });\n\n    const mongoUri = mongoServer.getUri();\n\n    // Configure mongoose with better connection settings\n    await mongoose.connect(mongoUri, {\n      maxPoolSize: 10,\n      serverSelectionTimeoutMS: 10000,\n      socketTimeoutMS: 45000,\n      bufferCommands: false,\n    });\n\n    isConnected = true;\n    console.log(\"Connected to MongoDB Memory Server\");\n  } catch (err) {\n    console.error(\"Failed to connect to test database:\", err);\n    // Try to cleanup on failure\n    try {\n      await mongoose.disconnect();\n    } catch (cleanupErr) {\n      console.error(\"Cleanup error:\", cleanupErr);\n    }\n    throw err;\n  }\n}, 30_000);\n\nafterEach(async () => {\n  try {\n    if (isConnected && mongoose.connection.readyState === 1) {\n      const collections = mongoose.connection.collections;\n      const deletePromises = Object.values(collections).map((collection) =>\n        collection\n          .deleteMany({})\n          .catch((err) => console.error(\"Collection cleanup error:\", err)),\n      );\n      await Promise.all(deletePromises);\n    }\n  } catch (err) {\n    console.error(\"Error in afterEach cleanup:\", err);\n  }\n});\n\nafterAll(async () => {\n  try {\n    if (isConnected) {\n      await mongoose.connection\n        .dropDatabase()\n        .catch((err) => console.error(\"Drop database error:\", err));\n      await mongoose.disconnect();\n      isConnected = false;\n    }\n\n    if (mongoServer) {\n      await mongoServer.stop();\n    }\n    console.log(\"MongoDB Memory Server stopped\");\n  } catch (err) {\n    console.error(\"Error during test cleanup:\", err);\n  }\n}, 30_000);\n\nexport { mongoServer };\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\mongoMemoryServer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\test-env.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\test-seed.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":2,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":2,"endColumn":31},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":41}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import mongoose from 'mongoose';\r\nimport bcrypt from 'bcryptjs';\r\nimport User from '../../models/User.js';\r\n\r\nexport async function seedTestData() {\r\n  // Clear existing data\r\n  await User.deleteMany({});\r\n  \r\n  // Create test users\r\n  const adminPassword = await bcrypt.hash('admin123', 10);\r\n  const userPassword = await bcrypt.hash('user123', 10);\r\n  \r\n  const users = await User.create([\r\n    {\r\n      email: 'admin@solia.org',\r\n      password: adminPassword,\r\n      role: 'admin',\r\n      profile: {\r\n        firstName: 'Admin',\r\n        lastName: 'User',\r\n      },\r\n    },\r\n    {\r\n      email: 'user@solia.org',\r\n      password: userPassword,\r\n      role: 'investor',\r\n      profile: {\r\n        firstName: 'Test',\r\n        lastName: 'User',\r\n      },\r\n    },\r\n  ]);\r\n  \r\n  return users;\r\n}\r\n\r\nexport async function clearTestData() {\r\n  await User.deleteMany({});\r\n}\r\n\r\nexport async function disconnectDatabase() {\r\n  await mongoose.connection.close();\r\n}\r\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\test-setup.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\test-setup.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":3,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":3,"endColumn":59},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":5,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":5,"endColumn":33}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { afterAll, beforeAll, beforeEach } from \"vitest\";\nimport mongoose from \"mongoose\";\nimport { MongoMemoryServer } from \"mongodb-memory-server\";\nimport supertest from \"supertest\";\nimport app from \"../../src/app\";\nimport { seedTestData } from \"./test-seed\";\n\nlet mongo: MongoMemoryServer;\nexport const request = supertest(app);\n\nbeforeAll(async () => {\n  mongo = await MongoMemoryServer.create();\n  const mongoUri = mongo.getUri();\n  await mongoose.connect(mongoUri);\n});\n\nbeforeEach(async () => {\n  const collections = mongoose.connection.collections;\n  for (const key in collections) {\n    const collection = collections[key];\n    if (collection) {\n      await collection.deleteMany({});\n    }\n  }\n  \n  // Seed test data\n  await seedTestData();\n});\n\nafterAll(async () => {\n  await mongoose.connection.dropDatabase();\n  await mongoose.connection.close();\n  await mongo.stop();\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\test_helpers.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":4,"endColumn":41},{"ruleId":"@typescript-eslint/no-unsafe-argument","severity":2,"message":"Unsafe argument of type `any` assigned to a parameter of type `string`.","line":16,"column":46,"nodeType":"MemberExpression","messageId":"unsafeArgument","endLine":16,"endColumn":63},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .password on an `any` value.","line":16,"column":55,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":16,"endColumn":63},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":35,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":35,"endColumn":36},{"ruleId":"@typescript-eslint/no-unsafe-call","severity":2,"message":"Unsafe call of a(n) `any` typed value.","line":35,"column":17,"nodeType":"MemberExpression","messageId":"unsafeCall","endLine":35,"endColumn":34},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access ._id on an `any` value.","line":35,"column":22,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":35,"endColumn":25},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":36,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":36,"endColumn":26},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .email on an `any` value.","line":36,"column":21,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":36,"endColumn":26},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":37,"column":9,"nodeType":"Property","messageId":"anyAssignment","endLine":37,"endColumn":24},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .role on an `any` value.","line":37,"column":20,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":37,"endColumn":24},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":48,"column":11,"nodeType":"VariableDeclarator","messageId":"anyAssignment","endLine":48,"endColumn":53},{"ruleId":"@typescript-eslint/no-unsafe-assignment","severity":2,"message":"Unsafe assignment of an `any` value.","line":51,"column":14,"nodeType":"Property","messageId":"anyAssignment","endLine":51,"endColumn":18}],"suppressedMessages":[],"errorCount":12,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport mongoose from \"mongoose\";\nimport User from \"../../models/User.js\";\n\nexport interface TestUser {\n  user: any;\n  token: string;\n}\n\nexport class TestHelpers {\n  /**\n   * Create a test user with hashed password\n   */\n  static async createTestUser(userData: any): Promise<any> {\n    const hashedPassword = await bcrypt.hash(userData.password, 10);\n\n    const user = new User({\n      ...userData,\n      password: hashedPassword,\n    });\n\n    await user.save();\n    return user;\n  }\n\n  /**\n   * Generate JWT token for a user\n   */\n  static generateToken(user: any): string {\n    const jwtSecret = process.env.JWT_SECRET || \"your-secret-key\";\n\n    return jwt.sign(\n      {\n        userId: user._id.toString(),\n        email: user.email,\n        role: user.role,\n      },\n      jwtSecret,\n      { expiresIn: \"7d\" },\n    );\n  }\n\n  /**\n   * Create authenticated test user\n   */\n  static async createAuthenticatedUser(userData: any): Promise<TestUser> {\n    const user = await this.createTestUser(userData);\n    const token = this.generateToken(user);\n\n    return { user, token };\n  }\n\n  /**\n   * Create admin user for tests\n   */\n  static async createAdminUser(): Promise<TestUser> {\n    return this.createAuthenticatedUser({\n      email: \"admin@test.com\",\n      password: \"AdminPass123!\",\n      role: \"admin\",\n      username: \"admin\",\n      profile: {\n        firstName: \"Admin\",\n        lastName: \"User\",\n      },\n    });\n  }\n\n  /**\n   * Create regular user for tests\n   */\n  static async createRegularUser(): Promise<TestUser> {\n    return this.createAuthenticatedUser({\n      email: \"user@test.com\",\n      password: \"UserPass123!\",\n      role: \"investor\",\n      username: \"user\",\n      profile: {\n        firstName: \"Regular\",\n        lastName: \"User\",\n      },\n    });\n  }\n\n  /**\n   * Get authorization header with Bearer token\n   */\n  static getAuthHeader(token: string): Record<string, string> {\n    return {\n      Authorization: `Bearer ${token}`,\n    };\n  }\n\n  /**\n   * Clean up test users\n   */\n  static async cleanupTestUsers(): Promise<void> {\n    if (\n      mongoose.connection.readyState === mongoose.ConnectionStates.connected\n    ) {\n      await User.deleteMany({});\n    }\n  }\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\test_setup.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":4,"endColumn":33},{"ruleId":"@typescript-eslint/no-unsafe-enum-comparison","severity":2,"message":"The two values in this comparison do not have a shared enum type.","line":24,"column":7,"nodeType":"BinaryExpression","messageId":"mismatchedCondition","endLine":24,"endColumn":43,"suggestions":[{"messageId":"replaceValueWithEnum","fix":{"range":[748,749],"text":"ConnectionStates.disconnected"},"desc":"Replace with an enum value comparison."}]},{"ruleId":"@typescript-eslint/no-unsafe-enum-comparison","severity":2,"message":"The two values in this comparison do not have a shared enum type.","line":59,"column":7,"nodeType":"BinaryExpression","messageId":"mismatchedCondition","endLine":59,"endColumn":43,"suggestions":[{"messageId":"replaceValueWithEnum","fix":{"range":[1612,1613],"text":"ConnectionStates.connected"},"desc":"Replace with an enum value comparison."}]}],"suppressedMessages":[],"errorCount":3,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { afterAll, afterEach, beforeAll } from \"vitest\";\nimport { MongoMemoryServer } from \"mongodb-memory-server\";\nimport mongoose from \"mongoose\";\nimport { config } from \"dotenv\";\nimport path from \"path\";\n\n// Load environment variables from .env.test\nconst envPath = path.resolve(process.cwd(), \".env.test\");\nconfig({ path: envPath });\n\n// Ensure JWT secrets are set for testing\nif (!process.env.JWT_SECRET) {\n  process.env.JWT_SECRET = \"test-jwt-secret-key-for-testing-only\";\n}\nif (!process.env.JWT_REFRESH_SECRET) {\n  process.env.JWT_REFRESH_SECRET =\n    \"test-jwt-refresh-secret-key-for-testing-only\";\n}\n\nlet mongoServer: MongoMemoryServer;\n\nbeforeAll(async () => {\n  // Close any existing connections\n  if (mongoose.connection.readyState !== 0) {\n    await mongoose.disconnect();\n  }\n\n  // Start MongoDB Memory Server\n  mongoServer = await MongoMemoryServer.create({\n    instance: { dbName: \"test_db\" },\n  });\n\n  const mongoUri = mongoServer.getUri();\n\n  // Connect to MongoDB\n  await mongoose.connect(mongoUri, {\n    maxPoolSize: 10,\n    serverSelectionTimeoutMS: 10000,\n    socketTimeoutMS: 45000,\n    bufferCommands: false,\n  });\n\n  console.log(\"Connected to MongoDB Memory Server\");\n});\n\nafterEach(async () => {\n  // Clean up collections between tests\n  const collections = mongoose.connection.collections;\n  const deletePromises = Object.values(collections).map((collection) =>\n    collection\n      .deleteMany({})\n      .catch((err) => console.error(\"Cleanup error:\", err)),\n  );\n  await Promise.all(deletePromises);\n});\n\nafterAll(async () => {\n  // Clean up\n  if (mongoose.connection.readyState === 1) {\n    await mongoose.connection.dropDatabase();\n    await mongoose.disconnect();\n  }\n\n  if (mongoServer) {\n    await mongoServer.stop();\n  }\n\n  console.log(\"MongoDB Memory Server stopped\");\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\setup\\unified-test-config.js","messages":[{"ruleId":"no-unused-vars","severity":1,"message":"'mongoServer' is defined but never used.","line":4,"column":5,"nodeType":"Identifier","messageId":"unusedVar","endLine":4,"endColumn":16}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Unified test database configuration\nconst mongoose = require(\"mongoose\");\n\nlet mongoServer;\nlet isConnected = false;\n\nconst connectDB = async () => {\n  if (isConnected) return;\n\n  try {\n    const mongoUri =\n      process.env.MONGO_URI_TEST || \"mongodb:param//localhost:param27017/test_db\";\n    await mongoose.connect(mongoUri, {\n      useNewUrlParser: true,\n      useUnifiedTopology: true,\n      maxPoolSize: 10,\n      serverSelectionTimeoutMS: 10000,\n      socketTimeoutMS: 45000,\n    });\n    isConnected = true;\n    console.log(\"Connected to MongoDB\");\n  } catch (_error) {\n    console.error(\"Error connecting to MongoDB:\", error);\n    throw error;\n  }\n};\n\nconst disconnectDB = async () => {\n  if (!isConnected) return;\n\n  try {\n    await mongoose.connection.dropDatabase();\n    await mongoose.connection.close();\n    isConnected = false;\n    console.log(\"Disconnected from MongoDB\");\n  } catch (_error) {\n    console.error(\"Error disconnecting from MongoDB:\", error);\n  }\n};\n\nmodule.exports = {\n  connectDB,\n  disconnectDB,\n};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\user_test.ts","messages":[{"ruleId":null,"fatal":true,"severity":2,"message":"Parsing error: ',' expected.","line":30,"column":51,"nodeType":null}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { describe, expect, it } from \"vitest\";\nimport mongoose from \"mongoose\";\nimport User from \"../models/User\";\nimport bcrypt from \"bcryptjs\";\nimport { param } from \"types/global\";\n\ndescribe(\"User Model\", () => {\n  it(\"should create and save a user successfully\", async () => {\n    const userData = {\n      email: \"test@example.com\",\n      password: \"password123\",\n      profile: {\n        firstName: \"John\",\n        lastName: \"Doe\",\n      },\n    };\n    const user = new User(userData);\n    const savedUser = await user.save();\n\n    expect(savedUser._id).toBeDefined();\n    expect(savedUser.email).toBe(userData.email.toLowerCase());\n    expect(savedUser.profile.firstName).toBe(userData.profile.firstName);\n    expect(savedUser.password).not.toBe(userData.password); // password should be hashed\n  });\n\n  it(\"should hash password before saving\", async () => {\n    const user = new User({\n      email: \"hash@example.com\",\n      password: \"mypassword\",\n      profile: { firstName: \"Hash\", lastName:param \"Test\" },\n    });\n    await user.save();\n    const isMatch = await bcrypt.compare(\"mypassword\", user.password);\n    expect(isMatch).toBe(true);\n  });\n\n  it(\"should compare password correctly\", async () => {\n    const user = new User({\n      email: \"compare@example.com\",\n      password: \"comparepass\",\n      profile: { firstName: \"Compare\", lastName:param \"Test\" },\n    });\n    await user.save();\n    const isValid = await user.comparePassword(\"comparepass\");\n    expect(isValid).toBe(true);\n    const isInvalid = await user.comparePassword(\"wrongpass\");\n    expect(isInvalid).toBe(false);\n  });\n\n  it(\"should fail validation for invalid email\", async () => {\n    const user = new User({\n      email: \"invalid-email\",\n      password: \"password123\",\n      profile: { firstName: \"Invalid\", lastName:param \"Email\" },\n    });\n    let err: any;\n    try {\n      await user.validate();\n    } catch (_error) {\n      err = error;\n    }\n    expect(err).toBeDefined();\n    expect(err.errors.email).toBeDefined();\n  });\n\n  it(\"should fail validation for short password\", async () => {\n    const user = new User({\n      email: \"shortpass@example.com\",\n      password: \"123\",\n      profile: { firstName: \"Short\", lastName:param \"Pass\" },\n    });\n    let err: any;\n    try {\n      await user.validate();\n    } catch (_error) {\n      err = error;\n    }\n    expect(err).toBeDefined();\n    expect(err.errors.password).toBeDefined();\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\users.test.ts","messages":[{"ruleId":"sort-imports","severity":2,"message":"Expected 'multiple' syntax before 'single' syntax.","line":2,"column":1,"nodeType":"ImportDeclaration","messageId":"unexpectedSyntaxOrder","endLine":2,"endColumn":59},{"ruleId":"sort-imports","severity":2,"message":"Imports should be sorted alphabetically.","line":4,"column":1,"nodeType":"ImportDeclaration","messageId":"sortImportsAlphabetically","endLine":4,"endColumn":35},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'user' is assigned a value but never used. Allowed unused vars must match /^_/u.","line":13,"column":11,"nodeType":null,"messageId":"unusedVar","endLine":13,"endColumn":15},{"ruleId":"@typescript-eslint/no-unsafe-member-access","severity":2,"message":"Unsafe member access .token on an `any` value.","line":25,"column":27,"nodeType":"Identifier","messageId":"unsafeMemberExpression","endLine":25,"endColumn":32},{"ruleId":"@typescript-eslint/restrict-template-expressions","severity":2,"message":"Invalid type \"unknown\" of template literal expression.","line":75,"column":28,"nodeType":"ChainExpression","messageId":"invalidType","endLine":75,"endColumn":37}],"suppressedMessages":[],"errorCount":5,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import bcrypt from \"bcryptjs\";\nimport { beforeEach, describe, expect, it } from \"vitest\";\nimport { request } from \"./setup/test-setup\";\nimport User from \"../models/User\";\n\ndescribe(\"User Management\", () => {\n  let token: string;\n\n  beforeEach(async () => {\n    await User.deleteMany({});\n\n    const hashedPassword = await bcrypt.hash(\"password123\", 10);\n    const user = await User.create({\n      email: \"testuser@example.com\",\n      firstName: \"Test\",\n      lastName: \"User\",\n      password: hashedPassword,\n      role: \"investor\",\n    });\n\n    const loginRes = await request.post(\"/api/auth/login\").send({\n      email: \"testuser@example.com\",\n      password: \"password123\",\n    });\n    token = loginRes.body.token as string;\n  });\n\n  describe(\"GET /api/users/me\", () => {\n    it(\"should get current user profile\", async () => {\n      const res = await request\n        .get(\"/api/users/me\")\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"email\", \"testuser@example.com\");\n      expect(res.body).toHaveProperty(\"firstName\", \"Test\");\n      expect(res.body).not.toHaveProperty(\"password\");\n    });\n\n    it(\"should not get profile without authentication\", async () => {\n      const res = await request.get(\"/api/users/me\");\n      expect(res.status).toBe(401);\n    });\n  });\n\n  describe(\"PUT /api/users/me\", () => {\n    it(\"should update user profile\", async () => {\n      const res = await request\n        .put(\"/api/users/me\")\n        .set(\"Authorization\", `Bearer ${token}`)\n        .send({\n          firstName: \"Updated\",\n          lastName: \"Name\",\n          phone: \"+1234567890\",\n        });\n\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"firstName\", \"Updated\");\n      expect(res.body).toHaveProperty(\"lastName\", \"Name\");\n    });\n\n    it(\"should not update user profile without authentication\", async () => {\n      const res = await request.put(\"/api/users/me\").send({\n        firstName: \"Updated\",\n      });\n      expect(res.status).toBe(401);\n    });\n  });\n\n  describe(\"GET /api/users/:id\", () => {\n    it(\"should get user by id\", async () => {\n      const user = await User.findOne({ email: \"testuser@example.com\" });\n\n      const res = await request\n        .get(`/api/users/${user?._id}`)\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(200);\n      expect(res.body).toHaveProperty(\"email\", \"testuser@example.com\");\n    });\n\n    it(\"should return 404 for non-existent user\", async () => {\n      const res = await request\n        .get(\"/api/users/507f1f77bcf86cd799439011\")\n        .set(\"Authorization\", `Bearer ${token}`);\n\n      expect(res.status).toBe(404);\n    });\n  });\n});\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\utils\\db-handler.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\tests\\utils\\db-handler.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\types\\factories.d.ts","messages":[{"ruleId":"no-redeclare","severity":2,"message":"'Types' is already defined.","line":11,"column":10,"nodeType":"Identifier","messageId":"redeclared","endLine":11,"endColumn":15}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Solia SCI Invest - TypeScript Factory Definitions\n *\n * This file contains type definitions for all factory methods and overrides\n * used in test data generation.\n */\n\nimport { Types } from \"mongoose\";\n\nimport type { IProject, ISCIResource, ITenant, IUser } from \"./models\";\nimport { Types } from \"mongoose\";\n\n// User Factory Types\nexport interface IUserOverrides {\n  name?: string;\n  email?: string;\n  password?: string;\n  role?: \"admin\" | \"investor\" | \"collector\" | \"user\";\n  profile?: Partial<IUser[\"profile\"]>;\n  isEmailVerified?: boolean;\n  isActive?: boolean;\n}\n\n// Tenant Factory Types\nexport interface ITenantOverrides {\n  name?: string;\n  slug?: string;\n  description?: string;\n  logo?: string;\n  website?: string;\n  owner?: Types.ObjectId;\n  members?: Types.ObjectId[];\n  settings?: Partial<ITenant[\"settings\"]>;\n  isActive?: boolean;\n}\n\n// Project Factory Types\nexport interface IProjectOverrides {\n  name?: string;\n  description?: string;\n  type?: \"residential\" | \"commercial\" | \"mixed\" | \"industrial\";\n  location?: Partial<IProject[\"location\"]>;\n  financials?: Partial<IProject[\"financials\"]>;\n  timeline?: Partial<IProject[\"timeline\"]>;\n  documents?: IProject[\"documents\"];\n  status?: \"draft\" | \"active\" | \"funded\" | \"completed\" | \"cancelled\";\n  tenant?: Types.ObjectId;\n  createdBy?: Types.ObjectId;\n  investors?: Types.ObjectId[];\n  progress?: number;\n}\n\n// SCI Resource Factory Types\nexport interface ISCIResourceOverrides {\n  title?: string;\n  description?: string;\n  type?: string;\n  category?: string;\n  tags?: string[];\n  content?: Partial<ISCIResource[\"content\"]>;\n  media?: Partial<ISCIResource[\"media\"]>;\n  author?: Types.ObjectId;\n  tenant?: Types.ObjectId;\n  isFeatured?: boolean;\n  isPublished?: boolean;\n}\n\n// Donation Factory Types\nexport interface IDonationOverrides {\n  amount?: number;\n  currency?: string;\n  project?: Types.ObjectId;\n  donor?: Types.ObjectId;\n  status?: \"pending\" | \"completed\" | \"failed\" | \"refunded\";\n  paymentMethod?: string;\n  transactionId?: string;\n  message?: string;\n  isAnonymous?: boolean;\n}\n\n// Factory Method Types\nexport interface IFactoryMethods {\n  // User factories\n  createUser: (overrides?: IUserOverrides) => Promise<IUser>;\n  createUsers: (count?: number, overrides?: IUserOverrides) => Promise<IUser[]>;\n  createAdmin: (overrides?: IUserOverrides) => Promise<IUser>;\n  createInvestor: (overrides?: IUserOverrides) => Promise<IUser>;\n  createCollector: (overrides?: IUserOverrides) => Promise<IUser>;\n\n  // Tenant factories\n  createTenant: (overrides?: ITenantOverrides) => Promise<ITenant>;\n  createTenants: (\n    count?: number,\n    overrides?: ITenantOverrides,\n  ) => Promise<ITenant[]>;\n\n  // Project factories\n  createProject: (overrides?: IProjectOverrides) => Promise<IProject>;\n  createProjects: (\n    count?: number,\n    overrides?: IProjectOverrides,\n  ) => Promise<IProject[]>;\n  createFundedProject: (overrides?: IProjectOverrides) => Promise<IProject>;\n  createActiveProject: (overrides?: IProjectOverrides) => Promise<IProject>;\n\n  // SCI Resource factories\n  createSCIResource: (\n    overrides?: ISCIResourceOverrides,\n  ) => Promise<ISCIResource>;\n  createSCIResources: (\n    count?: number,\n    overrides?: ISCIResourceOverrides,\n  ) => Promise<ISCIResource[]>;\n  createFeaturedResource: (\n    overrides?: ISCIResourceOverrides,\n  ) => Promise<ISCIResource>;\n\n  // Utility functions\n  clearDatabase: () => Promise<void>;\n  seedDatabase: (options?: {\n    users?: number;\n    tenants?: number;\n    projects?: number;\n    sciResources?: number;\n  }) => Promise<{\n    users: IUser[];\n    tenants: ITenant[];\n    projects: IProject[];\n    sciResources: ISCIResource[];\n  }>;\n  getRandomObjectId: () => string;\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\types\\global.d.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":3,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":3,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[95,98],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[95,98],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Models' is defined but never used. Allowed unused vars must match /^_/u.","line":12,"column":19,"nodeType":null,"messageId":"unusedVar","endLine":12,"endColumn":25}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// Global type declarations for JavaScript modules\ndeclare module \"*splat.js\" {\n  const value: any;\n  export = value;\n}\n\n// Express app type\ndeclare const app: import(\"express\").Express;\nexport = app;\n\n// Model type declarations\ndeclare namespace Models {\n  interface User {\n    _id?: string;\n    name: string;\n    email: string;\n    password: string;\n    role: \"admin\" | \"user\";\n    createdAt?: Date;\n    updatedAt?: Date;\n  }\n\n  interface Project {\n    _id?: string;\n    title: string;\n    description: string;\n    goalAmount: number;\n    currentAmount: number;\n    status: \"draft\" | \"active\" | \"completed\" | \"cancelled\";\n    createdAt?: Date;\n    updatedAt?: Date;\n  }\n}\n\n// Extend global scope\ndeclare global {\n  namespace NodeJS {\n    interface Global {\n      app: import(\"express\").Express;\n    }\n  }\n}\n\nexport {};\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\types\\index.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\types\\models.d.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":126,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":126,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2684,2687],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2684,2687],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Document, Model, Types } from \"mongoose\";\n\n// Base interfaces for plain data (without Document methods)\nexport interface ITenantData {\n  name: string;\n  slug: string;\n  owner: Types.ObjectId | string;\n  users?: Types.ObjectId[] | string[];\n  projects?: Types.ObjectId[] | string[];\n  settings?: {\n    branding?: {\n      logoUrl?: string;\n      primaryColor?: string;\n      secondaryColor?: string;\n    };\n    features?: string[];\n  };\n  address?: {\n    street: string;\n    city: string;\n    state: string;\n    zipCode: string;\n    country: string;\n  };\n}\n\nexport interface IUserData {\n  email: string;\n  password: string;\n  role: \"investor\" | \"collector\" | \"admin\";\n  profile: {\n    firstName: string;\n    lastName: string;\n    phone?: string;\n    avatar?: string;\n    kycStatus?: \"pending\" | \"verified\" | \"rejected\";\n  };\n  investments?: Types.ObjectId[] | string[];\n  preferences?: {\n    notifications?: {\n      email?: boolean;\n      sms?: boolean;\n      push?: boolean;\n    };\n    language?: string;\n    currency?: string;\n  };\n  tenant?: Types.ObjectId | string;\n  isEmailVerified?: boolean;\n}\n\n// Document interfaces (with Mongoose methods)\nexport interface ITenant extends ITenantData, Document {\n  _id: Types.ObjectId;\n  createdAt?: Date;\n  updatedAt?: Date;\n}\n\nexport interface IUser extends IUserData, Document {\n  _id: Types.ObjectId;\n  createdAt?: Date;\n  updatedAt?: Date;\n}\n\nexport interface IProject extends Document {\n  name: string;\n  description: string;\n  type: \"residential\" | \"commercial\" | \"mixed\";\n  status: \"draft\" | \"active\" | \"funded\" | \"completed\" | \"cancelled\";\n  location: {\n    address: string;\n    city: string;\n    postalCode: string;\n    coordinates: {\n      lat: number;\n      lng: number;\n    };\n  };\n  financials: {\n    totalInvestment: number;\n    targetAmount: number;\n    currentAmount: number;\n    expectedReturn: number;\n    duration: number;\n    entryTicket: number;\n  };\n  timeline: {\n    startDate: Date;\n    endDate: Date;\n    milestones: Array<{\n      name: string;\n      date: Date;\n      completed: boolean;\n    }>;\n  };\n  documents: Array<{\n    name: string;\n    url: string;\n    type: string;\n  }>;\n  tenant: Types.ObjectId;\n  createdBy: Types.ObjectId;\n  investors: Array<{\n    user: Types.ObjectId;\n    amount: number;\n    shares: number;\n    investedAt: Date;\n  }>;\n  progress?: number;\n  remainingAmount?: number;\n}\n\nexport interface ISCIResource extends Document {\n  title: string;\n  category: string;\n  subcategory?: string;\n  level: string;\n  description: string;\n  content: string;\n  documentType: string;\n  tags?: string[];\n  url?: string;\n  fileUrl?: string;\n  lastUpdate?: Date;\n  isActive?: boolean;\n  metadata?: any;\n}\n\ndeclare module \"../models/Project.js\" {\n  const Project: Model<IProject>;\n  export default Project;\n}\n\ndeclare module \"../models/SCIResource.js\" {\n  const SCIResource: Model<ISCIResource>;\n  export default SCIResource;\n}\n\ndeclare module \"../models/Tenant.js\" {\n  const Tenant: Model<ITenant>;\n  export default Tenant;\n}\n\ndeclare module \"../models/User.js\" {\n  const User: Model<IUser>;\n  export default User;\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\types\\models\\SCIResource.interface.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\types\\server.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\types\\tenant.types.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":1,"message":"Unexpected any. Specify a different type.","line":42,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":42,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[788,791],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[788,791],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export interface ITenantSettings {\n  branding: {\n    logoUrl?: string;\n    primaryColor?: string;\n    secondaryColor?: string;\n  };\n  features: string[];\n}\n\nexport interface ITenantAddress {\n  street?: string;\n  city?: string;\n  state?: string;\n  zipCode?: string;\n  country?: string;\n}\n\nexport interface ITenantOverrides {\n  owner?: {\n    _id?: string;\n    email?: string;\n    password?: string;\n    role?: string;\n    profile?: {\n      firstName?: string;\n      lastName?: string;\n      phone?: string;\n    };\n  };\n  name?: string;\n  slug?: string;\n  description?: string;\n  logo?: string;\n  website?: string;\n  email?: string;\n  phone?: string;\n  address?: ITenantAddress;\n  settings?: ITenantSettings;\n  isActive?: boolean;\n  users?: string[];\n  projects?: string[];\n  [key: string]: any;\n}\n","usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\utils\\jwtHelper.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]},{"filePath":"C:\\Users\\moros\\Desktop\\scisoliainvest.com\\backend\\utils\\logger.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[{"ruleId":"no-extra-semi","replacedBy":[]},{"ruleId":"no-mixed-spaces-and-tabs","replacedBy":[]}]}]